var cs=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Lu(e){if(e.__esModule)return e;var r=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach(function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}),r}var ls={exports:{}};(function(e,r){(function(t,n){e.exports=n()})(cs,function(){var t=function(f){return f instanceof Uint8Array||f instanceof Uint16Array||f instanceof Uint32Array||f instanceof Int8Array||f instanceof Int16Array||f instanceof Int32Array||f instanceof Float32Array||f instanceof Float64Array||f instanceof Uint8ClampedArray},n=function(f,h){for(var E=Object.keys(h),N=0;N<E.length;++N)f[E[N]]=h[E[N]];return f},a=`
`;function i(f){return typeof atob!="undefined"?atob(f):"base64:"+f}function c(f){var h=new Error("(regl) "+f);throw console.error(h),h}function s(f,h){f||c(h)}function o(f){return f?": "+f:""}function d(f,h,E){f in h||c("unknown parameter ("+f+")"+o(E)+". possible values: "+Object.keys(h).join())}function _(f,h){t(f)||c("invalid parameter type"+o(h)+". must be a typed array")}function O(f,h){switch(h){case"number":return typeof f=="number";case"object":return typeof f=="object";case"string":return typeof f=="string";case"boolean":return typeof f=="boolean";case"function":return typeof f=="function";case"undefined":return typeof f=="undefined";case"symbol":return typeof f=="symbol"}}function T(f,h,E){O(f,h)||c("invalid parameter type"+o(E)+". expected "+h+", got "+typeof f)}function w(f,h){f>=0&&(f|0)===f||c("invalid parameter type, ("+f+")"+o(h)+". must be a nonnegative integer")}function k(f,h,E){h.indexOf(f)<0&&c("invalid value"+o(E)+". must be one of: "+h)}var V=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function L(f){Object.keys(f).forEach(function(h){V.indexOf(h)<0&&c('invalid regl constructor argument "'+h+'". must be one of '+V)})}function Z(f,h){for(f=f+"";f.length<h;)f=" "+f;return f}function pe(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function Se(f,h){this.number=f,this.line=h,this.errors=[]}function Oe(f,h,E){this.file=f,this.line=h,this.message=E}function Ae(){var f=new Error,h=(f.stack||f).toString(),E=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(h);if(E)return E[1];var N=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(h);return N?N[1]:"unknown"}function Re(){var f=new Error,h=(f.stack||f).toString(),E=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(h);if(E)return E[1];var N=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(h);return N?N[1]:"unknown"}function We(f,h){var E=f.split(`
`),N=1,H=0,$={unknown:new pe,0:new pe};$.unknown.name=$[0].name=h||Ae(),$.unknown.lines.push(new Se(0,""));for(var U=0;U<E.length;++U){var ee=E[U],J=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(ee);if(J)switch(J[1]){case"line":var ie=/(\d+)(\s+\d+)?/.exec(J[2]);ie&&(N=ie[1]|0,ie[2]&&(H=ie[2]|0,H in $||($[H]=new pe)));break;case"define":var se=/SHADER_NAME(_B64)?\s+(.*)$/.exec(J[2]);se&&($[H].name=se[1]?i(se[2]):se[2]);break}$[H].lines.push(new Se(N++,ee))}return Object.keys($).forEach(function(fe){var le=$[fe];le.lines.forEach(function(re){le.index[re.number]=re})}),$}function Qe(f){var h=[];return f.split(`
`).forEach(function(E){if(!(E.length<5)){var N=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(E);N?h.push(new Oe(N[1]|0,N[2]|0,N[3].trim())):E.length>0&&h.push(new Oe("unknown",0,E))}}),h}function Je(f,h){h.forEach(function(E){var N=f[E.file];if(N){var H=N.index[E.line];if(H){H.errors.push(E),N.hasErrors=!0;return}}f.unknown.hasErrors=!0,f.unknown.lines[0].errors.push(E)})}function qe(f,h,E,N,H){if(!f.getShaderParameter(h,f.COMPILE_STATUS)){var $=f.getShaderInfoLog(h),U=N===f.FRAGMENT_SHADER?"fragment":"vertex";Ar(E,"string",U+" shader source must be a string",H);var ee=We(E,H),J=Qe($);Je(ee,J),Object.keys(ee).forEach(function(ie){var se=ee[ie];if(!se.hasErrors)return;var fe=[""],le=[""];function re(ae,F){fe.push(ae),le.push(F||"")}re("file number "+ie+": "+se.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),se.lines.forEach(function(ae){if(ae.errors.length>0){re(Z(ae.number,4)+"|  ","background-color:yellow; font-weight:bold"),re(ae.line+a,"color:red; background-color:yellow; font-weight:bold");var F=0;ae.errors.forEach(function(z){var ne=z.message,be=/^\s*'(.*)'\s*:\s*(.*)$/.exec(ne);if(be){var K=be[1];switch(ne=be[2],K){case"assign":K="=";break}F=Math.max(ae.line.indexOf(K,F),0)}else F=0;re(Z("| ",6)),re(Z("^^^",F+3)+a,"font-weight:bold"),re(Z("| ",6)),re(ne+a,"font-weight:bold")}),re(Z("| ",6)+a)}else re(Z(ae.number,4)+"|  "),re(ae.line+a,"color:red")}),typeof document!="undefined"&&!window.chrome?(le[0]=fe.join("%c"),console.log.apply(console,le)):console.log(fe.join(""))}),s.raise("Error compiling "+U+" shader, "+ee[0].name)}}function rr(f,h,E,N,H){if(!f.getProgramParameter(h,f.LINK_STATUS)){var $=f.getProgramInfoLog(h),U=We(E,H),ee=We(N,H),J='Error linking program with vertex shader, "'+ee[0].name+'", and fragment shader "'+U[0].name+'"';typeof document!="undefined"?console.log("%c"+J+a+"%c"+$,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(J+a+$),s.raise(J)}}function Ke(f){f._commandRef=Ae()}function tr(f,h,E,N){Ke(f);function H(J){return J?N.id(J):0}f._fragId=H(f.static.frag),f._vertId=H(f.static.vert);function $(J,ie){Object.keys(ie).forEach(function(se){J[N.id(se)]=!0})}var U=f._uniformSet={};$(U,h.static),$(U,h.dynamic);var ee=f._attributeSet={};$(ee,E.static),$(ee,E.dynamic),f._hasCount="count"in f.static||"count"in f.dynamic||"elements"in f.static||"elements"in f.dynamic}function Me(f,h){var E=Re();c(f+" in command "+(h||Ae())+(E==="unknown"?"":" called from "+E))}function Tr(f,h,E){f||Me(h,E||Ae())}function Pr(f,h,E,N){f in h||Me("unknown parameter ("+f+")"+o(E)+". possible values: "+Object.keys(h).join(),N||Ae())}function Ar(f,h,E,N){O(f,h)||Me("invalid parameter type"+o(E)+". expected "+h+", got "+typeof f,N||Ae())}function rt(f){f()}function bt(f,h,E){f.texture?k(f.texture._texture.internalformat,h,"unsupported texture format for attachment"):k(f.renderbuffer._renderbuffer.format,E,"unsupported renderbuffer format for attachment")}var _t=33071,xt=9728,kr=9984,Zn=9985,Jn=9986,sn=9987,cn=5120,tt=5121,ln=5122,ea=5123,ra=5124,ta=5125,on=5126,Et=32819,Tt=32820,Bt=33635,nt=34042,un=36193,gr={};gr[cn]=gr[tt]=1,gr[ln]=gr[ea]=gr[un]=gr[Bt]=gr[Et]=gr[Tt]=2,gr[ra]=gr[ta]=gr[on]=gr[nt]=4;function vn(f,h){return f===Tt||f===Et||f===Bt?2:f===nt?4:gr[f]*h}function gt(f){return!(f&f-1)&&!!f}function v(f,h,E){var N,H=h.width,$=h.height,U=h.channels;s(H>0&&H<=E.maxTextureSize&&$>0&&$<=E.maxTextureSize,"invalid texture shape"),(f.wrapS!==_t||f.wrapT!==_t)&&s(gt(H)&&gt($),"incompatible wrap mode for texture, both width and height must be power of 2"),h.mipmask===1?H!==1&&$!==1&&s(f.minFilter!==kr&&f.minFilter!==Jn&&f.minFilter!==Zn&&f.minFilter!==sn,"min filter requires mipmap"):(s(gt(H)&&gt($),"texture must be a square power of 2 to support mipmapping"),s(h.mipmask===(H<<1)-1,"missing or incomplete mipmap data")),h.type===on&&(E.extensions.indexOf("oes_texture_float_linear")<0&&s(f.minFilter===xt&&f.magFilter===xt,"filter not supported, must enable oes_texture_float_linear"),s(!f.genMipmaps,"mipmap generation not supported with float textures"));var ee=h.images;for(N=0;N<16;++N)if(ee[N]){var J=H>>N,ie=$>>N;s(h.mipmask&1<<N,"missing mipmap data");var se=ee[N];if(s(se.width===J&&se.height===ie,"invalid shape for mip images"),s(se.format===h.format&&se.internalformat===h.internalformat&&se.type===h.type,"incompatible type for mip image"),!se.compressed)if(se.data){var fe=Math.ceil(vn(se.type,U)*J/se.unpackAlignment)*se.unpackAlignment;s(se.data.byteLength===fe*ie,"invalid data for image, buffer size is inconsistent with image format")}else se.element||se.copy}else f.genMipmaps||s((h.mipmask&1<<N)==0,"extra mipmap data");h.compressed&&s(!f.genMipmaps,"mipmap generation for compressed images not supported")}function g(f,h,E,N){var H=f.width,$=f.height,U=f.channels;s(H>0&&H<=N.maxTextureSize&&$>0&&$<=N.maxTextureSize,"invalid texture shape"),s(H===$,"cube map must be square"),s(h.wrapS===_t&&h.wrapT===_t,"wrap mode not supported by cube map");for(var ee=0;ee<E.length;++ee){var J=E[ee];s(J.width===H&&J.height===$,"inconsistent cube map face shape"),h.genMipmaps&&(s(!J.compressed,"can not generate mipmap for compressed textures"),s(J.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var ie=J.images,se=0;se<16;++se){var fe=ie[se];if(fe){var le=H>>se,re=$>>se;s(J.mipmask&1<<se,"missing mipmap data"),s(fe.width===le&&fe.height===re,"invalid shape for mip images"),s(fe.format===f.format&&fe.internalformat===f.internalformat&&fe.type===f.type,"incompatible type for mip image"),fe.compressed||(fe.data?s(fe.data.byteLength===le*re*Math.max(vn(fe.type,U),fe.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):fe.element||fe.copy)}}}}var l=n(s,{optional:rt,raise:c,commandRaise:Me,command:Tr,parameter:d,commandParameter:Pr,constructor:L,type:T,commandType:Ar,isTypedArray:_,nni:w,oneOf:k,shaderError:qe,linkError:rr,callSite:Re,saveCommandRef:Ke,saveDrawInfo:tr,framebufferFormat:bt,guessCommand:Ae,texture2D:v,textureCube:g}),Ee=0,ze=0,fr=5,Ir=6;function Sr(f,h){this.id=Ee++,this.type=f,this.data=h}function dn(f){return f.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function kt(f){if(f.length===0)return[];var h=f.charAt(0),E=f.charAt(f.length-1);if(f.length>1&&h===E&&(h==='"'||h==="'"))return['"'+dn(f.substr(1,f.length-2))+'"'];var N=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(f);if(N)return kt(f.substr(0,N.index)).concat(kt(N[1])).concat(kt(f.substr(N.index+N[0].length)));var H=f.split(".");if(H.length===1)return['"'+dn(f)+'"'];for(var $=[],U=0;U<H.length;++U)$=$.concat(kt(H[U]));return $}function oi(f){return"["+kt(f).join("][")+"]"}function _c(f,h){return new Sr(f,oi(h+""))}function xc(f){return typeof f=="function"&&!f._reglType||f instanceof Sr}function ui(f,h){if(typeof f=="function")return new Sr(ze,f);if(typeof f=="number"||typeof f=="boolean")return new Sr(fr,f);if(Array.isArray(f))return new Sr(Ir,f.map(function(E,N){return ui(E,h+"["+N+"]")}));if(f instanceof Sr)return f;l(!1,"invalid option type in uniform "+h)}var Rr={DynamicVariable:Sr,define:_c,isDynamic:xc,unbox:ui,accessor:oi},na={next:typeof requestAnimationFrame=="function"?function(f){return requestAnimationFrame(f)}:function(f){return setTimeout(f,16)},cancel:typeof cancelAnimationFrame=="function"?function(f){return cancelAnimationFrame(f)}:clearTimeout},vi=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Ec(){var f={"":0},h=[""];return{id:function(E){var N=f[E];return N||(N=f[E]=h.length,h.push(E),N)},str:function(E){return h[E]}}}function Tc(f,h,E){var N=document.createElement("canvas");n(N.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),f.appendChild(N),f===document.body&&(N.style.position="absolute",n(f.style,{margin:0,padding:0}));function H(){var ee=window.innerWidth,J=window.innerHeight;if(f!==document.body){var ie=N.getBoundingClientRect();ee=ie.right-ie.left,J=ie.bottom-ie.top}N.width=E*ee,N.height=E*J}var $;f!==document.body&&typeof ResizeObserver=="function"?($=new ResizeObserver(function(){setTimeout(H)}),$.observe(f)):window.addEventListener("resize",H,!1);function U(){$?$.disconnect():window.removeEventListener("resize",H),f.removeChild(N)}return H(),{canvas:N,onDestroy:U}}function gc(f,h){function E(N){try{return f.getContext(N,h)}catch(H){return null}}return E("webgl")||E("experimental-webgl")||E("webgl-experimental")}function Ac(f){return typeof f.nodeName=="string"&&typeof f.appendChild=="function"&&typeof f.getBoundingClientRect=="function"}function Mc(f){return typeof f.drawArrays=="function"||typeof f.drawElements=="function"}function di(f){return typeof f=="string"?f.split():(l(Array.isArray(f),"invalid extension array"),f)}function hi(f){return typeof f=="string"?(l(typeof document!="undefined","not supported outside of DOM"),document.querySelector(f)):f}function Sc(f){var h=f||{},E,N,H,$,U={},ee=[],J=[],ie=typeof window=="undefined"?1:window.devicePixelRatio,se=!1,fe=function(ae){ae&&l.raise(ae)},le=function(){};if(typeof h=="string"?(l(typeof document!="undefined","selector queries only supported in DOM enviroments"),E=document.querySelector(h),l(E,"invalid query string for element")):typeof h=="object"?Ac(h)?E=h:Mc(h)?($=h,H=$.canvas):(l.constructor(h),"gl"in h?$=h.gl:"canvas"in h?H=hi(h.canvas):"container"in h&&(N=hi(h.container)),"attributes"in h&&(U=h.attributes,l.type(U,"object","invalid context attributes")),"extensions"in h&&(ee=di(h.extensions)),"optionalExtensions"in h&&(J=di(h.optionalExtensions)),"onDone"in h&&(l.type(h.onDone,"function","invalid or missing onDone callback"),fe=h.onDone),"profile"in h&&(se=!!h.profile),"pixelRatio"in h&&(ie=+h.pixelRatio,l(ie>0,"invalid pixel ratio"))):l.raise("invalid arguments to regl"),E&&(E.nodeName.toLowerCase()==="canvas"?H=E:N=E),!$){if(!H){l(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var re=Tc(N||document.body,fe,ie);if(!re)return null;H=re.canvas,le=re.onDestroy}U.premultipliedAlpha===void 0&&(U.premultipliedAlpha=!0),$=gc(H,U)}return $?{gl:$,canvas:H,container:N,extensions:ee,optionalExtensions:J,pixelRatio:ie,profile:se,onDone:fe,onDestroy:le}:(le(),fe("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function wc(f,h){var E={};function N(U){l.type(U,"string","extension name must be string");var ee=U.toLowerCase(),J;try{J=E[ee]=f.getExtension(ee)}catch(ie){}return!!J}for(var H=0;H<h.extensions.length;++H){var $=h.extensions[H];if(!N($))return h.onDestroy(),h.onDone('"'+$+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return h.optionalExtensions.forEach(N),{extensions:E,restore:function(){Object.keys(E).forEach(function(U){if(E[U]&&!N(U))throw new Error("(regl): error restoring extension "+U)})}}}function Lr(f,h){for(var E=Array(f),N=0;N<f;++N)E[N]=h(N);return E}var Oc=5120,Rc=5121,Lc=5122,Cc=5123,Fc=5124,Gc=5125,Dc=5126;function Pc(f){for(var h=16;h<=1<<28;h*=16)if(f<=h)return h;return 0}function mi(f){var h,E;return h=(f>65535)<<4,f>>>=h,E=(f>255)<<3,f>>>=E,h|=E,E=(f>15)<<2,f>>>=E,h|=E,E=(f>3)<<1,f>>>=E,h|=E,h|f>>1}function pi(){var f=Lr(8,function(){return[]});function h($){var U=Pc($),ee=f[mi(U)>>2];return ee.length>0?ee.pop():new ArrayBuffer(U)}function E($){f[mi($.byteLength)>>2].push($)}function N($,U){var ee=null;switch($){case Oc:ee=new Int8Array(h(U),0,U);break;case Rc:ee=new Uint8Array(h(U),0,U);break;case Lc:ee=new Int16Array(h(2*U),0,U);break;case Cc:ee=new Uint16Array(h(2*U),0,U);break;case Fc:ee=new Int32Array(h(4*U),0,U);break;case Gc:ee=new Uint32Array(h(4*U),0,U);break;case Dc:ee=new Float32Array(h(4*U),0,U);break;default:return null}return ee.length!==U?ee.subarray(0,U):ee}function H($){E($.buffer)}return{alloc:h,free:E,allocType:N,freeType:H}}var or=pi();or.zero=pi();var Ic=3408,$c=3410,Nc=3411,Bc=3412,kc=3413,zc=3414,Uc=3415,Vc=33901,jc=33902,Xc=3379,qc=3386,Hc=34921,Yc=36347,Wc=36348,Qc=35661,Kc=35660,Zc=34930,Jc=36349,el=34076,rl=34024,tl=7936,nl=7937,al=7938,il=35724,fl=34047,sl=36063,cl=34852,hn=3553,yi=34067,ll=34069,ol=33984,zt=6408,aa=5126,bi=5121,ia=36160,ul=36053,vl=36064,dl=16384,hl=function(f,h){var E=1;h.ext_texture_filter_anisotropic&&(E=f.getParameter(fl));var N=1,H=1;h.webgl_draw_buffers&&(N=f.getParameter(cl),H=f.getParameter(sl));var $=!!h.oes_texture_float;if($){var U=f.createTexture();f.bindTexture(hn,U),f.texImage2D(hn,0,zt,1,1,0,zt,aa,null);var ee=f.createFramebuffer();if(f.bindFramebuffer(ia,ee),f.framebufferTexture2D(ia,vl,hn,U,0),f.bindTexture(hn,null),f.checkFramebufferStatus(ia)!==ul)$=!1;else{f.viewport(0,0,1,1),f.clearColor(1,0,0,1),f.clear(dl);var J=or.allocType(aa,4);f.readPixels(0,0,1,1,zt,aa,J),f.getError()?$=!1:(f.deleteFramebuffer(ee),f.deleteTexture(U),$=J[0]===1),or.freeType(J)}}var ie=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),se=!0;if(!ie){var fe=f.createTexture(),le=or.allocType(bi,36);f.activeTexture(ol),f.bindTexture(yi,fe),f.texImage2D(ll,0,zt,3,3,0,zt,bi,le),or.freeType(le),f.bindTexture(yi,null),f.deleteTexture(fe),se=!f.getError()}return{colorBits:[f.getParameter($c),f.getParameter(Nc),f.getParameter(Bc),f.getParameter(kc)],depthBits:f.getParameter(zc),stencilBits:f.getParameter(Uc),subpixelBits:f.getParameter(Ic),extensions:Object.keys(h).filter(function(re){return!!h[re]}),maxAnisotropic:E,maxDrawbuffers:N,maxColorAttachments:H,pointSizeDims:f.getParameter(Vc),lineWidthDims:f.getParameter(jc),maxViewportDims:f.getParameter(qc),maxCombinedTextureUnits:f.getParameter(Qc),maxCubeMapSize:f.getParameter(el),maxRenderbufferSize:f.getParameter(rl),maxTextureUnits:f.getParameter(Zc),maxTextureSize:f.getParameter(Xc),maxAttributes:f.getParameter(Hc),maxVertexUniforms:f.getParameter(Yc),maxVertexTextureUnits:f.getParameter(Kc),maxVaryingVectors:f.getParameter(Wc),maxFragmentUniforms:f.getParameter(Jc),glsl:f.getParameter(il),renderer:f.getParameter(nl),vendor:f.getParameter(tl),version:f.getParameter(al),readFloat:$,npotTextureCube:se}};function $r(f){return!!f&&typeof f=="object"&&Array.isArray(f.shape)&&Array.isArray(f.stride)&&typeof f.offset=="number"&&f.shape.length===f.stride.length&&(Array.isArray(f.data)||t(f.data))}var Cr=function(f){return Object.keys(f).map(function(h){return f[h]})},mn={shape:bl,flatten:yl};function ml(f,h,E){for(var N=0;N<h;++N)E[N]=f[N]}function pl(f,h,E,N){for(var H=0,$=0;$<h;++$)for(var U=f[$],ee=0;ee<E;++ee)N[H++]=U[ee]}function _i(f,h,E,N,H,$){for(var U=$,ee=0;ee<h;++ee)for(var J=f[ee],ie=0;ie<E;++ie)for(var se=J[ie],fe=0;fe<N;++fe)H[U++]=se[fe]}function xi(f,h,E,N,H){for(var $=1,U=E+1;U<h.length;++U)$*=h[U];var ee=h[E];if(h.length-E==4){var J=h[E+1],ie=h[E+2],se=h[E+3];for(U=0;U<ee;++U)_i(f[U],J,ie,se,N,H),H+=$}else for(U=0;U<ee;++U)xi(f[U],h,E+1,N,H),H+=$}function yl(f,h,E,N){var H=1;if(h.length)for(var $=0;$<h.length;++$)H*=h[$];else H=0;var U=N||or.allocType(E,H);switch(h.length){case 0:break;case 1:ml(f,h[0],U);break;case 2:pl(f,h[0],h[1],U);break;case 3:_i(f,h[0],h[1],h[2],U,0);break;default:xi(f,h,0,U,0)}return U}function bl(f){for(var h=[],E=f;E.length;E=E[0])h.push(E.length);return h}var fa={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},_l=5120,xl=5122,El=5124,Tl=5121,gl=5123,Al=5125,Ml=5126,Sl=5126,at={int8:_l,int16:xl,int32:El,uint8:Tl,uint16:gl,uint32:Al,float:Ml,float32:Sl},wl=35048,Ol=35040,pn={dynamic:wl,stream:Ol,static:35044},sa=mn.flatten,Ei=mn.shape,Ti=35044,Rl=35040,ca=5121,la=5126,Yr=[];Yr[5120]=1,Yr[5122]=2,Yr[5124]=4,Yr[5121]=1,Yr[5123]=2,Yr[5125]=4,Yr[5126]=4;function yn(f){return fa[Object.prototype.toString.call(f)]|0}function gi(f,h){for(var E=0;E<h.length;++E)f[E]=h[E]}function Ai(f,h,E,N,H,$,U){for(var ee=0,J=0;J<E;++J)for(var ie=0;ie<N;++ie)f[ee++]=h[H*J+$*ie+U]}function Ll(f,h,E,N){var H=0,$={};function U(F){this.id=H++,this.buffer=f.createBuffer(),this.type=F,this.usage=Ti,this.byteLength=0,this.dimension=1,this.dtype=ca,this.persistentData=null,E.profile&&(this.stats={size:0})}U.prototype.bind=function(){f.bindBuffer(this.type,this.buffer)},U.prototype.destroy=function(){le(this)};var ee=[];function J(F,z){var ne=ee.pop();return ne||(ne=new U(F)),ne.bind(),fe(ne,z,Rl,0,1,!1),ne}function ie(F){ee.push(F)}function se(F,z,ne){F.byteLength=z.byteLength,f.bufferData(F.type,z,ne)}function fe(F,z,ne,be,K,me){var de;if(F.usage=ne,Array.isArray(z)){if(F.dtype=be||la,z.length>0){var Ce;if(Array.isArray(z[0])){de=Ei(z);for(var Y=1,q=1;q<de.length;++q)Y*=de[q];F.dimension=Y,Ce=sa(z,de,F.dtype),se(F,Ce,ne),me?F.persistentData=Ce:or.freeType(Ce)}else if(typeof z[0]=="number"){F.dimension=K;var Te=or.allocType(F.dtype,z.length);gi(Te,z),se(F,Te,ne),me?F.persistentData=Te:or.freeType(Te)}else t(z[0])?(F.dimension=z[0].length,F.dtype=be||yn(z[0])||la,Ce=sa(z,[z.length,z[0].length],F.dtype),se(F,Ce,ne),me?F.persistentData=Ce:or.freeType(Ce)):l.raise("invalid buffer data")}}else if(t(z))F.dtype=be||yn(z),F.dimension=K,se(F,z,ne),me&&(F.persistentData=new Uint8Array(new Uint8Array(z.buffer)));else if($r(z)){de=z.shape;var oe=z.stride,te=z.offset,ue=0,ve=0,Ne=0,$e=0;de.length===1?(ue=de[0],ve=1,Ne=oe[0],$e=0):de.length===2?(ue=de[0],ve=de[1],Ne=oe[0],$e=oe[1]):l.raise("invalid shape"),F.dtype=be||yn(z.data)||la,F.dimension=ve;var he=or.allocType(F.dtype,ue*ve);Ai(he,z.data,ue,ve,Ne,$e,te),se(F,he,ne),me?F.persistentData=he:or.freeType(he)}else z instanceof ArrayBuffer?(F.dtype=ca,F.dimension=K,se(F,z,ne),me&&(F.persistentData=new Uint8Array(new Uint8Array(z)))):l.raise("invalid buffer data")}function le(F){h.bufferCount--,N(F);var z=F.buffer;l(z,"buffer must not be deleted already"),f.deleteBuffer(z),F.buffer=null,delete $[F.id]}function re(F,z,ne,be){h.bufferCount++;var K=new U(z);$[K.id]=K;function me(Y){var q=Ti,Te=null,oe=0,te=0,ue=1;return Array.isArray(Y)||t(Y)||$r(Y)||Y instanceof ArrayBuffer?Te=Y:typeof Y=="number"?oe=Y|0:Y&&(l.type(Y,"object","buffer arguments must be an object, a number or an array"),"data"in Y&&(l(Te===null||Array.isArray(Te)||t(Te)||$r(Te),"invalid data for buffer"),Te=Y.data),"usage"in Y&&(l.parameter(Y.usage,pn,"invalid buffer usage"),q=pn[Y.usage]),"type"in Y&&(l.parameter(Y.type,at,"invalid buffer type"),te=at[Y.type]),"dimension"in Y&&(l.type(Y.dimension,"number","invalid dimension"),ue=Y.dimension|0),"length"in Y&&(l.nni(oe,"buffer length must be a nonnegative integer"),oe=Y.length|0)),K.bind(),Te?fe(K,Te,q,te,ue,be):(oe&&f.bufferData(K.type,oe,q),K.dtype=te||ca,K.usage=q,K.dimension=ue,K.byteLength=oe),E.profile&&(K.stats.size=K.byteLength*Yr[K.dtype]),me}function de(Y,q){l(q+Y.byteLength<=K.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Y.byteLength+" starting from offset "+q+" to a buffer of size "+K.byteLength),f.bufferSubData(K.type,q,Y)}function Ce(Y,q){var Te=(q||0)|0,oe;if(K.bind(),t(Y)||Y instanceof ArrayBuffer)de(Y,Te);else if(Array.isArray(Y)){if(Y.length>0)if(typeof Y[0]=="number"){var te=or.allocType(K.dtype,Y.length);gi(te,Y),de(te,Te),or.freeType(te)}else if(Array.isArray(Y[0])||t(Y[0])){oe=Ei(Y);var ue=sa(Y,oe,K.dtype);de(ue,Te),or.freeType(ue)}else l.raise("invalid buffer data")}else if($r(Y)){oe=Y.shape;var ve=Y.stride,Ne=0,$e=0,he=0,ye=0;oe.length===1?(Ne=oe[0],$e=1,he=ve[0],ye=0):oe.length===2?(Ne=oe[0],$e=oe[1],he=ve[0],ye=ve[1]):l.raise("invalid shape");var De=Array.isArray(Y.data)?K.dtype:yn(Y.data),Be=or.allocType(De,Ne*$e);Ai(Be,Y.data,Ne,$e,he,ye,Y.offset),de(Be,Te),or.freeType(Be)}else l.raise("invalid data for buffer subdata");return me}return ne||me(F),me._reglType="buffer",me._buffer=K,me.subdata=Ce,E.profile&&(me.stats=K.stats),me.destroy=function(){le(K)},me}function ae(){Cr($).forEach(function(F){F.buffer=f.createBuffer(),f.bindBuffer(F.type,F.buffer),f.bufferData(F.type,F.persistentData||F.byteLength,F.usage)})}return E.profile&&(h.getTotalBufferSize=function(){var F=0;return Object.keys($).forEach(function(z){F+=$[z].stats.size}),F}),{create:re,createStream:J,destroyStream:ie,clear:function(){Cr($).forEach(le),ee.forEach(le)},getBuffer:function(F){return F&&F._buffer instanceof U?F._buffer:null},restore:ae,_initBuffer:fe}}var Cl=0,Fl=0,Gl=1,Dl=1,Pl=4,Il=4,Wr={points:Cl,point:Fl,lines:Gl,line:Dl,triangles:Pl,triangle:Il,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},$l=0,Nl=1,Ut=4,Bl=5120,At=5121,Mi=5122,Mt=5123,Si=5124,it=5125,oa=34963,kl=35040,zl=35044;function Ul(f,h,E,N){var H={},$=0,U={uint8:At,uint16:Mt};h.oes_element_index_uint&&(U.uint32=it);function ee(ae){this.id=$++,H[this.id]=this,this.buffer=ae,this.primType=Ut,this.vertCount=0,this.type=0}ee.prototype.bind=function(){this.buffer.bind()};var J=[];function ie(ae){var F=J.pop();return F||(F=new ee(E.create(null,oa,!0,!1)._buffer)),fe(F,ae,kl,-1,-1,0,0),F}function se(ae){J.push(ae)}function fe(ae,F,z,ne,be,K,me){ae.buffer.bind();var de;if(F){var Ce=me;!me&&(!t(F)||$r(F)&&!t(F.data))&&(Ce=h.oes_element_index_uint?it:Mt),E._initBuffer(ae.buffer,F,z,Ce,3)}else f.bufferData(oa,K,z),ae.buffer.dtype=de||At,ae.buffer.usage=z,ae.buffer.dimension=3,ae.buffer.byteLength=K;if(de=me,!me){switch(ae.buffer.dtype){case At:case Bl:de=At;break;case Mt:case Mi:de=Mt;break;case it:case Si:de=it;break;default:l.raise("unsupported type for element array")}ae.buffer.dtype=de}ae.type=de,l(de!==it||!!h.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Y=be;Y<0&&(Y=ae.buffer.byteLength,de===Mt?Y>>=1:de===it&&(Y>>=2)),ae.vertCount=Y;var q=ne;if(ne<0){q=Ut;var Te=ae.buffer.dimension;Te===1&&(q=$l),Te===2&&(q=Nl),Te===3&&(q=Ut)}ae.primType=q}function le(ae){N.elementsCount--,l(ae.buffer!==null,"must not double destroy elements"),delete H[ae.id],ae.buffer.destroy(),ae.buffer=null}function re(ae,F){var z=E.create(null,oa,!0),ne=new ee(z._buffer);N.elementsCount++;function be(K){if(!K)z(),ne.primType=Ut,ne.vertCount=0,ne.type=At;else if(typeof K=="number")z(K),ne.primType=Ut,ne.vertCount=K|0,ne.type=At;else{var me=null,de=zl,Ce=-1,Y=-1,q=0,Te=0;Array.isArray(K)||t(K)||$r(K)?me=K:(l.type(K,"object","invalid arguments for elements"),"data"in K&&(me=K.data,l(Array.isArray(me)||t(me)||$r(me),"invalid data for element buffer")),"usage"in K&&(l.parameter(K.usage,pn,"invalid element buffer usage"),de=pn[K.usage]),"primitive"in K&&(l.parameter(K.primitive,Wr,"invalid element buffer primitive"),Ce=Wr[K.primitive]),"count"in K&&(l(typeof K.count=="number"&&K.count>=0,"invalid vertex count for elements"),Y=K.count|0),"type"in K&&(l.parameter(K.type,U,"invalid buffer type"),Te=U[K.type]),"length"in K?q=K.length|0:(q=Y,Te===Mt||Te===Mi?q*=2:(Te===it||Te===Si)&&(q*=4))),fe(ne,me,de,Ce,Y,q,Te)}return be}return be(ae),be._reglType="elements",be._elements=ne,be.subdata=function(K,me){return z.subdata(K,me),be},be.destroy=function(){le(ne)},be}return{create:re,createStream:ie,destroyStream:se,getElements:function(ae){return typeof ae=="function"&&ae._elements instanceof ee?ae._elements:null},clear:function(){Cr(H).forEach(le)}}}var wi=new Float32Array(1),Vl=new Uint32Array(wi.buffer),jl=5123;function Oi(f){for(var h=or.allocType(jl,f.length),E=0;E<f.length;++E)if(isNaN(f[E]))h[E]=65535;else if(f[E]===1/0)h[E]=31744;else if(f[E]===-1/0)h[E]=64512;else{wi[0]=f[E];var N=Vl[0],H=N>>>31<<15,$=(N<<1>>>24)-127,U=N>>13&(1<<10)-1;if($<-24)h[E]=H;else if($<-14){var ee=-14-$;h[E]=H+(U+(1<<10)>>ee)}else $>15?h[E]=H+31744:h[E]=H+($+15<<10)+U}return h}function ar(f){return Array.isArray(f)||t(f)}var Ri=function(f){return!(f&f-1)&&!!f},Xl=34467,zr=3553,ua=34067,bn=34069,ft=6408,va=6406,_n=6407,Vt=6409,xn=6410,Li=32854,da=32855,Ci=36194,ql=32819,Hl=32820,Yl=33635,Wl=34042,ha=6402,En=34041,ma=35904,pa=35906,St=36193,ya=33776,ba=33777,_a=33778,xa=33779,Fi=35986,Gi=35987,Di=34798,Pi=35840,Ii=35841,$i=35842,Ni=35843,Bi=36196,wt=5121,Ea=5123,Ta=5125,jt=5126,Ql=10242,Kl=10243,Zl=10497,ga=33071,Jl=33648,eo=10240,ro=10241,Aa=9728,to=9729,Ma=9984,ki=9985,zi=9986,Sa=9987,no=33170,Tn=4352,ao=4353,io=4354,fo=34046,so=3317,co=37440,lo=37441,oo=37443,Ui=37444,Xt=33984,uo=[Ma,zi,ki,Sa],gn=[0,Vt,xn,_n,ft],Gr={};Gr[Vt]=Gr[va]=Gr[ha]=1,Gr[En]=Gr[xn]=2,Gr[_n]=Gr[ma]=3,Gr[ft]=Gr[pa]=4;function Ot(f){return"[object "+f+"]"}var Vi=Ot("HTMLCanvasElement"),ji=Ot("OffscreenCanvas"),Xi=Ot("CanvasRenderingContext2D"),qi=Ot("ImageBitmap"),Hi=Ot("HTMLImageElement"),Yi=Ot("HTMLVideoElement"),vo=Object.keys(fa).concat([Vi,ji,Xi,qi,Hi,Yi]),Rt=[];Rt[wt]=1,Rt[jt]=4,Rt[St]=2,Rt[Ea]=2,Rt[Ta]=4;var br=[];br[Li]=2,br[da]=2,br[Ci]=2,br[En]=4,br[ya]=.5,br[ba]=.5,br[_a]=1,br[xa]=1,br[Fi]=.5,br[Gi]=1,br[Di]=1,br[Pi]=.5,br[Ii]=.25,br[$i]=.5,br[Ni]=.25,br[Bi]=.5;function Wi(f){return Array.isArray(f)&&(f.length===0||typeof f[0]=="number")}function Qi(f){if(!Array.isArray(f))return!1;var h=f.length;return!(h===0||!ar(f[0]))}function st(f){return Object.prototype.toString.call(f)}function Ki(f){return st(f)===Vi}function Zi(f){return st(f)===ji}function ho(f){return st(f)===Xi}function mo(f){return st(f)===qi}function po(f){return st(f)===Hi}function yo(f){return st(f)===Yi}function wa(f){if(!f)return!1;var h=st(f);return vo.indexOf(h)>=0?!0:Wi(f)||Qi(f)||$r(f)}function Ji(f){return fa[Object.prototype.toString.call(f)]|0}function bo(f,h){var E=h.length;switch(f.type){case wt:case Ea:case Ta:case jt:var N=or.allocType(f.type,E);N.set(h),f.data=N;break;case St:f.data=Oi(h);break;default:l.raise("unsupported texture type, must specify a typed array")}}function ef(f,h){return or.allocType(f.type===St?jt:f.type,h)}function rf(f,h){f.type===St?(f.data=Oi(h),or.freeType(h)):f.data=h}function _o(f,h,E,N,H,$){for(var U=f.width,ee=f.height,J=f.channels,ie=U*ee*J,se=ef(f,ie),fe=0,le=0;le<ee;++le)for(var re=0;re<U;++re)for(var ae=0;ae<J;++ae)se[fe++]=h[E*re+N*le+H*ae+$];rf(f,se)}function An(f,h,E,N,H,$){var U;if(typeof br[f]!="undefined"?U=br[f]:U=Gr[f]*Rt[h],$&&(U*=6),H){for(var ee=0,J=E;J>=1;)ee+=U*J*J,J/=2;return ee}else return U*E*N}function xo(f,h,E,N,H,$,U){var ee={"don't care":Tn,"dont care":Tn,nice:io,fast:ao},J={repeat:Zl,clamp:ga,mirror:Jl},ie={nearest:Aa,linear:to},se=n({mipmap:Sa,"nearest mipmap nearest":Ma,"linear mipmap nearest":ki,"nearest mipmap linear":zi,"linear mipmap linear":Sa},ie),fe={none:0,browser:Ui},le={uint8:wt,rgba4:ql,rgb565:Yl,"rgb5 a1":Hl},re={alpha:va,luminance:Vt,"luminance alpha":xn,rgb:_n,rgba:ft,rgba4:Li,"rgb5 a1":da,rgb565:Ci},ae={};h.ext_srgb&&(re.srgb=ma,re.srgba=pa),h.oes_texture_float&&(le.float32=le.float=jt),h.oes_texture_half_float&&(le.float16=le["half float"]=St),h.webgl_depth_texture&&(n(re,{depth:ha,"depth stencil":En}),n(le,{uint16:Ea,uint32:Ta,"depth stencil":Wl})),h.webgl_compressed_texture_s3tc&&n(ae,{"rgb s3tc dxt1":ya,"rgba s3tc dxt1":ba,"rgba s3tc dxt3":_a,"rgba s3tc dxt5":xa}),h.webgl_compressed_texture_atc&&n(ae,{"rgb atc":Fi,"rgba atc explicit alpha":Gi,"rgba atc interpolated alpha":Di}),h.webgl_compressed_texture_pvrtc&&n(ae,{"rgb pvrtc 4bppv1":Pi,"rgb pvrtc 2bppv1":Ii,"rgba pvrtc 4bppv1":$i,"rgba pvrtc 2bppv1":Ni}),h.webgl_compressed_texture_etc1&&(ae["rgb etc1"]=Bi);var F=Array.prototype.slice.call(f.getParameter(Xl));Object.keys(ae).forEach(function(b){var B=ae[b];F.indexOf(B)>=0&&(re[b]=B)});var z=Object.keys(re);E.textureFormats=z;var ne=[];Object.keys(re).forEach(function(b){var B=re[b];ne[B]=b});var be=[];Object.keys(le).forEach(function(b){var B=le[b];be[B]=b});var K=[];Object.keys(ie).forEach(function(b){var B=ie[b];K[B]=b});var me=[];Object.keys(se).forEach(function(b){var B=se[b];me[B]=b});var de=[];Object.keys(J).forEach(function(b){var B=J[b];de[B]=b});var Ce=z.reduce(function(b,B){var I=re[B];return I===Vt||I===va||I===Vt||I===xn||I===ha||I===En||h.ext_srgb&&(I===ma||I===pa)?b[I]=I:I===da||B.indexOf("rgba")>=0?b[I]=ft:b[I]=_n,b},{});function Y(){this.internalformat=ft,this.format=ft,this.type=wt,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Ui,this.width=0,this.height=0,this.channels=0}function q(b,B){b.internalformat=B.internalformat,b.format=B.format,b.type=B.type,b.compressed=B.compressed,b.premultiplyAlpha=B.premultiplyAlpha,b.flipY=B.flipY,b.unpackAlignment=B.unpackAlignment,b.colorSpace=B.colorSpace,b.width=B.width,b.height=B.height,b.channels=B.channels}function Te(b,B){if(!(typeof B!="object"||!B)){if("premultiplyAlpha"in B&&(l.type(B.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),b.premultiplyAlpha=B.premultiplyAlpha),"flipY"in B&&(l.type(B.flipY,"boolean","invalid texture flip"),b.flipY=B.flipY),"alignment"in B&&(l.oneOf(B.alignment,[1,2,4,8],"invalid texture unpack alignment"),b.unpackAlignment=B.alignment),"colorSpace"in B&&(l.parameter(B.colorSpace,fe,"invalid colorSpace"),b.colorSpace=fe[B.colorSpace]),"type"in B){var I=B.type;l(h.oes_texture_float||!(I==="float"||I==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),l(h.oes_texture_half_float||!(I==="half float"||I==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),l(h.webgl_depth_texture||!(I==="uint16"||I==="uint32"||I==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),l.parameter(I,le,"invalid texture type"),b.type=le[I]}var xe=b.width,Ue=b.height,m=b.channels,u=!1;"shape"in B?(l(Array.isArray(B.shape)&&B.shape.length>=2,"shape must be an array"),xe=B.shape[0],Ue=B.shape[1],B.shape.length===3&&(m=B.shape[2],l(m>0&&m<=4,"invalid number of channels"),u=!0),l(xe>=0&&xe<=E.maxTextureSize,"invalid width"),l(Ue>=0&&Ue<=E.maxTextureSize,"invalid height")):("radius"in B&&(xe=Ue=B.radius,l(xe>=0&&xe<=E.maxTextureSize,"invalid radius")),"width"in B&&(xe=B.width,l(xe>=0&&xe<=E.maxTextureSize,"invalid width")),"height"in B&&(Ue=B.height,l(Ue>=0&&Ue<=E.maxTextureSize,"invalid height")),"channels"in B&&(m=B.channels,l(m>0&&m<=4,"invalid number of channels"),u=!0)),b.width=xe|0,b.height=Ue|0,b.channels=m|0;var A=!1;if("format"in B){var C=B.format;l(h.webgl_depth_texture||!(C==="depth"||C==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),l.parameter(C,re,"invalid texture format");var G=b.internalformat=re[C];b.format=Ce[G],C in le&&("type"in B||(b.type=le[C])),C in ae&&(b.compressed=!0),A=!0}!u&&A?b.channels=Gr[b.format]:u&&!A?b.channels!==gn[b.format]&&(b.format=b.internalformat=gn[b.channels]):A&&u&&l(b.channels===Gr[b.format],"number of channels inconsistent with specified format")}}function oe(b){f.pixelStorei(co,b.flipY),f.pixelStorei(lo,b.premultiplyAlpha),f.pixelStorei(oo,b.colorSpace),f.pixelStorei(so,b.unpackAlignment)}function te(){Y.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function ue(b,B){var I=null;if(wa(B)?I=B:B&&(l.type(B,"object","invalid pixel data type"),Te(b,B),"x"in B&&(b.xOffset=B.x|0),"y"in B&&(b.yOffset=B.y|0),wa(B.data)&&(I=B.data)),l(!b.compressed||I instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),B.copy){l(!I,"can not specify copy and data field for the same texture");var xe=H.viewportWidth,Ue=H.viewportHeight;b.width=b.width||xe-b.xOffset,b.height=b.height||Ue-b.yOffset,b.needsCopy=!0,l(b.xOffset>=0&&b.xOffset<xe&&b.yOffset>=0&&b.yOffset<Ue&&b.width>0&&b.width<=xe&&b.height>0&&b.height<=Ue,"copy texture read out of bounds")}else if(!I)b.width=b.width||1,b.height=b.height||1,b.channels=b.channels||4;else if(t(I))b.channels=b.channels||4,b.data=I,!("type"in B)&&b.type===wt&&(b.type=Ji(I));else if(Wi(I))b.channels=b.channels||4,bo(b,I),b.alignment=1,b.needsFree=!0;else if($r(I)){var m=I.data;!Array.isArray(m)&&b.type===wt&&(b.type=Ji(m));var u=I.shape,A=I.stride,C,G,S,M,R,p;u.length===3?(S=u[2],p=A[2]):(l(u.length===2,"invalid ndarray pixel data, must be 2 or 3D"),S=1,p=1),C=u[0],G=u[1],M=A[0],R=A[1],b.alignment=1,b.width=C,b.height=G,b.channels=S,b.format=b.internalformat=gn[S],b.needsFree=!0,_o(b,m,M,R,p,I.offset)}else if(Ki(I)||Zi(I)||ho(I))Ki(I)||Zi(I)?b.element=I:b.element=I.canvas,b.width=b.element.width,b.height=b.element.height,b.channels=4;else if(mo(I))b.element=I,b.width=I.width,b.height=I.height,b.channels=4;else if(po(I))b.element=I,b.width=I.naturalWidth,b.height=I.naturalHeight,b.channels=4;else if(yo(I))b.element=I,b.width=I.videoWidth,b.height=I.videoHeight,b.channels=4;else if(Qi(I)){var x=b.width||I[0].length,y=b.height||I.length,P=b.channels;ar(I[0][0])?P=P||I[0][0].length:P=P||1;for(var D=mn.shape(I),X=1,W=0;W<D.length;++W)X*=D[W];var ce=ef(b,X);mn.flatten(I,D,"",ce),rf(b,ce),b.alignment=1,b.width=x,b.height=y,b.channels=P,b.format=b.internalformat=gn[P],b.needsFree=!0}b.type===jt?l(E.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):b.type===St&&l(E.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function ve(b,B,I){var xe=b.element,Ue=b.data,m=b.internalformat,u=b.format,A=b.type,C=b.width,G=b.height;oe(b),xe?f.texImage2D(B,I,u,u,A,xe):b.compressed?f.compressedTexImage2D(B,I,m,C,G,0,Ue):b.needsCopy?(N(),f.copyTexImage2D(B,I,u,b.xOffset,b.yOffset,C,G,0)):f.texImage2D(B,I,u,C,G,0,u,A,Ue||null)}function Ne(b,B,I,xe,Ue){var m=b.element,u=b.data,A=b.internalformat,C=b.format,G=b.type,S=b.width,M=b.height;oe(b),m?f.texSubImage2D(B,Ue,I,xe,C,G,m):b.compressed?f.compressedTexSubImage2D(B,Ue,I,xe,A,S,M,u):b.needsCopy?(N(),f.copyTexSubImage2D(B,Ue,I,xe,b.xOffset,b.yOffset,S,M)):f.texSubImage2D(B,Ue,I,xe,S,M,C,G,u)}var $e=[];function he(){return $e.pop()||new te}function ye(b){b.needsFree&&or.freeType(b.data),te.call(b),$e.push(b)}function De(){Y.call(this),this.genMipmaps=!1,this.mipmapHint=Tn,this.mipmask=0,this.images=Array(16)}function Be(b,B,I){var xe=b.images[0]=he();b.mipmask=1,xe.width=b.width=B,xe.height=b.height=I,xe.channels=b.channels=4}function Ve(b,B){var I=null;if(wa(B))I=b.images[0]=he(),q(I,b),ue(I,B),b.mipmask=1;else if(Te(b,B),Array.isArray(B.mipmap))for(var xe=B.mipmap,Ue=0;Ue<xe.length;++Ue)I=b.images[Ue]=he(),q(I,b),I.width>>=Ue,I.height>>=Ue,ue(I,xe[Ue]),b.mipmask|=1<<Ue;else I=b.images[0]=he(),q(I,b),ue(I,B),b.mipmask=1;q(b,b.images[0]),b.compressed&&(b.internalformat===ya||b.internalformat===ba||b.internalformat===_a||b.internalformat===xa)&&l(b.width%4==0&&b.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function ir(b,B){for(var I=b.images,xe=0;xe<I.length;++xe){if(!I[xe])return;ve(I[xe],B,xe)}}var sr=[];function Xe(){var b=sr.pop()||new De;Y.call(b),b.mipmask=0;for(var B=0;B<16;++B)b.images[B]=null;return b}function dr(b){for(var B=b.images,I=0;I<B.length;++I)B[I]&&ye(B[I]),B[I]=null;sr.push(b)}function nr(){this.minFilter=Aa,this.magFilter=Aa,this.wrapS=ga,this.wrapT=ga,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Tn}function vr(b,B){if("min"in B){var I=B.min;l.parameter(I,se),b.minFilter=se[I],uo.indexOf(b.minFilter)>=0&&!("faces"in B)&&(b.genMipmaps=!0)}if("mag"in B){var xe=B.mag;l.parameter(xe,ie),b.magFilter=ie[xe]}var Ue=b.wrapS,m=b.wrapT;if("wrap"in B){var u=B.wrap;typeof u=="string"?(l.parameter(u,J),Ue=m=J[u]):Array.isArray(u)&&(l.parameter(u[0],J),l.parameter(u[1],J),Ue=J[u[0]],m=J[u[1]])}else{if("wrapS"in B){var A=B.wrapS;l.parameter(A,J),Ue=J[A]}if("wrapT"in B){var C=B.wrapT;l.parameter(C,J),m=J[C]}}if(b.wrapS=Ue,b.wrapT=m,"anisotropic"in B){var G=B.anisotropic;l(typeof G=="number"&&G>=1&&G<=E.maxAnisotropic,"aniso samples must be between 1 and "),b.anisotropic=B.anisotropic}if("mipmap"in B){var S=!1;switch(typeof B.mipmap){case"string":l.parameter(B.mipmap,ee,"invalid mipmap hint"),b.mipmapHint=ee[B.mipmap],b.genMipmaps=!0,S=!0;break;case"boolean":S=b.genMipmaps=B.mipmap;break;case"object":l(Array.isArray(B.mipmap),"invalid mipmap type"),b.genMipmaps=!1,S=!0;break;default:l.raise("invalid mipmap type")}S&&!("min"in B)&&(b.minFilter=Ma)}}function hr(b,B){f.texParameteri(B,ro,b.minFilter),f.texParameteri(B,eo,b.magFilter),f.texParameteri(B,Ql,b.wrapS),f.texParameteri(B,Kl,b.wrapT),h.ext_texture_filter_anisotropic&&f.texParameteri(B,fo,b.anisotropic),b.genMipmaps&&(f.hint(no,b.mipmapHint),f.generateMipmap(B))}var mr=0,yr={},_r=E.maxTextureUnits,cr=Array(_r).map(function(){return null});function ke(b){Y.call(this),this.mipmask=0,this.internalformat=ft,this.id=mr++,this.refCount=1,this.target=b,this.texture=f.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new nr,U.profile&&(this.stats={size:0})}function xr(b){f.activeTexture(Xt),f.bindTexture(b.target,b.texture)}function Ze(){var b=cr[0];b?f.bindTexture(b.target,b.texture):f.bindTexture(zr,null)}function Fe(b){var B=b.texture;l(B,"must not double destroy texture");var I=b.unit,xe=b.target;I>=0&&(f.activeTexture(Xt+I),f.bindTexture(xe,null),cr[I]=null),f.deleteTexture(B),b.texture=null,b.params=null,b.pixels=null,b.refCount=0,delete yr[b.id],$.textureCount--}n(ke.prototype,{bind:function(){var b=this;b.bindCount+=1;var B=b.unit;if(B<0){for(var I=0;I<_r;++I){var xe=cr[I];if(xe){if(xe.bindCount>0)continue;xe.unit=-1}cr[I]=b,B=I;break}B>=_r&&l.raise("insufficient number of texture units"),U.profile&&$.maxTextureUnits<B+1&&($.maxTextureUnits=B+1),b.unit=B,f.activeTexture(Xt+B),f.bindTexture(b.target,b.texture)}return B},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Fe(this)}});function je(b,B){var I=new ke(zr);yr[I.id]=I,$.textureCount++;function xe(u,A){var C=I.texInfo;nr.call(C);var G=Xe();return typeof u=="number"?typeof A=="number"?Be(G,u|0,A|0):Be(G,u|0,u|0):u?(l.type(u,"object","invalid arguments to regl.texture"),vr(C,u),Ve(G,u)):Be(G,1,1),C.genMipmaps&&(G.mipmask=(G.width<<1)-1),I.mipmask=G.mipmask,q(I,G),l.texture2D(C,G,E),I.internalformat=G.internalformat,xe.width=G.width,xe.height=G.height,xr(I),ir(G,zr),hr(C,zr),Ze(),dr(G),U.profile&&(I.stats.size=An(I.internalformat,I.type,G.width,G.height,C.genMipmaps,!1)),xe.format=ne[I.internalformat],xe.type=be[I.type],xe.mag=K[C.magFilter],xe.min=me[C.minFilter],xe.wrapS=de[C.wrapS],xe.wrapT=de[C.wrapT],xe}function Ue(u,A,C,G){l(!!u,"must specify image data");var S=A|0,M=C|0,R=G|0,p=he();return q(p,I),p.width=0,p.height=0,ue(p,u),p.width=p.width||(I.width>>R)-S,p.height=p.height||(I.height>>R)-M,l(I.type===p.type&&I.format===p.format&&I.internalformat===p.internalformat,"incompatible format for texture.subimage"),l(S>=0&&M>=0&&S+p.width<=I.width&&M+p.height<=I.height,"texture.subimage write out of bounds"),l(I.mipmask&1<<R,"missing mipmap data"),l(p.data||p.element||p.needsCopy,"missing image data"),xr(I),Ne(p,zr,S,M,R),Ze(),ye(p),xe}function m(u,A){var C=u|0,G=A|0||C;if(C===I.width&&G===I.height)return xe;xe.width=I.width=C,xe.height=I.height=G,xr(I);for(var S=0;I.mipmask>>S;++S){var M=C>>S,R=G>>S;if(!M||!R)break;f.texImage2D(zr,S,I.format,M,R,0,I.format,I.type,null)}return Ze(),U.profile&&(I.stats.size=An(I.internalformat,I.type,C,G,!1,!1)),xe}return xe(b,B),xe.subimage=Ue,xe.resize=m,xe._reglType="texture2d",xe._texture=I,U.profile&&(xe.stats=I.stats),xe.destroy=function(){I.decRef()},xe}function He(b,B,I,xe,Ue,m){var u=new ke(ua);yr[u.id]=u,$.cubeCount++;var A=new Array(6);function C(M,R,p,x,y,P){var D,X=u.texInfo;for(nr.call(X),D=0;D<6;++D)A[D]=Xe();if(typeof M=="number"||!M){var W=M|0||1;for(D=0;D<6;++D)Be(A[D],W,W)}else if(typeof M=="object")if(R)Ve(A[0],M),Ve(A[1],R),Ve(A[2],p),Ve(A[3],x),Ve(A[4],y),Ve(A[5],P);else if(vr(X,M),Te(u,M),"faces"in M){var ce=M.faces;for(l(Array.isArray(ce)&&ce.length===6,"cube faces must be a length 6 array"),D=0;D<6;++D)l(typeof ce[D]=="object"&&!!ce[D],"invalid input for cube map face"),q(A[D],u),Ve(A[D],ce[D])}else for(D=0;D<6;++D)Ve(A[D],M);else l.raise("invalid arguments to cube map");for(q(u,A[0]),l.optional(function(){E.npotTextureCube||l(Ri(u.width)&&Ri(u.height),"your browser does not support non power or two texture dimensions")}),X.genMipmaps?u.mipmask=(A[0].width<<1)-1:u.mipmask=A[0].mipmask,l.textureCube(u,X,A,E),u.internalformat=A[0].internalformat,C.width=A[0].width,C.height=A[0].height,xr(u),D=0;D<6;++D)ir(A[D],bn+D);for(hr(X,ua),Ze(),U.profile&&(u.stats.size=An(u.internalformat,u.type,C.width,C.height,X.genMipmaps,!0)),C.format=ne[u.internalformat],C.type=be[u.type],C.mag=K[X.magFilter],C.min=me[X.minFilter],C.wrapS=de[X.wrapS],C.wrapT=de[X.wrapT],D=0;D<6;++D)dr(A[D]);return C}function G(M,R,p,x,y){l(!!R,"must specify image data"),l(typeof M=="number"&&M===(M|0)&&M>=0&&M<6,"invalid face");var P=p|0,D=x|0,X=y|0,W=he();return q(W,u),W.width=0,W.height=0,ue(W,R),W.width=W.width||(u.width>>X)-P,W.height=W.height||(u.height>>X)-D,l(u.type===W.type&&u.format===W.format&&u.internalformat===W.internalformat,"incompatible format for texture.subimage"),l(P>=0&&D>=0&&P+W.width<=u.width&&D+W.height<=u.height,"texture.subimage write out of bounds"),l(u.mipmask&1<<X,"missing mipmap data"),l(W.data||W.element||W.needsCopy,"missing image data"),xr(u),Ne(W,bn+M,P,D,X),Ze(),ye(W),C}function S(M){var R=M|0;if(R!==u.width){C.width=u.width=R,C.height=u.height=R,xr(u);for(var p=0;p<6;++p)for(var x=0;u.mipmask>>x;++x)f.texImage2D(bn+p,x,u.format,R>>x,R>>x,0,u.format,u.type,null);return Ze(),U.profile&&(u.stats.size=An(u.internalformat,u.type,C.width,C.height,!1,!0)),C}}return C(b,B,I,xe,Ue,m),C.subimage=G,C.resize=S,C._reglType="textureCube",C._texture=u,U.profile&&(C.stats=u.stats),C.destroy=function(){u.decRef()},C}function lr(){for(var b=0;b<_r;++b)f.activeTexture(Xt+b),f.bindTexture(zr,null),cr[b]=null;Cr(yr).forEach(Fe),$.cubeCount=0,$.textureCount=0}U.profile&&($.getTotalTextureSize=function(){var b=0;return Object.keys(yr).forEach(function(B){b+=yr[B].stats.size}),b});function Vr(){for(var b=0;b<_r;++b){var B=cr[b];B&&(B.bindCount=0,B.unit=-1,cr[b]=null)}Cr(yr).forEach(function(I){I.texture=f.createTexture(),f.bindTexture(I.target,I.texture);for(var xe=0;xe<32;++xe)if((I.mipmask&1<<xe)!=0)if(I.target===zr)f.texImage2D(zr,xe,I.internalformat,I.width>>xe,I.height>>xe,0,I.internalformat,I.type,null);else for(var Ue=0;Ue<6;++Ue)f.texImage2D(bn+Ue,xe,I.internalformat,I.width>>xe,I.height>>xe,0,I.internalformat,I.type,null);hr(I.texInfo,I.target)})}function ht(){for(var b=0;b<_r;++b){var B=cr[b];B&&(B.bindCount=0,B.unit=-1,cr[b]=null),f.activeTexture(Xt+b),f.bindTexture(zr,null),f.bindTexture(ua,null)}}return{create2D:je,createCube:He,clear:lr,getTexture:function(b){return null},restore:Vr,refresh:ht}}var Qr=36161,Mn=32854,tf=32855,nf=36194,af=33189,ff=36168,sf=34041,cf=35907,lf=34836,of=34842,uf=34843,Nr=[];Nr[Mn]=2,Nr[tf]=2,Nr[nf]=2,Nr[af]=2,Nr[ff]=1,Nr[sf]=4,Nr[cf]=4,Nr[lf]=16,Nr[of]=8,Nr[uf]=6;function vf(f,h,E){return Nr[f]*h*E}var Eo=function(f,h,E,N,H){var $={rgba4:Mn,rgb565:nf,"rgb5 a1":tf,depth:af,stencil:ff,"depth stencil":sf};h.ext_srgb&&($.srgba=cf),h.ext_color_buffer_half_float&&($.rgba16f=of,$.rgb16f=uf),h.webgl_color_buffer_float&&($.rgba32f=lf);var U=[];Object.keys($).forEach(function(re){var ae=$[re];U[ae]=re});var ee=0,J={};function ie(re){this.id=ee++,this.refCount=1,this.renderbuffer=re,this.format=Mn,this.width=0,this.height=0,H.profile&&(this.stats={size:0})}ie.prototype.decRef=function(){--this.refCount<=0&&se(this)};function se(re){var ae=re.renderbuffer;l(ae,"must not double destroy renderbuffer"),f.bindRenderbuffer(Qr,null),f.deleteRenderbuffer(ae),re.renderbuffer=null,re.refCount=0,delete J[re.id],N.renderbufferCount--}function fe(re,ae){var F=new ie(f.createRenderbuffer());J[F.id]=F,N.renderbufferCount++;function z(be,K){var me=0,de=0,Ce=Mn;if(typeof be=="object"&&be){var Y=be;if("shape"in Y){var q=Y.shape;l(Array.isArray(q)&&q.length>=2,"invalid renderbuffer shape"),me=q[0]|0,de=q[1]|0}else"radius"in Y&&(me=de=Y.radius|0),"width"in Y&&(me=Y.width|0),"height"in Y&&(de=Y.height|0);"format"in Y&&(l.parameter(Y.format,$,"invalid renderbuffer format"),Ce=$[Y.format])}else typeof be=="number"?(me=be|0,typeof K=="number"?de=K|0:de=me):be?l.raise("invalid arguments to renderbuffer constructor"):me=de=1;if(l(me>0&&de>0&&me<=E.maxRenderbufferSize&&de<=E.maxRenderbufferSize,"invalid renderbuffer size"),!(me===F.width&&de===F.height&&Ce===F.format))return z.width=F.width=me,z.height=F.height=de,F.format=Ce,f.bindRenderbuffer(Qr,F.renderbuffer),f.renderbufferStorage(Qr,Ce,me,de),l(f.getError()===0,"invalid render buffer format"),H.profile&&(F.stats.size=vf(F.format,F.width,F.height)),z.format=U[F.format],z}function ne(be,K){var me=be|0,de=K|0||me;return me===F.width&&de===F.height||(l(me>0&&de>0&&me<=E.maxRenderbufferSize&&de<=E.maxRenderbufferSize,"invalid renderbuffer size"),z.width=F.width=me,z.height=F.height=de,f.bindRenderbuffer(Qr,F.renderbuffer),f.renderbufferStorage(Qr,F.format,me,de),l(f.getError()===0,"invalid render buffer format"),H.profile&&(F.stats.size=vf(F.format,F.width,F.height))),z}return z(re,ae),z.resize=ne,z._reglType="renderbuffer",z._renderbuffer=F,H.profile&&(z.stats=F.stats),z.destroy=function(){F.decRef()},z}H.profile&&(N.getTotalRenderbufferSize=function(){var re=0;return Object.keys(J).forEach(function(ae){re+=J[ae].stats.size}),re});function le(){Cr(J).forEach(function(re){re.renderbuffer=f.createRenderbuffer(),f.bindRenderbuffer(Qr,re.renderbuffer),f.renderbufferStorage(Qr,re.format,re.width,re.height)}),f.bindRenderbuffer(Qr,null)}return{create:fe,clear:function(){Cr(J).forEach(se)},restore:le}},Xr=36160,Oa=36161,ct=3553,Sn=34069,df=36064,hf=36096,mf=36128,pf=33306,yf=36053,To=36054,go=36055,Ao=36057,Mo=36061,So=36193,wo=5121,Oo=5126,bf=6407,_f=6408,Ro=6402,Lo=[bf,_f],Ra=[];Ra[_f]=4,Ra[bf]=3;var wn=[];wn[wo]=1,wn[Oo]=4,wn[So]=2;var Co=32854,Fo=32855,Go=36194,Do=33189,Po=36168,xf=34041,Io=35907,$o=34836,No=34842,Bo=34843,ko=[Co,Fo,Go,Io,No,Bo,$o],Lt={};Lt[yf]="complete",Lt[To]="incomplete attachment",Lt[Ao]="incomplete dimensions",Lt[go]="incomplete, missing attachment",Lt[Mo]="unsupported";function zo(f,h,E,N,H,$){var U={cur:null,next:null,dirty:!1,setFBO:null},ee=["rgba"],J=["rgba4","rgb565","rgb5 a1"];h.ext_srgb&&J.push("srgba"),h.ext_color_buffer_half_float&&J.push("rgba16f","rgb16f"),h.webgl_color_buffer_float&&J.push("rgba32f");var ie=["uint8"];h.oes_texture_half_float&&ie.push("half float","float16"),h.oes_texture_float&&ie.push("float","float32");function se(te,ue,ve){this.target=te,this.texture=ue,this.renderbuffer=ve;var Ne=0,$e=0;ue?(Ne=ue.width,$e=ue.height):ve&&(Ne=ve.width,$e=ve.height),this.width=Ne,this.height=$e}function fe(te){te&&(te.texture&&te.texture._texture.decRef(),te.renderbuffer&&te.renderbuffer._renderbuffer.decRef())}function le(te,ue,ve){if(!!te)if(te.texture){var Ne=te.texture._texture,$e=Math.max(1,Ne.width),he=Math.max(1,Ne.height);l($e===ue&&he===ve,"inconsistent width/height for supplied texture"),Ne.refCount+=1}else{var ye=te.renderbuffer._renderbuffer;l(ye.width===ue&&ye.height===ve,"inconsistent width/height for renderbuffer"),ye.refCount+=1}}function re(te,ue){ue&&(ue.texture?f.framebufferTexture2D(Xr,te,ue.target,ue.texture._texture.texture,0):f.framebufferRenderbuffer(Xr,te,Oa,ue.renderbuffer._renderbuffer.renderbuffer))}function ae(te){var ue=ct,ve=null,Ne=null,$e=te;typeof te=="object"&&($e=te.data,"target"in te&&(ue=te.target|0)),l.type($e,"function","invalid attachment data");var he=$e._reglType;return he==="texture2d"?(ve=$e,l(ue===ct)):he==="textureCube"?(ve=$e,l(ue>=Sn&&ue<Sn+6,"invalid cube map target")):he==="renderbuffer"?(Ne=$e,ue=Oa):l.raise("invalid regl object for attachment"),new se(ue,ve,Ne)}function F(te,ue,ve,Ne,$e){if(ve){var he=N.create2D({width:te,height:ue,format:Ne,type:$e});return he._texture.refCount=0,new se(ct,he,null)}else{var ye=H.create({width:te,height:ue,format:Ne});return ye._renderbuffer.refCount=0,new se(Oa,null,ye)}}function z(te){return te&&(te.texture||te.renderbuffer)}function ne(te,ue,ve){te&&(te.texture?te.texture.resize(ue,ve):te.renderbuffer&&te.renderbuffer.resize(ue,ve),te.width=ue,te.height=ve)}var be=0,K={};function me(){this.id=be++,K[this.id]=this,this.framebuffer=f.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function de(te){te.colorAttachments.forEach(fe),fe(te.depthAttachment),fe(te.stencilAttachment),fe(te.depthStencilAttachment)}function Ce(te){var ue=te.framebuffer;l(ue,"must not double destroy framebuffer"),f.deleteFramebuffer(ue),te.framebuffer=null,$.framebufferCount--,delete K[te.id]}function Y(te){var ue;f.bindFramebuffer(Xr,te.framebuffer);var ve=te.colorAttachments;for(ue=0;ue<ve.length;++ue)re(df+ue,ve[ue]);for(ue=ve.length;ue<E.maxColorAttachments;++ue)f.framebufferTexture2D(Xr,df+ue,ct,null,0);f.framebufferTexture2D(Xr,pf,ct,null,0),f.framebufferTexture2D(Xr,hf,ct,null,0),f.framebufferTexture2D(Xr,mf,ct,null,0),re(hf,te.depthAttachment),re(mf,te.stencilAttachment),re(pf,te.depthStencilAttachment);var Ne=f.checkFramebufferStatus(Xr);!f.isContextLost()&&Ne!==yf&&l.raise("framebuffer configuration not supported, status = "+Lt[Ne]),f.bindFramebuffer(Xr,U.next?U.next.framebuffer:null),U.cur=U.next,f.getError()}function q(te,ue){var ve=new me;$.framebufferCount++;function Ne(he,ye){var De;l(U.next!==ve,"can not update framebuffer which is currently in use");var Be=0,Ve=0,ir=!0,sr=!0,Xe=null,dr=!0,nr="rgba",vr="uint8",hr=1,mr=null,yr=null,_r=null,cr=!1;if(typeof he=="number")Be=he|0,Ve=ye|0||Be;else if(!he)Be=Ve=1;else{l.type(he,"object","invalid arguments for framebuffer");var ke=he;if("shape"in ke){var xr=ke.shape;l(Array.isArray(xr)&&xr.length>=2,"invalid shape for framebuffer"),Be=xr[0],Ve=xr[1]}else"radius"in ke&&(Be=Ve=ke.radius),"width"in ke&&(Be=ke.width),"height"in ke&&(Ve=ke.height);("color"in ke||"colors"in ke)&&(Xe=ke.color||ke.colors,Array.isArray(Xe)&&l(Xe.length===1||h.webgl_draw_buffers,"multiple render targets not supported")),Xe||("colorCount"in ke&&(hr=ke.colorCount|0,l(hr>0,"invalid color buffer count")),"colorTexture"in ke&&(dr=!!ke.colorTexture,nr="rgba4"),"colorType"in ke&&(vr=ke.colorType,dr?(l(h.oes_texture_float||!(vr==="float"||vr==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),l(h.oes_texture_half_float||!(vr==="half float"||vr==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):vr==="half float"||vr==="float16"?(l(h.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),nr="rgba16f"):(vr==="float"||vr==="float32")&&(l(h.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),nr="rgba32f"),l.oneOf(vr,ie,"invalid color type")),"colorFormat"in ke&&(nr=ke.colorFormat,ee.indexOf(nr)>=0?dr=!0:J.indexOf(nr)>=0?dr=!1:l.optional(function(){dr?l.oneOf(ke.colorFormat,ee,"invalid color format for texture"):l.oneOf(ke.colorFormat,J,"invalid color format for renderbuffer")}))),("depthTexture"in ke||"depthStencilTexture"in ke)&&(cr=!!(ke.depthTexture||ke.depthStencilTexture),l(!cr||h.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in ke&&(typeof ke.depth=="boolean"?ir=ke.depth:(mr=ke.depth,sr=!1)),"stencil"in ke&&(typeof ke.stencil=="boolean"?sr=ke.stencil:(yr=ke.stencil,ir=!1)),"depthStencil"in ke&&(typeof ke.depthStencil=="boolean"?ir=sr=ke.depthStencil:(_r=ke.depthStencil,ir=!1,sr=!1))}var Ze=null,Fe=null,je=null,He=null;if(Array.isArray(Xe))Ze=Xe.map(ae);else if(Xe)Ze=[ae(Xe)];else for(Ze=new Array(hr),De=0;De<hr;++De)Ze[De]=F(Be,Ve,dr,nr,vr);l(h.webgl_draw_buffers||Ze.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),l(Ze.length<=E.maxColorAttachments,"too many color attachments, not supported"),Be=Be||Ze[0].width,Ve=Ve||Ze[0].height,mr?Fe=ae(mr):ir&&!sr&&(Fe=F(Be,Ve,cr,"depth","uint32")),yr?je=ae(yr):sr&&!ir&&(je=F(Be,Ve,!1,"stencil","uint8")),_r?He=ae(_r):!mr&&!yr&&sr&&ir&&(He=F(Be,Ve,cr,"depth stencil","depth stencil")),l(!!mr+!!yr+!!_r<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var lr=null;for(De=0;De<Ze.length;++De)if(le(Ze[De],Be,Ve),l(!Ze[De]||Ze[De].texture&&Lo.indexOf(Ze[De].texture._texture.format)>=0||Ze[De].renderbuffer&&ko.indexOf(Ze[De].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+De+" is invalid"),Ze[De]&&Ze[De].texture){var Vr=Ra[Ze[De].texture._texture.format]*wn[Ze[De].texture._texture.type];lr===null?lr=Vr:l(lr===Vr,"all color attachments much have the same number of bits per pixel.")}return le(Fe,Be,Ve),l(!Fe||Fe.texture&&Fe.texture._texture.format===Ro||Fe.renderbuffer&&Fe.renderbuffer._renderbuffer.format===Do,"invalid depth attachment for framebuffer object"),le(je,Be,Ve),l(!je||je.renderbuffer&&je.renderbuffer._renderbuffer.format===Po,"invalid stencil attachment for framebuffer object"),le(He,Be,Ve),l(!He||He.texture&&He.texture._texture.format===xf||He.renderbuffer&&He.renderbuffer._renderbuffer.format===xf,"invalid depth-stencil attachment for framebuffer object"),de(ve),ve.width=Be,ve.height=Ve,ve.colorAttachments=Ze,ve.depthAttachment=Fe,ve.stencilAttachment=je,ve.depthStencilAttachment=He,Ne.color=Ze.map(z),Ne.depth=z(Fe),Ne.stencil=z(je),Ne.depthStencil=z(He),Ne.width=ve.width,Ne.height=ve.height,Y(ve),Ne}function $e(he,ye){l(U.next!==ve,"can not resize a framebuffer which is currently in use");var De=Math.max(he|0,1),Be=Math.max(ye|0||De,1);if(De===ve.width&&Be===ve.height)return Ne;for(var Ve=ve.colorAttachments,ir=0;ir<Ve.length;++ir)ne(Ve[ir],De,Be);return ne(ve.depthAttachment,De,Be),ne(ve.stencilAttachment,De,Be),ne(ve.depthStencilAttachment,De,Be),ve.width=Ne.width=De,ve.height=Ne.height=Be,Y(ve),Ne}return Ne(te,ue),n(Ne,{resize:$e,_reglType:"framebuffer",_framebuffer:ve,destroy:function(){Ce(ve),de(ve)},use:function(he){U.setFBO({framebuffer:Ne},he)}})}function Te(te){var ue=Array(6);function ve($e){var he;l(ue.indexOf(U.next)<0,"can not update framebuffer which is currently in use");var ye={color:null},De=0,Be=null,Ve="rgba",ir="uint8",sr=1;if(typeof $e=="number")De=$e|0;else if(!$e)De=1;else{l.type($e,"object","invalid arguments for framebuffer");var Xe=$e;if("shape"in Xe){var dr=Xe.shape;l(Array.isArray(dr)&&dr.length>=2,"invalid shape for framebuffer"),l(dr[0]===dr[1],"cube framebuffer must be square"),De=dr[0]}else"radius"in Xe&&(De=Xe.radius|0),"width"in Xe?(De=Xe.width|0,"height"in Xe&&l(Xe.height===De,"must be square")):"height"in Xe&&(De=Xe.height|0);("color"in Xe||"colors"in Xe)&&(Be=Xe.color||Xe.colors,Array.isArray(Be)&&l(Be.length===1||h.webgl_draw_buffers,"multiple render targets not supported")),Be||("colorCount"in Xe&&(sr=Xe.colorCount|0,l(sr>0,"invalid color buffer count")),"colorType"in Xe&&(l.oneOf(Xe.colorType,ie,"invalid color type"),ir=Xe.colorType),"colorFormat"in Xe&&(Ve=Xe.colorFormat,l.oneOf(Xe.colorFormat,ee,"invalid color format for texture"))),"depth"in Xe&&(ye.depth=Xe.depth),"stencil"in Xe&&(ye.stencil=Xe.stencil),"depthStencil"in Xe&&(ye.depthStencil=Xe.depthStencil)}var nr;if(Be)if(Array.isArray(Be))for(nr=[],he=0;he<Be.length;++he)nr[he]=Be[he];else nr=[Be];else{nr=Array(sr);var vr={radius:De,format:Ve,type:ir};for(he=0;he<sr;++he)nr[he]=N.createCube(vr)}for(ye.color=Array(nr.length),he=0;he<nr.length;++he){var hr=nr[he];l(typeof hr=="function"&&hr._reglType==="textureCube","invalid cube map"),De=De||hr.width,l(hr.width===De&&hr.height===De,"invalid cube map shape"),ye.color[he]={target:Sn,data:nr[he]}}for(he=0;he<6;++he){for(var mr=0;mr<nr.length;++mr)ye.color[mr].target=Sn+he;he>0&&(ye.depth=ue[0].depth,ye.stencil=ue[0].stencil,ye.depthStencil=ue[0].depthStencil),ue[he]?ue[he](ye):ue[he]=q(ye)}return n(ve,{width:De,height:De,color:nr})}function Ne($e){var he,ye=$e|0;if(l(ye>0&&ye<=E.maxCubeMapSize,"invalid radius for cube fbo"),ye===ve.width)return ve;var De=ve.color;for(he=0;he<De.length;++he)De[he].resize(ye);for(he=0;he<6;++he)ue[he].resize(ye);return ve.width=ve.height=ye,ve}return ve(te),n(ve,{faces:ue,resize:Ne,_reglType:"framebufferCube",destroy:function(){ue.forEach(function($e){$e.destroy()})}})}function oe(){U.cur=null,U.next=null,U.dirty=!0,Cr(K).forEach(function(te){te.framebuffer=f.createFramebuffer(),Y(te)})}return n(U,{getFramebuffer:function(te){if(typeof te=="function"&&te._reglType==="framebuffer"){var ue=te._framebuffer;if(ue instanceof me)return ue}return null},create:q,createCube:Te,clear:function(){Cr(K).forEach(Ce)},restore:oe})}var Uo=5126,Ef=34962,On=34963,Tf=["attributes","elements","offset","count","primitive","instances"];function La(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Uo,this.offset=0,this.stride=0,this.divisor=0}function Vo(f,h,E,N,H,$,U){for(var ee=E.maxAttributes,J=new Array(ee),ie=0;ie<ee;++ie)J[ie]=new La;var se=0,fe={},le={Record:La,scope:{},state:J,currentVAO:null,targetVAO:null,restore:ae()?de:function(){},createVAO:Ce,getVAO:z,destroyBuffer:re,setVAO:ae()?ne:be,clear:ae()?K:function(){}};function re(Y){for(var q=0;q<J.length;++q){var Te=J[q];Te.buffer===Y&&(f.disableVertexAttribArray(q),Te.buffer=null)}}function ae(){return h.oes_vertex_array_object}function F(){return h.angle_instanced_arrays}function z(Y){return typeof Y=="function"&&Y._vao?Y._vao:null}function ne(Y){if(Y!==le.currentVAO){var q=ae();Y?q.bindVertexArrayOES(Y.vao):q.bindVertexArrayOES(null),le.currentVAO=Y}}function be(Y){if(Y!==le.currentVAO){if(Y)Y.bindAttrs();else{for(var q=F(),Te=0;Te<J.length;++Te){var oe=J[Te];oe.buffer?(f.enableVertexAttribArray(Te),oe.buffer.bind(),f.vertexAttribPointer(Te,oe.size,oe.type,oe.normalized,oe.stride,oe.offfset),q&&oe.divisor&&q.vertexAttribDivisorANGLE(Te,oe.divisor)):(f.disableVertexAttribArray(Te),f.vertexAttrib4f(Te,oe.x,oe.y,oe.z,oe.w))}U.elements?f.bindBuffer(On,U.elements.buffer.buffer):f.bindBuffer(On,null)}le.currentVAO=Y}}function K(){Cr(fe).forEach(function(Y){Y.destroy()})}function me(){this.id=++se,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var Y=ae();Y?this.vao=Y.createVertexArrayOES():this.vao=null,fe[this.id]=this,this.buffers=[]}me.prototype.bindAttrs=function(){for(var Y=F(),q=this.attributes,Te=0;Te<q.length;++Te){var oe=q[Te];oe.buffer?(f.enableVertexAttribArray(Te),f.bindBuffer(Ef,oe.buffer.buffer),f.vertexAttribPointer(Te,oe.size,oe.type,oe.normalized,oe.stride,oe.offset),Y&&oe.divisor&&Y.vertexAttribDivisorANGLE(Te,oe.divisor)):(f.disableVertexAttribArray(Te),f.vertexAttrib4f(Te,oe.x,oe.y,oe.z,oe.w))}for(var te=q.length;te<ee;++te)f.disableVertexAttribArray(te);var ue=$.getElements(this.elements);ue?f.bindBuffer(On,ue.buffer.buffer):f.bindBuffer(On,null)},me.prototype.refresh=function(){var Y=ae();Y&&(Y.bindVertexArrayOES(this.vao),this.bindAttrs(),le.currentVAO=null,Y.bindVertexArrayOES(null))},me.prototype.destroy=function(){if(this.vao){var Y=ae();this===le.currentVAO&&(le.currentVAO=null,Y.bindVertexArrayOES(null)),Y.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),fe[this.id]&&(delete fe[this.id],N.vaoCount-=1)};function de(){var Y=ae();Y&&Cr(fe).forEach(function(q){q.refresh()})}function Ce(Y){var q=new me;N.vaoCount+=1;function Te(oe){var te;if(Array.isArray(oe))te=oe,q.elements&&q.ownsElements&&q.elements.destroy(),q.elements=null,q.ownsElements=!1,q.offset=0,q.count=0,q.instances=-1,q.primitive=4;else{if(l(typeof oe=="object","invalid arguments for create vao"),l("attributes"in oe,"must specify attributes for vao"),oe.elements){var ue=oe.elements;q.ownsElements?typeof ue=="function"&&ue._reglType==="elements"?(q.elements.destroy(),q.ownsElements=!1):(q.elements(ue),q.ownsElements=!1):$.getElements(oe.elements)?(q.elements=oe.elements,q.ownsElements=!1):(q.elements=$.create(oe.elements),q.ownsElements=!0)}else q.elements=null,q.ownsElements=!1;te=oe.attributes,q.offset=0,q.count=-1,q.instances=-1,q.primitive=4,q.elements&&(q.count=q.elements._elements.vertCount,q.primitive=q.elements._elements.primType),"offset"in oe&&(q.offset=oe.offset|0),"count"in oe&&(q.count=oe.count|0),"instances"in oe&&(q.instances=oe.instances|0),"primitive"in oe&&(l(oe.primitive in Wr,"bad primitive type: "+oe.primitive),q.primitive=Wr[oe.primitive]),l.optional(()=>{for(var ir=Object.keys(oe),sr=0;sr<ir.length;++sr)l(Tf.indexOf(ir[sr])>=0,'invalid option for vao: "'+ir[sr]+'" valid options are '+Tf)}),l(Array.isArray(te),"attributes must be an array")}l(te.length<ee,"too many attributes"),l(te.length>0,"must specify at least one attribute");var ve={},Ne=q.attributes;Ne.length=te.length;for(var $e=0;$e<te.length;++$e){var he=te[$e],ye=Ne[$e]=new La,De=he.data||he;if(Array.isArray(De)||t(De)||$r(De)){var Be;q.buffers[$e]&&(Be=q.buffers[$e],t(De)&&Be._buffer.byteLength>=De.byteLength?Be.subdata(De):(Be.destroy(),q.buffers[$e]=null)),q.buffers[$e]||(Be=q.buffers[$e]=H.create(he,Ef,!1,!0)),ye.buffer=H.getBuffer(Be),ye.size=ye.buffer.dimension|0,ye.normalized=!1,ye.type=ye.buffer.dtype,ye.offset=0,ye.stride=0,ye.divisor=0,ye.state=1,ve[$e]=1}else H.getBuffer(he)?(ye.buffer=H.getBuffer(he),ye.size=ye.buffer.dimension|0,ye.normalized=!1,ye.type=ye.buffer.dtype,ye.offset=0,ye.stride=0,ye.divisor=0,ye.state=1):H.getBuffer(he.buffer)?(ye.buffer=H.getBuffer(he.buffer),ye.size=(+he.size||ye.buffer.dimension)|0,ye.normalized=!!he.normalized||!1,"type"in he?(l.parameter(he.type,at,"invalid buffer type"),ye.type=at[he.type]):ye.type=ye.buffer.dtype,ye.offset=(he.offset||0)|0,ye.stride=(he.stride||0)|0,ye.divisor=(he.divisor||0)|0,ye.state=1,l(ye.size>=1&&ye.size<=4,"size must be between 1 and 4"),l(ye.offset>=0,"invalid offset"),l(ye.stride>=0&&ye.stride<=255,"stride must be between 0 and 255"),l(ye.divisor>=0,"divisor must be positive"),l(!ye.divisor||!!h.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in he?(l($e>0,"first attribute must not be a constant"),ye.x=+he.x||0,ye.y=+he.y||0,ye.z=+he.z||0,ye.w=+he.w||0,ye.state=2):l(!1,"invalid attribute spec for location "+$e)}for(var Ve=0;Ve<q.buffers.length;++Ve)!ve[Ve]&&q.buffers[Ve]&&(q.buffers[Ve].destroy(),q.buffers[Ve]=null);return q.refresh(),Te}return Te.destroy=function(){for(var oe=0;oe<q.buffers.length;++oe)q.buffers[oe]&&q.buffers[oe].destroy();q.buffers.length=0,q.ownsElements&&(q.elements.destroy(),q.elements=null,q.ownsElements=!1),q.destroy()},Te._vao=q,Te._reglType="vao",Te(Y)}return le}var gf=35632,jo=35633,Xo=35718,qo=35721;function Ho(f,h,E,N){var H={},$={};function U(F,z,ne,be){this.name=F,this.id=z,this.location=ne,this.info=be}function ee(F,z){for(var ne=0;ne<F.length;++ne)if(F[ne].id===z.id){F[ne].location=z.location;return}F.push(z)}function J(F,z,ne){var be=F===gf?H:$,K=be[z];if(!K){var me=h.str(z);K=f.createShader(F),f.shaderSource(K,me),f.compileShader(K),l.shaderError(f,K,me,F,ne),be[z]=K}return K}var ie={},se=[],fe=0;function le(F,z){this.id=fe++,this.fragId=F,this.vertId=z,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,N.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function re(F,z,ne){var be,K,me=J(gf,F.fragId),de=J(jo,F.vertId),Ce=F.program=f.createProgram();if(f.attachShader(Ce,me),f.attachShader(Ce,de),ne)for(be=0;be<ne.length;++be){var Y=ne[be];f.bindAttribLocation(Ce,Y[0],Y[1])}f.linkProgram(Ce),l.linkError(f,Ce,h.str(F.fragId),h.str(F.vertId),z);var q=f.getProgramParameter(Ce,Xo);N.profile&&(F.stats.uniformsCount=q);var Te=F.uniforms;for(be=0;be<q;++be)if(K=f.getActiveUniform(Ce,be),K){if(K.size>1)for(var oe=0;oe<K.size;++oe){var te=K.name.replace("[0]","["+oe+"]");ee(Te,new U(te,h.id(te),f.getUniformLocation(Ce,te),K))}var ue=K.name;K.size>1&&(ue=ue.replace("[0]","")),ee(Te,new U(ue,h.id(ue),f.getUniformLocation(Ce,ue),K))}var ve=f.getProgramParameter(Ce,qo);N.profile&&(F.stats.attributesCount=ve);var Ne=F.attributes;for(be=0;be<ve;++be)K=f.getActiveAttrib(Ce,be),K&&ee(Ne,new U(K.name,h.id(K.name),f.getAttribLocation(Ce,K.name),K))}N.profile&&(E.getMaxUniformsCount=function(){var F=0;return se.forEach(function(z){z.stats.uniformsCount>F&&(F=z.stats.uniformsCount)}),F},E.getMaxAttributesCount=function(){var F=0;return se.forEach(function(z){z.stats.attributesCount>F&&(F=z.stats.attributesCount)}),F});function ae(){H={},$={};for(var F=0;F<se.length;++F)re(se[F],null,se[F].attributes.map(function(z){return[z.location,z.name]}))}return{clear:function(){var F=f.deleteShader.bind(f);Cr(H).forEach(F),H={},Cr($).forEach(F),$={},se.forEach(function(z){f.deleteProgram(z.program)}),se.length=0,ie={},E.shaderCount=0},program:function(F,z,ne,be){l.command(F>=0,"missing vertex shader",ne),l.command(z>=0,"missing fragment shader",ne);var K=ie[z];K||(K=ie[z]={});var me=K[F];if(me&&(me.refCount++,!be))return me;var de=new le(z,F);return E.shaderCount++,re(de,ne,be),me||(K[F]=de),se.push(de),n(de,{destroy:function(){if(de.refCount--,de.refCount<=0){f.deleteProgram(de.program);var Ce=se.indexOf(de);se.splice(Ce,1),E.shaderCount--}K[de.vertId].refCount<=0&&(f.deleteShader($[de.vertId]),delete $[de.vertId],delete ie[de.fragId][de.vertId]),Object.keys(ie[de.fragId]).length||(f.deleteShader(H[de.fragId]),delete H[de.fragId],delete ie[de.fragId])}})},restore:ae,shader:J,frag:-1,vert:-1}}var Yo=6408,qt=5121,Wo=3333,Rn=5126;function Qo(f,h,E,N,H,$,U){function ee(se){var fe;h.next===null?(l(H.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),fe=qt):(l(h.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),fe=h.next.colorAttachments[0].texture._texture.type,l.optional(function(){$.oes_texture_float?(l(fe===qt||fe===Rn,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),fe===Rn&&l(U.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):l(fe===qt,"Reading from a framebuffer is only allowed for the type 'uint8'")}));var le=0,re=0,ae=N.framebufferWidth,F=N.framebufferHeight,z=null;t(se)?z=se:se&&(l.type(se,"object","invalid arguments to regl.read()"),le=se.x|0,re=se.y|0,l(le>=0&&le<N.framebufferWidth,"invalid x offset for regl.read"),l(re>=0&&re<N.framebufferHeight,"invalid y offset for regl.read"),ae=(se.width||N.framebufferWidth-le)|0,F=(se.height||N.framebufferHeight-re)|0,z=se.data||null),z&&(fe===qt?l(z instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):fe===Rn&&l(z instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),l(ae>0&&ae+le<=N.framebufferWidth,"invalid width for read pixels"),l(F>0&&F+re<=N.framebufferHeight,"invalid height for read pixels"),E();var ne=ae*F*4;return z||(fe===qt?z=new Uint8Array(ne):fe===Rn&&(z=z||new Float32Array(ne))),l.isTypedArray(z,"data buffer for regl.read() must be a typedarray"),l(z.byteLength>=ne,"data buffer for regl.read() too small"),f.pixelStorei(Wo,4),f.readPixels(le,re,ae,F,Yo,fe,z),z}function J(se){var fe;return h.setFBO({framebuffer:se.framebuffer},function(){fe=ee(se)}),fe}function ie(se){return!se||!("framebuffer"in se)?ee(se):J(se)}return ie}function Ct(f){return Array.prototype.slice.call(f)}function Ft(f){return Ct(f).join("")}function Ko(){var f=0,h=[],E=[];function N(fe){for(var le=0;le<E.length;++le)if(E[le]===fe)return h[le];var re="g"+f++;return h.push(re),E.push(fe),re}function H(){var fe=[];function le(){fe.push.apply(fe,Ct(arguments))}var re=[];function ae(){var F="v"+f++;return re.push(F),arguments.length>0&&(fe.push(F,"="),fe.push.apply(fe,Ct(arguments)),fe.push(";")),F}return n(le,{def:ae,toString:function(){return Ft([re.length>0?"var "+re.join(",")+";":"",Ft(fe)])}})}function $(){var fe=H(),le=H(),re=fe.toString,ae=le.toString;function F(z,ne){le(z,ne,"=",fe.def(z,ne),";")}return n(function(){fe.apply(fe,Ct(arguments))},{def:fe.def,entry:fe,exit:le,save:F,set:function(z,ne,be){F(z,ne),fe(z,ne,"=",be,";")},toString:function(){return re()+ae()}})}function U(){var fe=Ft(arguments),le=$(),re=$(),ae=le.toString,F=re.toString;return n(le,{then:function(){return le.apply(le,Ct(arguments)),this},else:function(){return re.apply(re,Ct(arguments)),this},toString:function(){var z=F();return z&&(z="else{"+z+"}"),Ft(["if(",fe,"){",ae(),"}",z])}})}var ee=H(),J={};function ie(fe,le){var re=[];function ae(){var K="a"+re.length;return re.push(K),K}le=le||0;for(var F=0;F<le;++F)ae();var z=$(),ne=z.toString,be=J[fe]=n(z,{arg:ae,toString:function(){return Ft(["function(",re.join(),"){",ne(),"}"])}});return be}function se(){var fe=['"use strict";',ee,"return {"];Object.keys(J).forEach(function(ae){fe.push('"',ae,'":',J[ae].toString(),",")}),fe.push("}");var le=Ft(fe).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),re=Function.apply(null,h.concat(le));return re.apply(null,E)}return{global:ee,link:N,block:H,proc:ie,scope:$,cond:U,compile:se}}var Gt="xyzw".split(""),Af=5121,Dt=1,Ca=2,Fa=0,Ga=1,Da=2,Pa=3,Ln=4,Mf=5,Sf=6,wf="dither",Of="blend.enable",Rf="blend.color",Ia="blend.equation",$a="blend.func",Lf="depth.enable",Cf="depth.func",Ff="depth.range",Gf="depth.mask",Na="colorMask",Df="cull.enable",Pf="cull.face",Ba="frontFace",ka="lineWidth",If="polygonOffset.enable",za="polygonOffset.offset",$f="sample.alpha",Nf="sample.enable",Ua="sample.coverage",Bf="stencil.enable",kf="stencil.mask",Va="stencil.func",ja="stencil.opFront",Ht="stencil.opBack",zf="scissor.enable",Cn="scissor.box",qr="viewport",Yt="profile",lt="framebuffer",Wt="vert",Qt="frag",ot="elements",ut="primitive",vt="count",Fn="offset",Gn="instances",Kt="vao",Xa="Width",qa="Height",Pt=lt+Xa,It=lt+qa,Zo=qr+Xa,Jo=qr+qa,Uf="drawingBuffer",Vf=Uf+Xa,jf=Uf+qa,eu=[$a,Ia,Va,ja,Ht,Ua,qr,Cn,za],$t=34962,Ha=34963,ru=35632,tu=35633,Xf=3553,nu=34067,au=2884,iu=3042,fu=3024,su=2960,cu=2929,lu=3089,ou=32823,uu=32926,vu=32928,Ya=5126,Dn=35664,Pn=35665,In=35666,Wa=5124,$n=35667,Nn=35668,Bn=35669,Qa=35670,kn=35671,zn=35672,Un=35673,Zt=35674,Jt=35675,en=35676,rn=35678,tn=35680,Ka=4,nn=1028,dt=1029,qf=2304,Za=2305,du=32775,hu=32776,mu=519,Kr=7680,Hf=0,Yf=1,Wf=32774,pu=513,Qf=36160,yu=36064,Ur={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Kf=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Nt={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Zr={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Zf={frag:ru,vert:tu},Ja={cw:qf,ccw:Za};function Vn(f){return Array.isArray(f)||t(f)||$r(f)}function Jf(f){return f.sort(function(h,E){return h===qr?-1:E===qr?1:h<E?-1:1})}function pr(f,h,E,N){this.thisDep=f,this.contextDep=h,this.propDep=E,this.append=N}function Jr(f){return f&&!(f.thisDep||f.contextDep||f.propDep)}function ur(f){return new pr(!1,!1,!1,f)}function wr(f,h){var E=f.type;if(E===Fa){var N=f.data.length;return new pr(!0,N>=1,N>=2,h)}else if(E===Ln){var H=f.data;return new pr(H.thisDep,H.contextDep,H.propDep,h)}else{if(E===Mf)return new pr(!1,!1,!1,h);if(E===Sf){for(var $=!1,U=!1,ee=!1,J=0;J<f.data.length;++J){var ie=f.data[J];if(ie.type===Ga)ee=!0;else if(ie.type===Da)U=!0;else if(ie.type===Pa)$=!0;else if(ie.type===Fa){$=!0;var se=ie.data;se>=1&&(U=!0),se>=2&&(ee=!0)}else ie.type===Ln&&($=$||ie.data.thisDep,U=U||ie.data.contextDep,ee=ee||ie.data.propDep)}return new pr($,U,ee,h)}else return new pr(E===Pa,E===Da,E===Ga,h)}}var es=new pr(!1,!1,!1,function(){});function bu(f,h,E,N,H,$,U,ee,J,ie,se,fe,le,re,ae){var F=ie.Record,z={add:32774,subtract:32778,"reverse subtract":32779};E.ext_blend_minmax&&(z.min=du,z.max=hu);var ne=E.angle_instanced_arrays,be=E.webgl_draw_buffers,K=E.oes_vertex_array_object,me={dirty:!0,profile:ae.profile},de={},Ce=[],Y={},q={};function Te(m){return m.replace(".","_")}function oe(m,u,A){var C=Te(m);Ce.push(m),de[C]=me[C]=!!A,Y[C]=u}function te(m,u,A){var C=Te(m);Ce.push(m),Array.isArray(A)?(me[C]=A.slice(),de[C]=A.slice()):me[C]=de[C]=A,q[C]=u}oe(wf,fu),oe(Of,iu),te(Rf,"blendColor",[0,0,0,0]),te(Ia,"blendEquationSeparate",[Wf,Wf]),te($a,"blendFuncSeparate",[Yf,Hf,Yf,Hf]),oe(Lf,cu,!0),te(Cf,"depthFunc",pu),te(Ff,"depthRange",[0,1]),te(Gf,"depthMask",!0),te(Na,Na,[!0,!0,!0,!0]),oe(Df,au),te(Pf,"cullFace",dt),te(Ba,Ba,Za),te(ka,ka,1),oe(If,ou),te(za,"polygonOffset",[0,0]),oe($f,uu),oe(Nf,vu),te(Ua,"sampleCoverage",[1,!1]),oe(Bf,su),te(kf,"stencilMask",-1),te(Va,"stencilFunc",[mu,0,-1]),te(ja,"stencilOpSeparate",[nn,Kr,Kr,Kr]),te(Ht,"stencilOpSeparate",[dt,Kr,Kr,Kr]),oe(zf,lu),te(Cn,"scissor",[0,0,f.drawingBufferWidth,f.drawingBufferHeight]),te(qr,qr,[0,0,f.drawingBufferWidth,f.drawingBufferHeight]);var ue={gl:f,context:le,strings:h,next:de,current:me,draw:fe,elements:$,buffer:H,shader:se,attributes:ie.state,vao:ie,uniforms:J,framebuffer:ee,extensions:E,timer:re,isBufferArgs:Vn},ve={primTypes:Wr,compareFuncs:Nt,blendFuncs:Ur,blendEquations:z,stencilOps:Zr,glTypes:at,orientationType:Ja};l.optional(function(){ue.isArrayLike=ar}),be&&(ve.backBuffer=[dt],ve.drawBuffer=Lr(N.maxDrawbuffers,function(m){return m===0?[0]:Lr(m,function(u){return yu+u})}));var Ne=0;function $e(){var m=Ko(),u=m.link,A=m.global;m.id=Ne++,m.batchId="0";var C=u(ue),G=m.shared={props:"a0"};Object.keys(ue).forEach(function(x){G[x]=A.def(C,".",x)}),l.optional(function(){m.CHECK=u(l),m.commandStr=l.guessCommand(),m.command=u(m.commandStr),m.assert=function(x,y,P){x("if(!(",y,"))",this.CHECK,".commandRaise(",u(P),",",this.command,");")},ve.invalidBlendCombinations=Kf});var S=m.next={},M=m.current={};Object.keys(q).forEach(function(x){Array.isArray(me[x])&&(S[x]=A.def(G.next,".",x),M[x]=A.def(G.current,".",x))});var R=m.constants={};Object.keys(ve).forEach(function(x){R[x]=A.def(JSON.stringify(ve[x]))}),m.invoke=function(x,y){switch(y.type){case Fa:var P=["this",G.context,G.props,m.batchId];return x.def(u(y.data),".call(",P.slice(0,Math.max(y.data.length+1,4)),")");case Ga:return x.def(G.props,y.data);case Da:return x.def(G.context,y.data);case Pa:return x.def("this",y.data);case Ln:return y.data.append(m,x),y.data.ref;case Mf:return y.data.toString();case Sf:return y.data.map(function(D){return m.invoke(x,D)})}},m.attribCache={};var p={};return m.scopeAttrib=function(x){var y=h.id(x);if(y in p)return p[y];var P=ie.scope[y];P||(P=ie.scope[y]=new F);var D=p[y]=u(P);return D},m}function he(m){var u=m.static,A=m.dynamic,C;if(Yt in u){var G=!!u[Yt];C=ur(function(M,R){return G}),C.enable=G}else if(Yt in A){var S=A[Yt];C=wr(S,function(M,R){return M.invoke(R,S)})}return C}function ye(m,u){var A=m.static,C=m.dynamic;if(lt in A){var G=A[lt];return G?(G=ee.getFramebuffer(G),l.command(G,"invalid framebuffer object"),ur(function(M,R){var p=M.link(G),x=M.shared;R.set(x.framebuffer,".next",p);var y=x.context;return R.set(y,"."+Pt,p+".width"),R.set(y,"."+It,p+".height"),p})):ur(function(M,R){var p=M.shared;R.set(p.framebuffer,".next","null");var x=p.context;return R.set(x,"."+Pt,x+"."+Vf),R.set(x,"."+It,x+"."+jf),"null"})}else if(lt in C){var S=C[lt];return wr(S,function(M,R){var p=M.invoke(R,S),x=M.shared,y=x.framebuffer,P=R.def(y,".getFramebuffer(",p,")");l.optional(function(){M.assert(R,"!"+p+"||"+P,"invalid framebuffer object")}),R.set(y,".next",P);var D=x.context;return R.set(D,"."+Pt,P+"?"+P+".width:"+D+"."+Vf),R.set(D,"."+It,P+"?"+P+".height:"+D+"."+jf),P})}else return null}function De(m,u,A){var C=m.static,G=m.dynamic;function S(p){if(p in C){var x=C[p];l.commandType(x,"object","invalid "+p,A.commandStr);var y=!0,P=x.x|0,D=x.y|0,X,W;return"width"in x?(X=x.width|0,l.command(X>=0,"invalid "+p,A.commandStr)):y=!1,"height"in x?(W=x.height|0,l.command(W>=0,"invalid "+p,A.commandStr)):y=!1,new pr(!y&&u&&u.thisDep,!y&&u&&u.contextDep,!y&&u&&u.propDep,function(Le,_e){var Q=Le.shared.context,j=X;"width"in x||(j=_e.def(Q,".",Pt,"-",P));var we=W;return"height"in x||(we=_e.def(Q,".",It,"-",D)),[P,D,j,we]})}else if(p in G){var ce=G[p],Ie=wr(ce,function(Le,_e){var Q=Le.invoke(_e,ce);l.optional(function(){Le.assert(_e,Q+"&&typeof "+Q+'==="object"',"invalid "+p)});var j=Le.shared.context,we=_e.def(Q,".x|0"),ge=_e.def(Q,".y|0"),Pe=_e.def('"width" in ',Q,"?",Q,".width|0:","(",j,".",Pt,"-",we,")"),er=_e.def('"height" in ',Q,"?",Q,".height|0:","(",j,".",It,"-",ge,")");return l.optional(function(){Le.assert(_e,Pe+">=0&&"+er+">=0","invalid "+p)}),[we,ge,Pe,er]});return u&&(Ie.thisDep=Ie.thisDep||u.thisDep,Ie.contextDep=Ie.contextDep||u.contextDep,Ie.propDep=Ie.propDep||u.propDep),Ie}else return u?new pr(u.thisDep,u.contextDep,u.propDep,function(Le,_e){var Q=Le.shared.context;return[0,0,_e.def(Q,".",Pt),_e.def(Q,".",It)]}):null}var M=S(qr);if(M){var R=M;M=new pr(M.thisDep,M.contextDep,M.propDep,function(p,x){var y=R.append(p,x),P=p.shared.context;return x.set(P,"."+Zo,y[2]),x.set(P,"."+Jo,y[3]),y})}return{viewport:M,scissor_box:S(Cn)}}function Be(m,u){var A=m.static,C=typeof A[Qt]=="string"&&typeof A[Wt]=="string";if(C){if(Object.keys(u.dynamic).length>0)return null;var G=u.static,S=Object.keys(G);if(S.length>0&&typeof G[S[0]]=="number"){for(var M=[],R=0;R<S.length;++R)l(typeof G[S[R]]=="number","must specify all vertex attribute locations when using vaos"),M.push([G[S[R]]|0,S[R]]);return M}}return null}function Ve(m,u,A){var C=m.static,G=m.dynamic;function S(y){if(y in C){var P=h.id(C[y]);l.optional(function(){se.shader(Zf[y],P,l.guessCommand())});var D=ur(function(){return P});return D.id=P,D}else if(y in G){var X=G[y];return wr(X,function(W,ce){var Ie=W.invoke(ce,X),Le=ce.def(W.shared.strings,".id(",Ie,")");return l.optional(function(){ce(W.shared.shader,".shader(",Zf[y],",",Le,",",W.command,");")}),Le})}return null}var M=S(Qt),R=S(Wt),p=null,x;return Jr(M)&&Jr(R)?(p=se.program(R.id,M.id,null,A),x=ur(function(y,P){return y.link(p)})):x=new pr(M&&M.thisDep||R&&R.thisDep,M&&M.contextDep||R&&R.contextDep,M&&M.propDep||R&&R.propDep,function(y,P){var D=y.shared.shader,X;M?X=M.append(y,P):X=P.def(D,".",Qt);var W;R?W=R.append(y,P):W=P.def(D,".",Wt);var ce=D+".program("+W+","+X;return l.optional(function(){ce+=","+y.command}),P.def(ce+")")}),{frag:M,vert:R,progVar:x,program:p}}function ir(m,u){var A=m.static,C=m.dynamic,G={},S=!1;function M(){if(Kt in A){var _e=A[Kt];return _e!==null&&ie.getVAO(_e)===null&&(_e=ie.createVAO(_e)),S=!0,G.vao=_e,ur(function(j){var we=ie.getVAO(_e);return we?j.link(we):"null"})}else if(Kt in C){S=!0;var Q=C[Kt];return wr(Q,function(j,we){var ge=j.invoke(we,Q);return we.def(j.shared.vao+".getVAO("+ge+")")})}return null}var R=M(),p=!1;function x(){if(ot in A){var _e=A[ot];if(G.elements=_e,Vn(_e)){var Q=G.elements=$.create(_e,!0);_e=$.getElements(Q),p=!0}else _e&&(_e=$.getElements(_e),p=!0,l.command(_e,"invalid elements",u.commandStr));var j=ur(function(ge,Pe){if(_e){var er=ge.link(_e);return ge.ELEMENTS=er,er}return ge.ELEMENTS=null,null});return j.value=_e,j}else if(ot in C){p=!0;var we=C[ot];return wr(we,function(ge,Pe){var er=ge.shared,Er=er.isBufferArgs,mt=er.elements,Hr=ge.invoke(Pe,we),jr=Pe.def("null"),et=Pe.def(Er,"(",Hr,")"),pt=ge.cond(et).then(jr,"=",mt,".createStream(",Hr,");").else(jr,"=",mt,".getElements(",Hr,");");return l.optional(function(){ge.assert(pt.else,"!"+Hr+"||"+jr,"invalid elements")}),Pe.entry(pt),Pe.exit(ge.cond(et).then(mt,".destroyStream(",jr,");")),ge.ELEMENTS=jr,jr})}else if(S)return new pr(R.thisDep,R.contextDep,R.propDep,function(ge,Pe){return Pe.def(ge.shared.vao+".currentVAO?"+ge.shared.elements+".getElements("+ge.shared.vao+".currentVAO.elements):null")});return null}var y=x();function P(){if(ut in A){var _e=A[ut];return G.primitive=_e,l.commandParameter(_e,Wr,"invalid primitve",u.commandStr),ur(function(j,we){return Wr[_e]})}else if(ut in C){var Q=C[ut];return wr(Q,function(j,we){var ge=j.constants.primTypes,Pe=j.invoke(we,Q);return l.optional(function(){j.assert(we,Pe+" in "+ge,"invalid primitive, must be one of "+Object.keys(Wr))}),we.def(ge,"[",Pe,"]")})}else{if(p)return Jr(y)?y.value?ur(function(j,we){return we.def(j.ELEMENTS,".primType")}):ur(function(){return Ka}):new pr(y.thisDep,y.contextDep,y.propDep,function(j,we){var ge=j.ELEMENTS;return we.def(ge,"?",ge,".primType:",Ka)});if(S)return new pr(R.thisDep,R.contextDep,R.propDep,function(j,we){return we.def(j.shared.vao+".currentVAO?"+j.shared.vao+".currentVAO.primitive:"+Ka)})}return null}function D(_e,Q){if(_e in A){var j=A[_e]|0;return Q?G.offset=j:G.instances=j,l.command(!Q||j>=0,"invalid "+_e,u.commandStr),ur(function(ge,Pe){return Q&&(ge.OFFSET=j),j})}else if(_e in C){var we=C[_e];return wr(we,function(ge,Pe){var er=ge.invoke(Pe,we);return Q&&(ge.OFFSET=er,l.optional(function(){ge.assert(Pe,er+">=0","invalid "+_e)})),er})}else if(Q){if(p)return ur(function(ge,Pe){return ge.OFFSET=0,0});if(S)return new pr(R.thisDep,R.contextDep,R.propDep,function(ge,Pe){return Pe.def(ge.shared.vao+".currentVAO?"+ge.shared.vao+".currentVAO.offset:0")})}else if(S)return new pr(R.thisDep,R.contextDep,R.propDep,function(ge,Pe){return Pe.def(ge.shared.vao+".currentVAO?"+ge.shared.vao+".currentVAO.instances:-1")});return null}var X=D(Fn,!0);function W(){if(vt in A){var _e=A[vt]|0;return G.count=_e,l.command(typeof _e=="number"&&_e>=0,"invalid vertex count",u.commandStr),ur(function(){return _e})}else if(vt in C){var Q=C[vt];return wr(Q,function(Pe,er){var Er=Pe.invoke(er,Q);return l.optional(function(){Pe.assert(er,"typeof "+Er+'==="number"&&'+Er+">=0&&"+Er+"===("+Er+"|0)","invalid vertex count")}),Er})}else if(p)if(Jr(y)){if(y)return X?new pr(X.thisDep,X.contextDep,X.propDep,function(Pe,er){var Er=er.def(Pe.ELEMENTS,".vertCount-",Pe.OFFSET);return l.optional(function(){Pe.assert(er,Er+">=0","invalid vertex offset/element buffer too small")}),Er}):ur(function(Pe,er){return er.def(Pe.ELEMENTS,".vertCount")});var j=ur(function(){return-1});return l.optional(function(){j.MISSING=!0}),j}else{var we=new pr(y.thisDep||X.thisDep,y.contextDep||X.contextDep,y.propDep||X.propDep,function(Pe,er){var Er=Pe.ELEMENTS;return Pe.OFFSET?er.def(Er,"?",Er,".vertCount-",Pe.OFFSET,":-1"):er.def(Er,"?",Er,".vertCount:-1")});return l.optional(function(){we.DYNAMIC=!0}),we}else if(S){var ge=new pr(R.thisDep,R.contextDep,R.propDep,function(Pe,er){return er.def(Pe.shared.vao,".currentVAO?",Pe.shared.vao,".currentVAO.count:-1")});return ge}return null}var ce=P(),Ie=W(),Le=D(Gn,!1);return{elements:y,primitive:ce,count:Ie,instances:Le,offset:X,vao:R,vaoActive:S,elementsActive:p,static:G}}function sr(m,u){var A=m.static,C=m.dynamic,G={};return Ce.forEach(function(S){var M=Te(S);function R(p,x){if(S in A){var y=p(A[S]);G[M]=ur(function(){return y})}else if(S in C){var P=C[S];G[M]=wr(P,function(D,X){return x(D,X,D.invoke(X,P))})}}switch(S){case Df:case Of:case wf:case Bf:case Lf:case zf:case If:case $f:case Nf:case Gf:return R(function(p){return l.commandType(p,"boolean",S,u.commandStr),p},function(p,x,y){return l.optional(function(){p.assert(x,"typeof "+y+'==="boolean"',"invalid flag "+S,p.commandStr)}),y});case Cf:return R(function(p){return l.commandParameter(p,Nt,"invalid "+S,u.commandStr),Nt[p]},function(p,x,y){var P=p.constants.compareFuncs;return l.optional(function(){p.assert(x,y+" in "+P,"invalid "+S+", must be one of "+Object.keys(Nt))}),x.def(P,"[",y,"]")});case Ff:return R(function(p){return l.command(ar(p)&&p.length===2&&typeof p[0]=="number"&&typeof p[1]=="number"&&p[0]<=p[1],"depth range is 2d array",u.commandStr),p},function(p,x,y){l.optional(function(){p.assert(x,p.shared.isArrayLike+"("+y+")&&"+y+".length===2&&typeof "+y+'[0]==="number"&&typeof '+y+'[1]==="number"&&'+y+"[0]<="+y+"[1]","depth range must be a 2d array")});var P=x.def("+",y,"[0]"),D=x.def("+",y,"[1]");return[P,D]});case $a:return R(function(p){l.commandType(p,"object","blend.func",u.commandStr);var x="srcRGB"in p?p.srcRGB:p.src,y="srcAlpha"in p?p.srcAlpha:p.src,P="dstRGB"in p?p.dstRGB:p.dst,D="dstAlpha"in p?p.dstAlpha:p.dst;return l.commandParameter(x,Ur,M+".srcRGB",u.commandStr),l.commandParameter(y,Ur,M+".srcAlpha",u.commandStr),l.commandParameter(P,Ur,M+".dstRGB",u.commandStr),l.commandParameter(D,Ur,M+".dstAlpha",u.commandStr),l.command(Kf.indexOf(x+", "+P)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+x+", "+P+")",u.commandStr),[Ur[x],Ur[P],Ur[y],Ur[D]]},function(p,x,y){var P=p.constants.blendFuncs;l.optional(function(){p.assert(x,y+"&&typeof "+y+'==="object"',"invalid blend func, must be an object")});function D(Q,j){var we=x.def('"',Q,j,'" in ',y,"?",y,".",Q,j,":",y,".",Q);return l.optional(function(){p.assert(x,we+" in "+P,"invalid "+S+"."+Q+j+", must be one of "+Object.keys(Ur))}),we}var X=D("src","RGB"),W=D("dst","RGB");l.optional(function(){var Q=p.constants.invalidBlendCombinations;p.assert(x,Q+".indexOf("+X+'+", "+'+W+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var ce=x.def(P,"[",X,"]"),Ie=x.def(P,"[",D("src","Alpha"),"]"),Le=x.def(P,"[",W,"]"),_e=x.def(P,"[",D("dst","Alpha"),"]");return[ce,Le,Ie,_e]});case Ia:return R(function(p){if(typeof p=="string")return l.commandParameter(p,z,"invalid "+S,u.commandStr),[z[p],z[p]];if(typeof p=="object")return l.commandParameter(p.rgb,z,S+".rgb",u.commandStr),l.commandParameter(p.alpha,z,S+".alpha",u.commandStr),[z[p.rgb],z[p.alpha]];l.commandRaise("invalid blend.equation",u.commandStr)},function(p,x,y){var P=p.constants.blendEquations,D=x.def(),X=x.def(),W=p.cond("typeof ",y,'==="string"');return l.optional(function(){function ce(Ie,Le,_e){p.assert(Ie,_e+" in "+P,"invalid "+Le+", must be one of "+Object.keys(z))}ce(W.then,S,y),p.assert(W.else,y+"&&typeof "+y+'==="object"',"invalid "+S),ce(W.else,S+".rgb",y+".rgb"),ce(W.else,S+".alpha",y+".alpha")}),W.then(D,"=",X,"=",P,"[",y,"];"),W.else(D,"=",P,"[",y,".rgb];",X,"=",P,"[",y,".alpha];"),x(W),[D,X]});case Rf:return R(function(p){return l.command(ar(p)&&p.length===4,"blend.color must be a 4d array",u.commandStr),Lr(4,function(x){return+p[x]})},function(p,x,y){return l.optional(function(){p.assert(x,p.shared.isArrayLike+"("+y+")&&"+y+".length===4","blend.color must be a 4d array")}),Lr(4,function(P){return x.def("+",y,"[",P,"]")})});case kf:return R(function(p){return l.commandType(p,"number",M,u.commandStr),p|0},function(p,x,y){return l.optional(function(){p.assert(x,"typeof "+y+'==="number"',"invalid stencil.mask")}),x.def(y,"|0")});case Va:return R(function(p){l.commandType(p,"object",M,u.commandStr);var x=p.cmp||"keep",y=p.ref||0,P="mask"in p?p.mask:-1;return l.commandParameter(x,Nt,S+".cmp",u.commandStr),l.commandType(y,"number",S+".ref",u.commandStr),l.commandType(P,"number",S+".mask",u.commandStr),[Nt[x],y,P]},function(p,x,y){var P=p.constants.compareFuncs;l.optional(function(){function ce(){p.assert(x,Array.prototype.join.call(arguments,""),"invalid stencil.func")}ce(y+"&&typeof ",y,'==="object"'),ce('!("cmp" in ',y,")||(",y,".cmp in ",P,")")});var D=x.def('"cmp" in ',y,"?",P,"[",y,".cmp]",":",Kr),X=x.def(y,".ref|0"),W=x.def('"mask" in ',y,"?",y,".mask|0:-1");return[D,X,W]});case ja:case Ht:return R(function(p){l.commandType(p,"object",M,u.commandStr);var x=p.fail||"keep",y=p.zfail||"keep",P=p.zpass||"keep";return l.commandParameter(x,Zr,S+".fail",u.commandStr),l.commandParameter(y,Zr,S+".zfail",u.commandStr),l.commandParameter(P,Zr,S+".zpass",u.commandStr),[S===Ht?dt:nn,Zr[x],Zr[y],Zr[P]]},function(p,x,y){var P=p.constants.stencilOps;l.optional(function(){p.assert(x,y+"&&typeof "+y+'==="object"',"invalid "+S)});function D(X){return l.optional(function(){p.assert(x,'!("'+X+'" in '+y+")||("+y+"."+X+" in "+P+")","invalid "+S+"."+X+", must be one of "+Object.keys(Zr))}),x.def('"',X,'" in ',y,"?",P,"[",y,".",X,"]:",Kr)}return[S===Ht?dt:nn,D("fail"),D("zfail"),D("zpass")]});case za:return R(function(p){l.commandType(p,"object",M,u.commandStr);var x=p.factor|0,y=p.units|0;return l.commandType(x,"number",M+".factor",u.commandStr),l.commandType(y,"number",M+".units",u.commandStr),[x,y]},function(p,x,y){l.optional(function(){p.assert(x,y+"&&typeof "+y+'==="object"',"invalid "+S)});var P=x.def(y,".factor|0"),D=x.def(y,".units|0");return[P,D]});case Pf:return R(function(p){var x=0;return p==="front"?x=nn:p==="back"&&(x=dt),l.command(!!x,M,u.commandStr),x},function(p,x,y){return l.optional(function(){p.assert(x,y+'==="front"||'+y+'==="back"',"invalid cull.face")}),x.def(y,'==="front"?',nn,":",dt)});case ka:return R(function(p){return l.command(typeof p=="number"&&p>=N.lineWidthDims[0]&&p<=N.lineWidthDims[1],"invalid line width, must be a positive number between "+N.lineWidthDims[0]+" and "+N.lineWidthDims[1],u.commandStr),p},function(p,x,y){return l.optional(function(){p.assert(x,"typeof "+y+'==="number"&&'+y+">="+N.lineWidthDims[0]+"&&"+y+"<="+N.lineWidthDims[1],"invalid line width")}),y});case Ba:return R(function(p){return l.commandParameter(p,Ja,M,u.commandStr),Ja[p]},function(p,x,y){return l.optional(function(){p.assert(x,y+'==="cw"||'+y+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),x.def(y+'==="cw"?'+qf+":"+Za)});case Na:return R(function(p){return l.command(ar(p)&&p.length===4,"color.mask must be length 4 array",u.commandStr),p.map(function(x){return!!x})},function(p,x,y){return l.optional(function(){p.assert(x,p.shared.isArrayLike+"("+y+")&&"+y+".length===4","invalid color.mask")}),Lr(4,function(P){return"!!"+y+"["+P+"]"})});case Ua:return R(function(p){l.command(typeof p=="object"&&p,M,u.commandStr);var x="value"in p?p.value:1,y=!!p.invert;return l.command(typeof x=="number"&&x>=0&&x<=1,"sample.coverage.value must be a number between 0 and 1",u.commandStr),[x,y]},function(p,x,y){l.optional(function(){p.assert(x,y+"&&typeof "+y+'==="object"',"invalid sample.coverage")});var P=x.def('"value" in ',y,"?+",y,".value:1"),D=x.def("!!",y,".invert");return[P,D]})}}),G}function Xe(m,u){var A=m.static,C=m.dynamic,G={};return Object.keys(A).forEach(function(S){var M=A[S],R;if(typeof M=="number"||typeof M=="boolean")R=ur(function(){return M});else if(typeof M=="function"){var p=M._reglType;p==="texture2d"||p==="textureCube"?R=ur(function(x){return x.link(M)}):p==="framebuffer"||p==="framebufferCube"?(l.command(M.color.length>0,'missing color attachment for framebuffer sent to uniform "'+S+'"',u.commandStr),R=ur(function(x){return x.link(M.color[0])})):l.commandRaise('invalid data for uniform "'+S+'"',u.commandStr)}else ar(M)?R=ur(function(x){var y=x.global.def("[",Lr(M.length,function(P){return l.command(typeof M[P]=="number"||typeof M[P]=="boolean","invalid uniform "+S,x.commandStr),M[P]}),"]");return y}):l.commandRaise('invalid or missing data for uniform "'+S+'"',u.commandStr);R.value=M,G[S]=R}),Object.keys(C).forEach(function(S){var M=C[S];G[S]=wr(M,function(R,p){return R.invoke(p,M)})}),G}function dr(m,u){var A=m.static,C=m.dynamic,G={};return Object.keys(A).forEach(function(S){var M=A[S],R=h.id(S),p=new F;if(Vn(M))p.state=Dt,p.buffer=H.getBuffer(H.create(M,$t,!1,!0)),p.type=0;else{var x=H.getBuffer(M);if(x)p.state=Dt,p.buffer=x,p.type=0;else if(l.command(typeof M=="object"&&M,"invalid data for attribute "+S,u.commandStr),"constant"in M){var y=M.constant;p.buffer="null",p.state=Ca,typeof y=="number"?p.x=y:(l.command(ar(y)&&y.length>0&&y.length<=4,"invalid constant for attribute "+S,u.commandStr),Gt.forEach(function(Le,_e){_e<y.length&&(p[Le]=y[_e])}))}else{Vn(M.buffer)?x=H.getBuffer(H.create(M.buffer,$t,!1,!0)):x=H.getBuffer(M.buffer),l.command(!!x,'missing buffer for attribute "'+S+'"',u.commandStr);var P=M.offset|0;l.command(P>=0,'invalid offset for attribute "'+S+'"',u.commandStr);var D=M.stride|0;l.command(D>=0&&D<256,'invalid stride for attribute "'+S+'", must be integer betweeen [0, 255]',u.commandStr);var X=M.size|0;l.command(!("size"in M)||X>0&&X<=4,'invalid size for attribute "'+S+'", must be 1,2,3,4',u.commandStr);var W=!!M.normalized,ce=0;"type"in M&&(l.commandParameter(M.type,at,"invalid type for attribute "+S,u.commandStr),ce=at[M.type]);var Ie=M.divisor|0;l.optional(function(){"divisor"in M&&(l.command(Ie===0||ne,'cannot specify divisor for attribute "'+S+'", instancing not supported',u.commandStr),l.command(Ie>=0,'invalid divisor for attribute "'+S+'"',u.commandStr));var Le=u.commandStr,_e=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(M).forEach(function(Q){l.command(_e.indexOf(Q)>=0,'unknown parameter "'+Q+'" for attribute pointer "'+S+'" (valid parameters are '+_e+")",Le)})}),p.buffer=x,p.state=Dt,p.size=X,p.normalized=W,p.type=ce||x.dtype,p.offset=P,p.stride=D,p.divisor=Ie}}G[S]=ur(function(Le,_e){var Q=Le.attribCache;if(R in Q)return Q[R];var j={isStream:!1};return Object.keys(p).forEach(function(we){j[we]=p[we]}),p.buffer&&(j.buffer=Le.link(p.buffer),j.type=j.type||j.buffer+".dtype"),Q[R]=j,j})}),Object.keys(C).forEach(function(S){var M=C[S];function R(p,x){var y=p.invoke(x,M),P=p.shared,D=p.constants,X=P.isBufferArgs,W=P.buffer;l.optional(function(){p.assert(x,y+"&&(typeof "+y+'==="object"||typeof '+y+'==="function")&&('+X+"("+y+")||"+W+".getBuffer("+y+")||"+W+".getBuffer("+y+".buffer)||"+X+"("+y+'.buffer)||("constant" in '+y+"&&(typeof "+y+'.constant==="number"||'+P.isArrayLike+"("+y+".constant))))",'invalid dynamic attribute "'+S+'"')});var ce={isStream:x.def(!1)},Ie=new F;Ie.state=Dt,Object.keys(Ie).forEach(function(j){ce[j]=x.def(""+Ie[j])});var Le=ce.buffer,_e=ce.type;x("if(",X,"(",y,")){",ce.isStream,"=true;",Le,"=",W,".createStream(",$t,",",y,");",_e,"=",Le,".dtype;","}else{",Le,"=",W,".getBuffer(",y,");","if(",Le,"){",_e,"=",Le,".dtype;",'}else if("constant" in ',y,"){",ce.state,"=",Ca,";","if(typeof "+y+'.constant === "number"){',ce[Gt[0]],"=",y,".constant;",Gt.slice(1).map(function(j){return ce[j]}).join("="),"=0;","}else{",Gt.map(function(j,we){return ce[j]+"="+y+".constant.length>"+we+"?"+y+".constant["+we+"]:0;"}).join(""),"}}else{","if(",X,"(",y,".buffer)){",Le,"=",W,".createStream(",$t,",",y,".buffer);","}else{",Le,"=",W,".getBuffer(",y,".buffer);","}",_e,'="type" in ',y,"?",D.glTypes,"[",y,".type]:",Le,".dtype;",ce.normalized,"=!!",y,".normalized;");function Q(j){x(ce[j],"=",y,".",j,"|0;")}return Q("size"),Q("offset"),Q("stride"),Q("divisor"),x("}}"),x.exit("if(",ce.isStream,"){",W,".destroyStream(",Le,");","}"),ce}G[S]=wr(M,R)}),G}function nr(m){var u=m.static,A=m.dynamic,C={};return Object.keys(u).forEach(function(G){var S=u[G];C[G]=ur(function(M,R){return typeof S=="number"||typeof S=="boolean"?""+S:M.link(S)})}),Object.keys(A).forEach(function(G){var S=A[G];C[G]=wr(S,function(M,R){return M.invoke(R,S)})}),C}function vr(m,u,A,C,G){var S=m.static,M=m.dynamic;l.optional(function(){var Q=[lt,Wt,Qt,ot,ut,Fn,vt,Gn,Yt,Kt].concat(Ce);function j(we){Object.keys(we).forEach(function(ge){l.command(Q.indexOf(ge)>=0,'unknown parameter "'+ge+'"',G.commandStr)})}j(S),j(M)});var R=Be(m,u),p=ye(m),x=De(m,p,G),y=ir(m,G),P=sr(m,G),D=Ve(m,G,R);function X(Q){var j=x[Q];j&&(P[Q]=j)}X(qr),X(Te(Cn));var W=Object.keys(P).length>0,ce={framebuffer:p,draw:y,shader:D,state:P,dirty:W,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(ce.profile=he(m),ce.uniforms=Xe(A,G),ce.drawVAO=ce.scopeVAO=y.vao,!ce.drawVAO&&D.program&&!R&&E.angle_instanced_arrays&&y.static.elements){var Ie=!0,Le=D.program.attributes.map(function(Q){var j=u.static[Q];return Ie=Ie&&!!j,j});if(Ie&&Le.length>0){var _e=ie.getVAO(ie.createVAO({attributes:Le,elements:y.static.elements}));ce.drawVAO=new pr(null,null,null,function(Q,j){return Q.link(_e)}),ce.useVAO=!0}}return R?ce.useVAO=!0:ce.attributes=dr(u,G),ce.context=nr(C),ce}function hr(m,u,A){var C=m.shared,G=C.context,S=m.scope();Object.keys(A).forEach(function(M){u.save(G,"."+M);var R=A[M],p=R.append(m,u);Array.isArray(p)?S(G,".",M,"=[",p.join(),"];"):S(G,".",M,"=",p,";")}),u(S)}function mr(m,u,A,C){var G=m.shared,S=G.gl,M=G.framebuffer,R;be&&(R=u.def(G.extensions,".webgl_draw_buffers"));var p=m.constants,x=p.drawBuffer,y=p.backBuffer,P;A?P=A.append(m,u):P=u.def(M,".next"),C||u("if(",P,"!==",M,".cur){"),u("if(",P,"){",S,".bindFramebuffer(",Qf,",",P,".framebuffer);"),be&&u(R,".drawBuffersWEBGL(",x,"[",P,".colorAttachments.length]);"),u("}else{",S,".bindFramebuffer(",Qf,",null);"),be&&u(R,".drawBuffersWEBGL(",y,");"),u("}",M,".cur=",P,";"),C||u("}")}function yr(m,u,A){var C=m.shared,G=C.gl,S=m.current,M=m.next,R=C.current,p=C.next,x=m.cond(R,".dirty");Ce.forEach(function(y){var P=Te(y);if(!(P in A.state)){var D,X;if(P in M){D=M[P],X=S[P];var W=Lr(me[P].length,function(Ie){return x.def(D,"[",Ie,"]")});x(m.cond(W.map(function(Ie,Le){return Ie+"!=="+X+"["+Le+"]"}).join("||")).then(G,".",q[P],"(",W,");",W.map(function(Ie,Le){return X+"["+Le+"]="+Ie}).join(";"),";"))}else{D=x.def(p,".",P);var ce=m.cond(D,"!==",R,".",P);x(ce),P in Y?ce(m.cond(D).then(G,".enable(",Y[P],");").else(G,".disable(",Y[P],");"),R,".",P,"=",D,";"):ce(G,".",q[P],"(",D,");",R,".",P,"=",D,";")}}}),Object.keys(A.state).length===0&&x(R,".dirty=false;"),u(x)}function _r(m,u,A,C){var G=m.shared,S=m.current,M=G.current,R=G.gl;Jf(Object.keys(A)).forEach(function(p){var x=A[p];if(!(C&&!C(x))){var y=x.append(m,u);if(Y[p]){var P=Y[p];Jr(x)?y?u(R,".enable(",P,");"):u(R,".disable(",P,");"):u(m.cond(y).then(R,".enable(",P,");").else(R,".disable(",P,");")),u(M,".",p,"=",y,";")}else if(ar(y)){var D=S[p];u(R,".",q[p],"(",y,");",y.map(function(X,W){return D+"["+W+"]="+X}).join(";"),";")}else u(R,".",q[p],"(",y,");",M,".",p,"=",y,";")}})}function cr(m,u){ne&&(m.instancing=u.def(m.shared.extensions,".angle_instanced_arrays"))}function ke(m,u,A,C,G){var S=m.shared,M=m.stats,R=S.current,p=S.timer,x=A.profile;function y(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var P,D;function X(Q){P=u.def(),Q(P,"=",y(),";"),typeof G=="string"?Q(M,".count+=",G,";"):Q(M,".count++;"),re&&(C?(D=u.def(),Q(D,"=",p,".getNumPendingQueries();")):Q(p,".beginQuery(",M,");"))}function W(Q){Q(M,".cpuTime+=",y(),"-",P,";"),re&&(C?Q(p,".pushScopeStats(",D,",",p,".getNumPendingQueries(),",M,");"):Q(p,".endQuery();"))}function ce(Q){var j=u.def(R,".profile");u(R,".profile=",Q,";"),u.exit(R,".profile=",j,";")}var Ie;if(x){if(Jr(x)){x.enable?(X(u),W(u.exit),ce("true")):ce("false");return}Ie=x.append(m,u),ce(Ie)}else Ie=u.def(R,".profile");var Le=m.block();X(Le),u("if(",Ie,"){",Le,"}");var _e=m.block();W(_e),u.exit("if(",Ie,"){",_e,"}")}function xr(m,u,A,C,G){var S=m.shared;function M(p){switch(p){case Dn:case $n:case kn:return 2;case Pn:case Nn:case zn:return 3;case In:case Bn:case Un:return 4;default:return 1}}function R(p,x,y){var P=S.gl,D=u.def(p,".location"),X=u.def(S.attributes,"[",D,"]"),W=y.state,ce=y.buffer,Ie=[y.x,y.y,y.z,y.w],Le=["buffer","normalized","offset","stride"];function _e(){u("if(!",X,".buffer){",P,".enableVertexAttribArray(",D,");}");var j=y.type,we;if(y.size?we=u.def(y.size,"||",x):we=x,u("if(",X,".type!==",j,"||",X,".size!==",we,"||",Le.map(function(Pe){return X+"."+Pe+"!=="+y[Pe]}).join("||"),"){",P,".bindBuffer(",$t,",",ce,".buffer);",P,".vertexAttribPointer(",[D,we,j,y.normalized,y.stride,y.offset],");",X,".type=",j,";",X,".size=",we,";",Le.map(function(Pe){return X+"."+Pe+"="+y[Pe]+";"}).join(""),"}"),ne){var ge=y.divisor;u("if(",X,".divisor!==",ge,"){",m.instancing,".vertexAttribDivisorANGLE(",[D,ge],");",X,".divisor=",ge,";}")}}function Q(){u("if(",X,".buffer){",P,".disableVertexAttribArray(",D,");",X,".buffer=null;","}if(",Gt.map(function(j,we){return X+"."+j+"!=="+Ie[we]}).join("||"),"){",P,".vertexAttrib4f(",D,",",Ie,");",Gt.map(function(j,we){return X+"."+j+"="+Ie[we]+";"}).join(""),"}")}W===Dt?_e():W===Ca?Q():(u("if(",W,"===",Dt,"){"),_e(),u("}else{"),Q(),u("}"))}C.forEach(function(p){var x=p.name,y=A.attributes[x],P;if(y){if(!G(y))return;P=y.append(m,u)}else{if(!G(es))return;var D=m.scopeAttrib(x);l.optional(function(){m.assert(u,D+".state","missing attribute "+x)}),P={},Object.keys(new F).forEach(function(X){P[X]=u.def(D,".",X)})}R(m.link(p),M(p.info.type),P)})}function Ze(m,u,A,C,G,S){for(var M=m.shared,R=M.gl,p={},x,y=0;y<C.length;++y){var P=C[y],D=P.name,X=P.info.type,W=P.info.size,ce=A.uniforms[D];if(W>1){if(!ce)continue;var Ie=D.replace("[0]","");if(p[Ie])continue;p[Ie]=1}var Le=m.link(P),_e=Le+".location",Q;if(ce){if(!G(ce))continue;if(Jr(ce)){var j=ce.value;if(l.command(j!==null&&typeof j!="undefined",'missing uniform "'+D+'"',m.commandStr),X===rn||X===tn){l.command(typeof j=="function"&&(X===rn&&(j._reglType==="texture2d"||j._reglType==="framebuffer")||X===tn&&(j._reglType==="textureCube"||j._reglType==="framebufferCube")),"invalid texture for uniform "+D,m.commandStr);var we=m.link(j._texture||j.color[0]._texture);u(R,".uniform1i(",_e,",",we+".bind());"),u.exit(we,".unbind();")}else if(X===Zt||X===Jt||X===en){l.optional(function(){l.command(ar(j),"invalid matrix for uniform "+D,m.commandStr),l.command(X===Zt&&j.length===4||X===Jt&&j.length===9||X===en&&j.length===16,"invalid length for matrix uniform "+D,m.commandStr)});var ge=m.global.def("new Float32Array(["+Array.prototype.slice.call(j)+"])"),Pe=2;X===Jt?Pe=3:X===en&&(Pe=4),u(R,".uniformMatrix",Pe,"fv(",_e,",false,",ge,");")}else{switch(X){case Ya:W===1?l.commandType(j,"number","uniform "+D,m.commandStr):l.command(ar(j)&&j.length===W,"uniform "+D,m.commandStr),x="1f";break;case Dn:l.command(ar(j)&&j.length&&j.length%2==0&&j.length<=W*2,"uniform "+D,m.commandStr),x="2f";break;case Pn:l.command(ar(j)&&j.length&&j.length%3==0&&j.length<=W*3,"uniform "+D,m.commandStr),x="3f";break;case In:l.command(ar(j)&&j.length&&j.length%4==0&&j.length<=W*4,"uniform "+D,m.commandStr),x="4f";break;case Qa:W===1?l.commandType(j,"boolean","uniform "+D,m.commandStr):l.command(ar(j)&&j.length===W,"uniform "+D,m.commandStr),x="1i";break;case Wa:W===1?l.commandType(j,"number","uniform "+D,m.commandStr):l.command(ar(j)&&j.length===W,"uniform "+D,m.commandStr),x="1i";break;case kn:l.command(ar(j)&&j.length&&j.length%2==0&&j.length<=W*2,"uniform "+D,m.commandStr),x="2i";break;case $n:l.command(ar(j)&&j.length&&j.length%2==0&&j.length<=W*2,"uniform "+D,m.commandStr),x="2i";break;case zn:l.command(ar(j)&&j.length&&j.length%3==0&&j.length<=W*3,"uniform "+D,m.commandStr),x="3i";break;case Nn:l.command(ar(j)&&j.length&&j.length%3==0&&j.length<=W*3,"uniform "+D,m.commandStr),x="3i";break;case Un:l.command(ar(j)&&j.length&&j.length%4==0&&j.length<=W*4,"uniform "+D,m.commandStr),x="4i";break;case Bn:l.command(ar(j)&&j.length&&j.length%4==0&&j.length<=W*4,"uniform "+D,m.commandStr),x="4i";break}W>1?(x+="v",j=m.global.def("["+Array.prototype.slice.call(j)+"]")):j=ar(j)?Array.prototype.slice.call(j):j,u(R,".uniform",x,"(",_e,",",j,");")}continue}else Q=ce.append(m,u)}else{if(!G(es))continue;Q=u.def(M.uniforms,"[",h.id(D),"]")}X===rn?(l(!Array.isArray(Q),"must specify a scalar prop for textures"),u("if(",Q,"&&",Q,'._reglType==="framebuffer"){',Q,"=",Q,".color[0];","}")):X===tn&&(l(!Array.isArray(Q),"must specify a scalar prop for cube maps"),u("if(",Q,"&&",Q,'._reglType==="framebufferCube"){',Q,"=",Q,".color[0];","}")),l.optional(function(){function Fr(Or,jn){m.assert(u,Or,'bad data or missing for uniform "'+D+'".  '+jn)}function yt(Or,jn){jn===1&&l(!Array.isArray(Q),"must not specify an array type for uniform"),Fr("Array.isArray("+Q+") && typeof "+Q+'[0]===" '+Or+'" || typeof '+Q+'==="'+Or+'"',"invalid type, expected "+Or)}function Dr(Or,jn,Xn){Array.isArray(Q)?l(Q.length&&Q.length%Or==0&&Q.length<=Or*Xn,"must have length of "+(Xn===1?"":"n * ")+Or):Fr(M.isArrayLike+"("+Q+")&&"+Q+".length && "+Q+".length % "+Or+" === 0 && "+Q+".length<="+Or*Xn,"invalid vector, should have length of "+(Xn===1?"":"n * ")+Or,m.commandStr)}function ss(Or){l(!Array.isArray(Q),"must not specify a value type"),Fr("typeof "+Q+'==="function"&&'+Q+'._reglType==="texture'+(Or===Xf?"2d":"Cube")+'"',"invalid texture type",m.commandStr)}switch(X){case Wa:yt("number",W);break;case $n:Dr(2,"number",W);break;case Nn:Dr(3,"number",W);break;case Bn:Dr(4,"number",W);break;case Ya:yt("number",W);break;case Dn:Dr(2,"number",W);break;case Pn:Dr(3,"number",W);break;case In:Dr(4,"number",W);break;case Qa:yt("boolean",W);break;case kn:Dr(2,"boolean",W);break;case zn:Dr(3,"boolean",W);break;case Un:Dr(4,"boolean",W);break;case Zt:Dr(4,"number",W);break;case Jt:Dr(9,"number",W);break;case en:Dr(16,"number",W);break;case rn:ss(Xf);break;case tn:ss(nu);break}});var er=1;switch(X){case rn:case tn:var Er=u.def(Q,"._texture");u(R,".uniform1i(",_e,",",Er,".bind());"),u.exit(Er,".unbind();");continue;case Wa:case Qa:x="1i";break;case $n:case kn:x="2i",er=2;break;case Nn:case zn:x="3i",er=3;break;case Bn:case Un:x="4i",er=4;break;case Ya:x="1f";break;case Dn:x="2f",er=2;break;case Pn:x="3f",er=3;break;case In:x="4f",er=4;break;case Zt:x="Matrix2fv";break;case Jt:x="Matrix3fv";break;case en:x="Matrix4fv";break}if(x.indexOf("Matrix")===-1&&W>1&&(x+="v",er=1),x.charAt(0)==="M"){u(R,".uniform",x,"(",_e,",");var mt=Math.pow(X-Zt+2,2),Hr=m.global.def("new Float32Array(",mt,")");Array.isArray(Q)?u("false,(",Lr(mt,function(Fr){return Hr+"["+Fr+"]="+Q[Fr]}),",",Hr,")"):u("false,(Array.isArray(",Q,")||",Q," instanceof Float32Array)?",Q,":(",Lr(mt,function(Fr){return Hr+"["+Fr+"]="+Q+"["+Fr+"]"}),",",Hr,")"),u(");")}else if(er>1){for(var jr=[],et=[],pt=0;pt<er;++pt)Array.isArray(Q)?et.push(Q[pt]):et.push(u.def(Q+"["+pt+"]")),S&&jr.push(u.def());S&&u("if(!",m.batchId,"||",jr.map(function(Fr,yt){return Fr+"!=="+et[yt]}).join("||"),"){",jr.map(function(Fr,yt){return Fr+"="+et[yt]+";"}).join("")),u(R,".uniform",x,"(",_e,",",et.join(","),");"),S&&u("}")}else{if(l(!Array.isArray(Q),"uniform value must not be an array"),S){var fs=u.def();u("if(!",m.batchId,"||",fs,"!==",Q,"){",fs,"=",Q,";")}u(R,".uniform",x,"(",_e,",",Q,");"),S&&u("}")}}}function Fe(m,u,A,C){var G=m.shared,S=G.gl,M=G.draw,R=C.draw;function p(){var we=R.elements,ge,Pe=u;return we?((we.contextDep&&C.contextDynamic||we.propDep)&&(Pe=A),ge=we.append(m,Pe),R.elementsActive&&Pe("if("+ge+")"+S+".bindBuffer("+Ha+","+ge+".buffer.buffer);")):(ge=Pe.def(),Pe(ge,"=",M,".",ot,";","if(",ge,"){",S,".bindBuffer(",Ha,",",ge,".buffer.buffer);}","else if(",G.vao,".currentVAO){",ge,"=",m.shared.elements+".getElements("+G.vao,".currentVAO.elements);",K?"":"if("+ge+")"+S+".bindBuffer("+Ha+","+ge+".buffer.buffer);","}")),ge}function x(){var we=R.count,ge,Pe=u;return we?((we.contextDep&&C.contextDynamic||we.propDep)&&(Pe=A),ge=we.append(m,Pe),l.optional(function(){we.MISSING&&m.assert(u,"false","missing vertex count"),we.DYNAMIC&&m.assert(Pe,ge+">=0","missing vertex count")})):(ge=Pe.def(M,".",vt),l.optional(function(){m.assert(Pe,ge+">=0","missing vertex count")})),ge}var y=p();function P(we){var ge=R[we];return ge?ge.contextDep&&C.contextDynamic||ge.propDep?ge.append(m,A):ge.append(m,u):u.def(M,".",we)}var D=P(ut),X=P(Fn),W=x();if(typeof W=="number"){if(W===0)return}else A("if(",W,"){"),A.exit("}");var ce,Ie;ne&&(ce=P(Gn),Ie=m.instancing);var Le=y+".type",_e=R.elements&&Jr(R.elements)&&!R.vaoActive;function Q(){function we(){A(Ie,".drawElementsInstancedANGLE(",[D,W,Le,X+"<<(("+Le+"-"+Af+")>>1)",ce],");")}function ge(){A(Ie,".drawArraysInstancedANGLE(",[D,X,W,ce],");")}y&&y!=="null"?_e?we():(A("if(",y,"){"),we(),A("}else{"),ge(),A("}")):ge()}function j(){function we(){A(S+".drawElements("+[D,W,Le,X+"<<(("+Le+"-"+Af+")>>1)"]+");")}function ge(){A(S+".drawArrays("+[D,X,W]+");")}y&&y!=="null"?_e?we():(A("if(",y,"){"),we(),A("}else{"),ge(),A("}")):ge()}ne&&(typeof ce!="number"||ce>=0)?typeof ce=="string"?(A("if(",ce,">0){"),Q(),A("}else if(",ce,"<0){"),j(),A("}")):Q():j()}function je(m,u,A,C,G){var S=$e(),M=S.proc("body",G);return l.optional(function(){S.commandStr=u.commandStr,S.command=S.link(u.commandStr)}),ne&&(S.instancing=M.def(S.shared.extensions,".angle_instanced_arrays")),m(S,M,A,C),S.compile().body}function He(m,u,A,C){cr(m,u),A.useVAO?A.drawVAO?u(m.shared.vao,".setVAO(",A.drawVAO.append(m,u),");"):u(m.shared.vao,".setVAO(",m.shared.vao,".targetVAO);"):(u(m.shared.vao,".setVAO(null);"),xr(m,u,A,C.attributes,function(){return!0})),Ze(m,u,A,C.uniforms,function(){return!0},!1),Fe(m,u,u,A)}function lr(m,u){var A=m.proc("draw",1);cr(m,A),hr(m,A,u.context),mr(m,A,u.framebuffer),yr(m,A,u),_r(m,A,u.state),ke(m,A,u,!1,!0);var C=u.shader.progVar.append(m,A);if(A(m.shared.gl,".useProgram(",C,".program);"),u.shader.program)He(m,A,u,u.shader.program);else{A(m.shared.vao,".setVAO(null);");var G=m.global.def("{}"),S=A.def(C,".id"),M=A.def(G,"[",S,"]");A(m.cond(M).then(M,".call(this,a0);").else(M,"=",G,"[",S,"]=",m.link(function(R){return je(He,m,u,R,1)}),"(",C,");",M,".call(this,a0);"))}Object.keys(u.state).length>0&&A(m.shared.current,".dirty=true;"),m.shared.vao&&A(m.shared.vao,".setVAO(null);")}function Vr(m,u,A,C){m.batchId="a1",cr(m,u);function G(){return!0}xr(m,u,A,C.attributes,G),Ze(m,u,A,C.uniforms,G,!1),Fe(m,u,u,A)}function ht(m,u,A,C){cr(m,u);var G=A.contextDep,S=u.def(),M="a0",R="a1",p=u.def();m.shared.props=p,m.batchId=S;var x=m.scope(),y=m.scope();u(x.entry,"for(",S,"=0;",S,"<",R,";++",S,"){",p,"=",M,"[",S,"];",y,"}",x.exit);function P(Le){return Le.contextDep&&G||Le.propDep}function D(Le){return!P(Le)}if(A.needsContext&&hr(m,y,A.context),A.needsFramebuffer&&mr(m,y,A.framebuffer),_r(m,y,A.state,P),A.profile&&P(A.profile)&&ke(m,y,A,!1,!0),C)A.useVAO?A.drawVAO?P(A.drawVAO)?y(m.shared.vao,".setVAO(",A.drawVAO.append(m,y),");"):x(m.shared.vao,".setVAO(",A.drawVAO.append(m,x),");"):x(m.shared.vao,".setVAO(",m.shared.vao,".targetVAO);"):(x(m.shared.vao,".setVAO(null);"),xr(m,x,A,C.attributes,D),xr(m,y,A,C.attributes,P)),Ze(m,x,A,C.uniforms,D,!1),Ze(m,y,A,C.uniforms,P,!0),Fe(m,x,y,A);else{var X=m.global.def("{}"),W=A.shader.progVar.append(m,y),ce=y.def(W,".id"),Ie=y.def(X,"[",ce,"]");y(m.shared.gl,".useProgram(",W,".program);","if(!",Ie,"){",Ie,"=",X,"[",ce,"]=",m.link(function(Le){return je(Vr,m,A,Le,2)}),"(",W,");}",Ie,".call(this,a0[",S,"],",S,");")}}function b(m,u){var A=m.proc("batch",2);m.batchId="0",cr(m,A);var C=!1,G=!0;Object.keys(u.context).forEach(function(X){C=C||u.context[X].propDep}),C||(hr(m,A,u.context),G=!1);var S=u.framebuffer,M=!1;S?(S.propDep?C=M=!0:S.contextDep&&C&&(M=!0),M||mr(m,A,S)):mr(m,A,null),u.state.viewport&&u.state.viewport.propDep&&(C=!0);function R(X){return X.contextDep&&C||X.propDep}yr(m,A,u),_r(m,A,u.state,function(X){return!R(X)}),(!u.profile||!R(u.profile))&&ke(m,A,u,!1,"a1"),u.contextDep=C,u.needsContext=G,u.needsFramebuffer=M;var p=u.shader.progVar;if(p.contextDep&&C||p.propDep)ht(m,A,u,null);else{var x=p.append(m,A);if(A(m.shared.gl,".useProgram(",x,".program);"),u.shader.program)ht(m,A,u,u.shader.program);else{A(m.shared.vao,".setVAO(null);");var y=m.global.def("{}"),P=A.def(x,".id"),D=A.def(y,"[",P,"]");A(m.cond(D).then(D,".call(this,a0,a1);").else(D,"=",y,"[",P,"]=",m.link(function(X){return je(ht,m,u,X,2)}),"(",x,");",D,".call(this,a0,a1);"))}}Object.keys(u.state).length>0&&A(m.shared.current,".dirty=true;"),m.shared.vao&&A(m.shared.vao,".setVAO(null);")}function B(m,u){var A=m.proc("scope",3);m.batchId="a2";var C=m.shared,G=C.current;hr(m,A,u.context),u.framebuffer&&u.framebuffer.append(m,A),Jf(Object.keys(u.state)).forEach(function(M){var R=u.state[M],p=R.append(m,A);ar(p)?p.forEach(function(x,y){A.set(m.next[M],"["+y+"]",x)}):A.set(C.next,"."+M,p)}),ke(m,A,u,!0,!0),[ot,Fn,vt,Gn,ut].forEach(function(M){var R=u.draw[M];!R||A.set(C.draw,"."+M,""+R.append(m,A))}),Object.keys(u.uniforms).forEach(function(M){var R=u.uniforms[M].append(m,A);Array.isArray(R)&&(R="["+R.join()+"]"),A.set(C.uniforms,"["+h.id(M)+"]",R)}),Object.keys(u.attributes).forEach(function(M){var R=u.attributes[M].append(m,A),p=m.scopeAttrib(M);Object.keys(new F).forEach(function(x){A.set(p,"."+x,R[x])})}),u.scopeVAO&&A.set(C.vao,".targetVAO",u.scopeVAO.append(m,A));function S(M){var R=u.shader[M];R&&A.set(C.shader,"."+M,R.append(m,A))}S(Wt),S(Qt),Object.keys(u.state).length>0&&(A(G,".dirty=true;"),A.exit(G,".dirty=true;")),A("a1(",m.shared.context,",a0,",m.batchId,");")}function I(m){if(!(typeof m!="object"||ar(m))){for(var u=Object.keys(m),A=0;A<u.length;++A)if(Rr.isDynamic(m[u[A]]))return!0;return!1}}function xe(m,u,A){var C=u.static[A];if(!C||!I(C))return;var G=m.global,S=Object.keys(C),M=!1,R=!1,p=!1,x=m.global.def("{}");S.forEach(function(P){var D=C[P];if(Rr.isDynamic(D)){typeof D=="function"&&(D=C[P]=Rr.unbox(D));var X=wr(D,null);M=M||X.thisDep,p=p||X.propDep,R=R||X.contextDep}else{switch(G(x,".",P,"="),typeof D){case"number":G(D);break;case"string":G('"',D,'"');break;case"object":Array.isArray(D)&&G("[",D.join(),"]");break;default:G(m.link(D));break}G(";")}});function y(P,D){S.forEach(function(X){var W=C[X];if(!!Rr.isDynamic(W)){var ce=P.invoke(D,W);D(x,".",X,"=",ce,";")}})}u.dynamic[A]=new Rr.DynamicVariable(Ln,{thisDep:M,contextDep:R,propDep:p,ref:x,append:y}),delete u.static[A]}function Ue(m,u,A,C,G){var S=$e();S.stats=S.link(G),Object.keys(u.static).forEach(function(R){xe(S,u,R)}),eu.forEach(function(R){xe(S,m,R)});var M=vr(m,u,A,C,S);return lr(S,M),B(S,M),b(S,M),n(S.compile(),{destroy:function(){M.shader.program.destroy()}})}return{next:de,current:me,procs:function(){var m=$e(),u=m.proc("poll"),A=m.proc("refresh"),C=m.block();u(C),A(C);var G=m.shared,S=G.gl,M=G.next,R=G.current;C(R,".dirty=false;"),mr(m,u),mr(m,A,null,!0);var p;ne&&(p=m.link(ne)),E.oes_vertex_array_object&&A(m.link(E.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var x=0;x<N.maxAttributes;++x){var y=A.def(G.attributes,"[",x,"]"),P=m.cond(y,".buffer");P.then(S,".enableVertexAttribArray(",x,");",S,".bindBuffer(",$t,",",y,".buffer.buffer);",S,".vertexAttribPointer(",x,",",y,".size,",y,".type,",y,".normalized,",y,".stride,",y,".offset);").else(S,".disableVertexAttribArray(",x,");",S,".vertexAttrib4f(",x,",",y,".x,",y,".y,",y,".z,",y,".w);",y,".buffer=null;"),A(P),ne&&A(p,".vertexAttribDivisorANGLE(",x,",",y,".divisor);")}return A(m.shared.vao,".currentVAO=null;",m.shared.vao,".setVAO(",m.shared.vao,".targetVAO);"),Object.keys(Y).forEach(function(D){var X=Y[D],W=C.def(M,".",D),ce=m.block();ce("if(",W,"){",S,".enable(",X,")}else{",S,".disable(",X,")}",R,".",D,"=",W,";"),A(ce),u("if(",W,"!==",R,".",D,"){",ce,"}")}),Object.keys(q).forEach(function(D){var X=q[D],W=me[D],ce,Ie,Le=m.block();if(Le(S,".",X,"("),ar(W)){var _e=W.length;ce=m.global.def(M,".",D),Ie=m.global.def(R,".",D),Le(Lr(_e,function(Q){return ce+"["+Q+"]"}),");",Lr(_e,function(Q){return Ie+"["+Q+"]="+ce+"["+Q+"];"}).join("")),u("if(",Lr(_e,function(Q){return ce+"["+Q+"]!=="+Ie+"["+Q+"]"}).join("||"),"){",Le,"}")}else ce=C.def(M,".",D),Ie=C.def(R,".",D),Le(ce,");",R,".",D,"=",ce,";"),u("if(",ce,"!==",Ie,"){",Le,"}");A(Le)}),m.compile()}(),compile:Ue}}function _u(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var xu=34918,Eu=34919,rs=35007,Tu=function(f,h){if(!h.ext_disjoint_timer_query)return null;var E=[];function N(){return E.pop()||h.ext_disjoint_timer_query.createQueryEXT()}function H(ne){E.push(ne)}var $=[];function U(ne){var be=N();h.ext_disjoint_timer_query.beginQueryEXT(rs,be),$.push(be),re($.length-1,$.length,ne)}function ee(){h.ext_disjoint_timer_query.endQueryEXT(rs)}function J(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var ie=[];function se(){return ie.pop()||new J}function fe(ne){ie.push(ne)}var le=[];function re(ne,be,K){var me=se();me.startQueryIndex=ne,me.endQueryIndex=be,me.sum=0,me.stats=K,le.push(me)}var ae=[],F=[];function z(){var ne,be,K=$.length;if(K!==0){F.length=Math.max(F.length,K+1),ae.length=Math.max(ae.length,K+1),ae[0]=0,F[0]=0;var me=0;for(ne=0,be=0;be<$.length;++be){var de=$[be];h.ext_disjoint_timer_query.getQueryObjectEXT(de,Eu)?(me+=h.ext_disjoint_timer_query.getQueryObjectEXT(de,xu),H(de)):$[ne++]=de,ae[be+1]=me,F[be+1]=ne}for($.length=ne,ne=0,be=0;be<le.length;++be){var Ce=le[be],Y=Ce.startQueryIndex,q=Ce.endQueryIndex;Ce.sum+=ae[q]-ae[Y];var Te=F[Y],oe=F[q];oe===Te?(Ce.stats.gpuTime+=Ce.sum/1e6,fe(Ce)):(Ce.startQueryIndex=Te,Ce.endQueryIndex=oe,le[ne++]=Ce)}le.length=ne}}return{beginQuery:U,endQuery:ee,pushScopeStats:re,update:z,getNumPendingQueries:function(){return $.length},clear:function(){E.push.apply(E,$);for(var ne=0;ne<E.length;ne++)h.ext_disjoint_timer_query.deleteQueryEXT(E[ne]);$.length=0,E.length=0},restore:function(){$.length=0,E.length=0}}},gu=16384,Au=256,Mu=1024,Su=34962,ts="webglcontextlost",ns="webglcontextrestored",as=1,wu=2,Ou=3;function is(f,h){for(var E=0;E<f.length;++E)if(f[E]===h)return E;return-1}function Ru(f){var h=Sc(f);if(!h)return null;var E=h.gl,N=E.getContextAttributes(),H=E.isContextLost(),$=wc(E,h);if(!$)return null;var U=Ec(),ee=_u(),J=$.extensions,ie=Tu(E,J),se=vi(),fe=E.drawingBufferWidth,le=E.drawingBufferHeight,re={tick:0,time:0,viewportWidth:fe,viewportHeight:le,framebufferWidth:fe,framebufferHeight:le,drawingBufferWidth:fe,drawingBufferHeight:le,pixelRatio:h.pixelRatio},ae={},F={elements:null,primitive:4,count:-1,offset:0,instances:-1},z=hl(E,J),ne=Ll(E,ee,h,me),be=Ul(E,J,ne,ee),K=Vo(E,J,z,ee,ne,be,F);function me(Fe){return K.destroyBuffer(Fe)}var de=Ho(E,U,ee,h),Ce=xo(E,J,z,function(){Te.procs.poll()},re,ee,h),Y=Eo(E,J,z,ee,h),q=zo(E,J,z,Ce,Y,ee),Te=bu(E,U,J,z,ne,be,Ce,q,ae,K,de,F,re,ie,h),oe=Qo(E,q,Te.procs.poll,re,N,J,z),te=Te.next,ue=E.canvas,ve=[],Ne=[],$e=[],he=[h.onDestroy],ye=null;function De(){if(ve.length===0){ie&&ie.update(),ye=null;return}ye=na.next(De),_r();for(var Fe=ve.length-1;Fe>=0;--Fe){var je=ve[Fe];je&&je(re,null,0)}E.flush(),ie&&ie.update()}function Be(){!ye&&ve.length>0&&(ye=na.next(De))}function Ve(){ye&&(na.cancel(De),ye=null)}function ir(Fe){Fe.preventDefault(),H=!0,Ve(),Ne.forEach(function(je){je()})}function sr(Fe){E.getError(),H=!1,$.restore(),de.restore(),ne.restore(),Ce.restore(),Y.restore(),q.restore(),K.restore(),ie&&ie.restore(),Te.procs.refresh(),Be(),$e.forEach(function(je){je()})}ue&&(ue.addEventListener(ts,ir,!1),ue.addEventListener(ns,sr,!1));function Xe(){ve.length=0,Ve(),ue&&(ue.removeEventListener(ts,ir),ue.removeEventListener(ns,sr)),de.clear(),q.clear(),Y.clear(),K.clear(),Ce.clear(),be.clear(),ne.clear(),ie&&ie.clear(),he.forEach(function(Fe){Fe()})}function dr(Fe){l(!!Fe,"invalid args to regl({...})"),l.type(Fe,"object","invalid args to regl({...})");function je(G){var S=n({},G);delete S.uniforms,delete S.attributes,delete S.context,delete S.vao,"stencil"in S&&S.stencil.op&&(S.stencil.opBack=S.stencil.opFront=S.stencil.op,delete S.stencil.op);function M(R){if(R in S){var p=S[R];delete S[R],Object.keys(p).forEach(function(x){S[R+"."+x]=p[x]})}}return M("blend"),M("depth"),M("cull"),M("stencil"),M("polygonOffset"),M("scissor"),M("sample"),"vao"in G&&(S.vao=G.vao),S}function He(G,S){var M={},R={};return Object.keys(G).forEach(function(p){var x=G[p];if(Rr.isDynamic(x)){R[p]=Rr.unbox(x,p);return}else if(S&&Array.isArray(x)){for(var y=0;y<x.length;++y)if(Rr.isDynamic(x[y])){R[p]=Rr.unbox(x,p);return}}M[p]=x}),{dynamic:R,static:M}}var lr=He(Fe.context||{},!0),Vr=He(Fe.uniforms||{},!0),ht=He(Fe.attributes||{},!1),b=He(je(Fe),!1),B={gpuTime:0,cpuTime:0,count:0},I=Te.compile(b,ht,Vr,lr,B),xe=I.draw,Ue=I.batch,m=I.scope,u=[];function A(G){for(;u.length<G;)u.push(null);return u}function C(G,S){var M;if(H&&l.raise("context lost"),typeof G=="function")return m.call(this,null,G,0);if(typeof S=="function")if(typeof G=="number")for(M=0;M<G;++M)m.call(this,null,S,M);else if(Array.isArray(G))for(M=0;M<G.length;++M)m.call(this,G[M],S,M);else return m.call(this,G,S,0);else if(typeof G=="number"){if(G>0)return Ue.call(this,A(G|0),G|0)}else if(Array.isArray(G)){if(G.length)return Ue.call(this,G,G.length)}else return xe.call(this,G)}return n(C,{stats:B,destroy:function(){I.destroy()}})}var nr=q.setFBO=dr({framebuffer:Rr.define.call(null,as,"framebuffer")});function vr(Fe,je){var He=0;Te.procs.poll();var lr=je.color;lr&&(E.clearColor(+lr[0]||0,+lr[1]||0,+lr[2]||0,+lr[3]||0),He|=gu),"depth"in je&&(E.clearDepth(+je.depth),He|=Au),"stencil"in je&&(E.clearStencil(je.stencil|0),He|=Mu),l(!!He,"called regl.clear with no buffer specified"),E.clear(He)}function hr(Fe){if(l(typeof Fe=="object"&&Fe,"regl.clear() takes an object as input"),"framebuffer"in Fe)if(Fe.framebuffer&&Fe.framebuffer_reglType==="framebufferCube")for(var je=0;je<6;++je)nr(n({framebuffer:Fe.framebuffer.faces[je]},Fe),vr);else nr(Fe,vr);else vr(null,Fe)}function mr(Fe){l.type(Fe,"function","regl.frame() callback must be a function"),ve.push(Fe);function je(){var He=is(ve,Fe);l(He>=0,"cannot cancel a frame twice");function lr(){var Vr=is(ve,lr);ve[Vr]=ve[ve.length-1],ve.length-=1,ve.length<=0&&Ve()}ve[He]=lr}return Be(),{cancel:je}}function yr(){var Fe=te.viewport,je=te.scissor_box;Fe[0]=Fe[1]=je[0]=je[1]=0,re.viewportWidth=re.framebufferWidth=re.drawingBufferWidth=Fe[2]=je[2]=E.drawingBufferWidth,re.viewportHeight=re.framebufferHeight=re.drawingBufferHeight=Fe[3]=je[3]=E.drawingBufferHeight}function _r(){re.tick+=1,re.time=ke(),yr(),Te.procs.poll()}function cr(){Ce.refresh(),yr(),Te.procs.refresh(),ie&&ie.update()}function ke(){return(vi()-se)/1e3}cr();function xr(Fe,je){l.type(je,"function","listener callback must be a function");var He;switch(Fe){case"frame":return mr(je);case"lost":He=Ne;break;case"restore":He=$e;break;case"destroy":He=he;break;default:l.raise("invalid event, must be one of frame,lost,restore,destroy")}return He.push(je),{cancel:function(){for(var lr=0;lr<He.length;++lr)if(He[lr]===je){He[lr]=He[He.length-1],He.pop();return}}}}var Ze=n(dr,{clear:hr,prop:Rr.define.bind(null,as),context:Rr.define.bind(null,wu),this:Rr.define.bind(null,Ou),draw:dr({}),buffer:function(Fe){return ne.create(Fe,Su,!1,!1)},elements:function(Fe){return be.create(Fe,!1)},texture:Ce.create2D,cube:Ce.createCube,renderbuffer:Y.create,framebuffer:q.create,framebufferCube:q.createCube,vao:K.createVAO,attributes:N,frame:mr,on:xr,limits:z,hasExtension:function(Fe){return z.extensions.indexOf(Fe.toLowerCase())>=0},read:oe,destroy:Xe,_gl:E,_refresh:cr,poll:function(){_r(),ie&&ie.update()},now:ke,stats:ee});return h.onDone(null,Ze),Ze}return Ru})})(ls);var am=ls.exports,Cu={exports:{}};/*!
 * PEP v0.4.3 | https://github.com/jquery/PEP
 * Copyright jQuery Foundation and other contributors | http://jquery.org/license
 */(function(e,r){(function(t,n){e.exports=n()})(cs,function(){var t=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"],n=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0];function a(v,g){g=g||Object.create(null);var l=document.createEvent("Event");l.initEvent(v,g.bubbles||!1,g.cancelable||!1);for(var Ee=2,ze;Ee<t.length;Ee++)ze=t[Ee],l[ze]=g[ze]||n[Ee];l.buttons=g.buttons||0;var fr=0;return g.pressure&&l.buttons?fr=g.pressure:fr=l.buttons?.5:0,l.x=l.clientX,l.y=l.clientY,l.pointerId=g.pointerId||0,l.width=g.width||0,l.height=g.height||0,l.pressure=fr,l.tiltX=g.tiltX||0,l.tiltY=g.tiltY||0,l.twist=g.twist||0,l.tangentialPressure=g.tangentialPressure||0,l.pointerType=g.pointerType||"",l.hwTimestamp=g.hwTimestamp||0,l.isPrimary=g.isPrimary||!1,l}var i=window.Map&&window.Map.prototype.forEach,c=i?Map:s;function s(){this.array=[],this.size=0}s.prototype={set:function(v,g){if(g===void 0)return this.delete(v);this.has(v)||this.size++,this.array[v]=g},has:function(v){return this.array[v]!==void 0},delete:function(v){this.has(v)&&(delete this.array[v],this.size--)},get:function(v){return this.array[v]},clear:function(){this.array.length=0,this.size=0},forEach:function(v,g){return this.array.forEach(function(l,Ee){v.call(g,l,Ee,this)},this)}};var o=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp"],d=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],_={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},O=typeof SVGElementInstance!="undefined",T={pointermap:new c,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(v,g){var l=g,Ee=l.events;Ee&&(Ee.forEach(function(ze){l[ze]&&(this.eventMap[ze]=l[ze].bind(l))},this),this.eventSources[v]=l,this.eventSourceList.push(l))},register:function(v){for(var g=this.eventSourceList.length,l=0,Ee;l<g&&(Ee=this.eventSourceList[l]);l++)Ee.register.call(Ee,v)},unregister:function(v){for(var g=this.eventSourceList.length,l=0,Ee;l<g&&(Ee=this.eventSourceList[l]);l++)Ee.unregister.call(Ee,v)},contains:function(v,g){try{return v.contains(g)}catch(l){return!1}},down:function(v){v.bubbles=!0,this.fireEvent("pointerdown",v)},move:function(v){v.bubbles=!0,this.fireEvent("pointermove",v)},up:function(v){v.bubbles=!0,this.fireEvent("pointerup",v)},enter:function(v){v.bubbles=!1,this.fireEvent("pointerenter",v)},leave:function(v){v.bubbles=!1,this.fireEvent("pointerleave",v)},over:function(v){v.bubbles=!0,this.fireEvent("pointerover",v)},out:function(v){v.bubbles=!0,this.fireEvent("pointerout",v)},cancel:function(v){v.bubbles=!0,this.fireEvent("pointercancel",v)},leaveOut:function(v){this.out(v),this.propagate(v,this.leave,!1)},enterOver:function(v){this.over(v),this.propagate(v,this.enter,!0)},eventHandler:function(v){if(!v._handledByPE){var g=v.type,l=this.eventMap&&this.eventMap[g];l&&l(v),v._handledByPE=!0}},listen:function(v,g){g.forEach(function(l){this.addEvent(v,l)},this)},unlisten:function(v,g){g.forEach(function(l){this.removeEvent(v,l)},this)},addEvent:function(v,g){v.addEventListener(g,this.boundHandler)},removeEvent:function(v,g){v.removeEventListener(g,this.boundHandler)},makeEvent:function(v,g){this.captureInfo[g.pointerId]&&(g.relatedTarget=null);var l=new a(v,g);return g.preventDefault&&(l.preventDefault=g.preventDefault),l._target=l._target||g.target,l},fireEvent:function(v,g){var l=this.makeEvent(v,g);return this.dispatchEvent(l)},cloneEvent:function(v){for(var g=Object.create(null),l,Ee=0;Ee<o.length;Ee++)l=o[Ee],g[l]=v[l]||d[Ee],O&&(l==="target"||l==="relatedTarget")&&g[l]instanceof SVGElementInstance&&(g[l]=g[l].correspondingUseElement);return v.preventDefault&&(g.preventDefault=function(){v.preventDefault()}),g},getTarget:function(v){var g=this.captureInfo[v.pointerId];if(!g)return v._target;if(v._target===g||!(v.type in _))return g},propagate:function(v,g,l){for(var Ee=v.target,ze=[];Ee!==document&&!Ee.contains(v.relatedTarget);)if(ze.push(Ee),Ee=Ee.parentNode,!Ee)return;l&&ze.reverse(),ze.forEach(function(fr){v.target=fr,g.call(this,v)},this)},setCapture:function(v,g,l){this.captureInfo[v]&&this.releaseCapture(v,l),this.captureInfo[v]=g,this.implicitRelease=this.releaseCapture.bind(this,v,l),document.addEventListener("pointerup",this.implicitRelease),document.addEventListener("pointercancel",this.implicitRelease);var Ee=new a("gotpointercapture");Ee.pointerId=v,Ee._target=g,l||this.asyncDispatchEvent(Ee)},releaseCapture:function(v,g){var l=this.captureInfo[v];if(!!l){this.captureInfo[v]=void 0,document.removeEventListener("pointerup",this.implicitRelease),document.removeEventListener("pointercancel",this.implicitRelease);var Ee=new a("lostpointercapture");Ee.pointerId=v,Ee._target=l,g||this.asyncDispatchEvent(Ee)}},dispatchEvent:function(v){var g=this.getTarget(v);if(g)return g.dispatchEvent(v)},asyncDispatchEvent:function(v){requestAnimationFrame(this.dispatchEvent.bind(this,v))}};T.boundHandler=T.eventHandler.bind(T);var w={shadow:function(v){if(v)return v.shadowRoot||v.webkitShadowRoot},canTarget:function(v){return v&&Boolean(v.elementFromPoint)},targetingShadow:function(v){var g=this.shadow(v);if(this.canTarget(g))return g},olderShadow:function(v){var g=v.olderShadowRoot;if(!g){var l=v.querySelector("shadow");l&&(g=l.olderShadowRoot)}return g},allShadows:function(v){for(var g=[],l=this.shadow(v);l;)g.push(l),l=this.olderShadow(l);return g},searchRoot:function(v,g,l){if(v){var Ee=v.elementFromPoint(g,l),ze,fr;for(fr=this.targetingShadow(Ee);fr;)if(ze=fr.elementFromPoint(g,l),!ze)fr=this.olderShadow(fr);else{var Ir=this.targetingShadow(ze);return this.searchRoot(Ir,g,l)||ze}return Ee}},owner:function(v){for(var g=v;g.parentNode;)g=g.parentNode;return g.nodeType!==Node.DOCUMENT_NODE&&g.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(g=document),g},findTarget:function(v){var g=v.clientX,l=v.clientY,Ee=this.owner(v.target);return Ee.elementFromPoint(g,l)||(Ee=document),this.searchRoot(Ee,g,l)}},k=Array.prototype.forEach.call.bind(Array.prototype.forEach),V=Array.prototype.map.call.bind(Array.prototype.map),L=Array.prototype.slice.call.bind(Array.prototype.slice),Z=Array.prototype.filter.call.bind(Array.prototype.filter),pe=window.MutationObserver||window.WebKitMutationObserver,Se="[touch-action]",Oe={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};function Ae(v,g,l,Ee){this.addCallback=v.bind(Ee),this.removeCallback=g.bind(Ee),this.changedCallback=l.bind(Ee),pe&&(this.observer=new pe(this.mutationWatcher.bind(this)))}Ae.prototype={watchSubtree:function(v){this.observer&&w.canTarget(v)&&this.observer.observe(v,Oe)},enableOnSubtree:function(v){this.watchSubtree(v),v===document&&document.readyState!=="complete"?this.installOnLoad():this.installNewSubtree(v)},installNewSubtree:function(v){k(this.findElements(v),this.addElement,this)},findElements:function(v){return v.querySelectorAll?v.querySelectorAll(Se):[]},removeElement:function(v){this.removeCallback(v)},addElement:function(v){this.addCallback(v)},elementChanged:function(v,g){this.changedCallback(v,g)},concatLists:function(v,g){return v.concat(L(g))},installOnLoad:function(){document.addEventListener("readystatechange",function(){document.readyState==="complete"&&this.installNewSubtree(document)}.bind(this))},isElement:function(v){return v.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(v){var g=V(v,this.findElements,this);return g.push(Z(v,this.isElement)),g.reduce(this.concatLists,[])},mutationWatcher:function(v){v.forEach(this.mutationHandler,this)},mutationHandler:function(v){if(v.type==="childList"){var g=this.flattenMutationTree(v.addedNodes);g.forEach(this.addElement,this);var l=this.flattenMutationTree(v.removedNodes);l.forEach(this.removeElement,this)}else v.type==="attributes"&&this.elementChanged(v.target,v.oldValue)}};function Re(v){return"body /shadow-deep/ "+We(v)}function We(v){return'[touch-action="'+v+'"]'}function Qe(v){return"{ -ms-touch-action: "+v+"; touch-action: "+v+"; }"}var Je=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],qe="",rr=window.PointerEvent||window.MSPointerEvent,Ke=!window.ShadowDOMPolyfill&&document.head.createShadowRoot;function tr(){if(rr){Je.forEach(function(g){String(g)===g?(qe+=We(g)+Qe(g)+`
`,Ke&&(qe+=Re(g)+Qe(g)+`
`)):(qe+=g.selectors.map(We)+Qe(g.rule)+`
`,Ke&&(qe+=g.selectors.map(Re)+Qe(g.rule)+`
`))});var v=document.createElement("style");v.textContent=qe,document.head.appendChild(v)}}var Me=T.pointermap,Tr=25,Pr=[1,4,2,8,16],Ar=!1;try{Ar=new MouseEvent("test",{buttons:1}).buttons===1}catch(v){}var rt={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(v){T.listen(v,this.events)},unregister:function(v){T.unlisten(v,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(v){for(var g=this.lastTouches,l=v.clientX,Ee=v.clientY,ze=0,fr=g.length,Ir;ze<fr&&(Ir=g[ze]);ze++){var Sr=Math.abs(l-Ir.x),dn=Math.abs(Ee-Ir.y);if(Sr<=Tr&&dn<=Tr)return!0}},prepareEvent:function(v){var g=T.cloneEvent(v),l=g.preventDefault;return g.preventDefault=function(){v.preventDefault(),l()},g.pointerId=this.POINTER_ID,g.isPrimary=!0,g.pointerType=this.POINTER_TYPE,g},prepareButtonsForMove:function(v,g){var l=Me.get(this.POINTER_ID);g.which===0||!l?v.buttons=0:v.buttons=l.buttons,g.buttons=v.buttons},mousedown:function(v){if(!this.isEventSimulatedFromTouch(v)){var g=Me.get(this.POINTER_ID),l=this.prepareEvent(v);Ar||(l.buttons=Pr[l.button],g&&(l.buttons|=g.buttons),v.buttons=l.buttons),Me.set(this.POINTER_ID,v),!g||g.buttons===0?T.down(l):T.move(l)}},mousemove:function(v){if(!this.isEventSimulatedFromTouch(v)){var g=this.prepareEvent(v);Ar||this.prepareButtonsForMove(g,v),g.button=-1,Me.set(this.POINTER_ID,v),T.move(g)}},mouseup:function(v){if(!this.isEventSimulatedFromTouch(v)){var g=Me.get(this.POINTER_ID),l=this.prepareEvent(v);if(!Ar){var Ee=Pr[l.button];l.buttons=g?g.buttons&~Ee:0,v.buttons=l.buttons}Me.set(this.POINTER_ID,v),l.buttons&=~Pr[l.button],l.buttons===0?T.up(l):T.move(l)}},mouseover:function(v){if(!this.isEventSimulatedFromTouch(v)){var g=this.prepareEvent(v);Ar||this.prepareButtonsForMove(g,v),g.button=-1,Me.set(this.POINTER_ID,v),T.enterOver(g)}},mouseout:function(v){if(!this.isEventSimulatedFromTouch(v)){var g=this.prepareEvent(v);Ar||this.prepareButtonsForMove(g,v),g.button=-1,T.leaveOut(g)}},cancel:function(v){var g=this.prepareEvent(v);T.cancel(g),this.deactivateMouse()},deactivateMouse:function(){Me.delete(this.POINTER_ID)}},bt=T.captureInfo,_t=w.findTarget.bind(w),xt=w.allShadows.bind(w),kr=T.pointermap,Zn=2500,Jn=200,sn="touch-action",cn,tt={events:["touchstart","touchmove","touchend","touchcancel"],register:function(v){cn.enableOnSubtree(v)},unregister:function(){},elementAdded:function(v){var g=v.getAttribute(sn),l=this.touchActionToScrollType(g);l&&(v._scrollType=l,T.listen(v,this.events),xt(v).forEach(function(Ee){Ee._scrollType=l,T.listen(Ee,this.events)},this))},elementRemoved:function(v){v._scrollType=void 0,T.unlisten(v,this.events),xt(v).forEach(function(g){g._scrollType=void 0,T.unlisten(g,this.events)},this)},elementChanged:function(v,g){var l=v.getAttribute(sn),Ee=this.touchActionToScrollType(l),ze=this.touchActionToScrollType(g);Ee&&ze?(v._scrollType=Ee,xt(v).forEach(function(fr){fr._scrollType=Ee},this)):ze?this.elementRemoved(v):Ee&&this.elementAdded(v)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(v){var g=v,l=this.scrollTypes;if(g==="none")return"none";if(g===l.XSCROLLER)return"X";if(g===l.YSCROLLER)return"Y";if(l.SCROLLER.exec(g))return"XY"},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(v){return this.firstTouch===v.identifier},setPrimaryTouch:function(v){(kr.size===0||kr.size===1&&kr.has(1))&&(this.firstTouch=v.identifier,this.firstXY={X:v.clientX,Y:v.clientY},this.scrolling=!1,this.cancelResetClickCount())},removePrimaryPointer:function(v){v.isPrimary&&(this.firstTouch=null,this.firstXY=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var v=function(){this.clickCount=0,this.resetId=null}.bind(this);this.resetId=setTimeout(v,Jn)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(v){var g=0;return(v==="touchstart"||v==="touchmove")&&(g=1),g},touchToPointer:function(v){var g=this.currentTouchEvent,l=T.cloneEvent(v),Ee=l.pointerId=v.identifier+2;l.target=bt[Ee]||_t(l),l.bubbles=!0,l.cancelable=!0,l.detail=this.clickCount,l.button=0,l.buttons=this.typeToButtons(g.type),l.width=(v.radiusX||v.webkitRadiusX||0)*2,l.height=(v.radiusY||v.webkitRadiusY||0)*2,l.pressure=v.force||v.webkitForce||.5,l.isPrimary=this.isPrimaryTouch(v),l.pointerType=this.POINTER_TYPE,l.altKey=g.altKey,l.ctrlKey=g.ctrlKey,l.metaKey=g.metaKey,l.shiftKey=g.shiftKey;var ze=this;return l.preventDefault=function(){ze.scrolling=!1,ze.firstXY=null,g.preventDefault()},l},processTouches:function(v,g){var l=v.changedTouches;this.currentTouchEvent=v;for(var Ee=0,ze;Ee<l.length;Ee++)ze=l[Ee],g.call(this,this.touchToPointer(ze))},shouldScroll:function(v){if(this.firstXY){var g,l=v.currentTarget._scrollType;if(l==="none")g=!1;else if(l==="XY")g=!0;else{var Ee=v.changedTouches[0],ze=l,fr=l==="Y"?"X":"Y",Ir=Math.abs(Ee["client"+ze]-this.firstXY[ze]),Sr=Math.abs(Ee["client"+fr]-this.firstXY[fr]);g=Ir>=Sr}return this.firstXY=null,g}},findTouch:function(v,g){for(var l=0,Ee=v.length,ze;l<Ee&&(ze=v[l]);l++)if(ze.identifier===g)return!0},vacuumTouches:function(v){var g=v.touches;if(kr.size>=g.length){var l=[];kr.forEach(function(Ee,ze){if(ze!==1&&!this.findTouch(g,ze-2)){var fr=Ee.out;l.push(fr)}},this),l.forEach(this.cancelOut,this)}},touchstart:function(v){this.vacuumTouches(v),this.setPrimaryTouch(v.changedTouches[0]),this.dedupSynthMouse(v),this.scrolling||(this.clickCount++,this.processTouches(v,this.overDown))},overDown:function(v){kr.set(v.pointerId,{target:v.target,out:v,outTarget:v.target}),T.enterOver(v),T.down(v)},touchmove:function(v){this.scrolling||(this.shouldScroll(v)?(this.scrolling=!0,this.touchcancel(v)):(v.preventDefault(),this.processTouches(v,this.moveOverOut)))},moveOverOut:function(v){var g=v,l=kr.get(g.pointerId);if(!!l){var Ee=l.out,ze=l.outTarget;T.move(g),Ee&&ze!==g.target&&(Ee.relatedTarget=g.target,g.relatedTarget=ze,Ee.target=ze,g.target?(T.leaveOut(Ee),T.enterOver(g)):(g.target=ze,g.relatedTarget=null,this.cancelOut(g))),l.out=g,l.outTarget=g.target}},touchend:function(v){this.dedupSynthMouse(v),this.processTouches(v,this.upOut)},upOut:function(v){this.scrolling||(T.up(v),T.leaveOut(v)),this.cleanUpPointer(v)},touchcancel:function(v){this.processTouches(v,this.cancelOut)},cancelOut:function(v){T.cancel(v),T.leaveOut(v),this.cleanUpPointer(v)},cleanUpPointer:function(v){kr.delete(v.pointerId),this.removePrimaryPointer(v)},dedupSynthMouse:function(v){var g=rt.lastTouches,l=v.changedTouches[0];if(this.isPrimaryTouch(l)){var Ee={x:l.clientX,y:l.clientY};g.push(Ee);var ze=function(fr,Ir){var Sr=fr.indexOf(Ir);Sr>-1&&fr.splice(Sr,1)}.bind(null,g,Ee);setTimeout(ze,Zn)}}};cn=new Ae(tt.elementAdded,tt.elementRemoved,tt.elementChanged,tt);var ln=T.pointermap,ea=window.MSPointerEvent&&typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE=="number",ra={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(v){T.listen(v,this.events)},unregister:function(v){T.unlisten(v,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(v){var g=v;return ea&&(g=T.cloneEvent(v),g.pointerType=this.POINTER_TYPES[v.pointerType]),g},cleanup:function(v){ln.delete(v)},MSPointerDown:function(v){ln.set(v.pointerId,v);var g=this.prepareEvent(v);T.down(g)},MSPointerMove:function(v){var g=this.prepareEvent(v);T.move(g)},MSPointerUp:function(v){var g=this.prepareEvent(v);T.up(g),this.cleanup(v.pointerId)},MSPointerOut:function(v){var g=this.prepareEvent(v);T.leaveOut(g)},MSPointerOver:function(v){var g=this.prepareEvent(v);T.enterOver(g)},MSPointerCancel:function(v){var g=this.prepareEvent(v);T.cancel(g),this.cleanup(v.pointerId)},MSLostPointerCapture:function(v){var g=T.makeEvent("lostpointercapture",v);T.dispatchEvent(g)},MSGotPointerCapture:function(v){var g=T.makeEvent("gotpointercapture",v);T.dispatchEvent(g)}};function ta(){if(!window.PointerEvent){if(window.PointerEvent=a,window.navigator.msPointerEnabled){var v=window.navigator.msMaxTouchPoints;Object.defineProperty(window.navigator,"maxTouchPoints",{value:v,enumerable:!0}),T.registerSource("ms",ra)}else Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),T.registerSource("mouse",rt),window.ontouchstart!==void 0&&T.registerSource("touch",tt);T.register(document)}}var on=window.navigator,Et,Tt,Bt;function nt(v){if(!T.pointermap.has(v)){var g=new Error("InvalidPointerId");throw g.name="InvalidPointerId",g}}function un(v){for(var g=v.parentNode;g&&g!==v.ownerDocument;)g=g.parentNode;if(!g){var l=new Error("InvalidStateError");throw l.name="InvalidStateError",l}}function gr(v){var g=T.pointermap.get(v);return g.buttons!==0}on.msPointerEnabled?(Et=function(v){nt(v),un(this),gr(v)&&(T.setCapture(v,this,!0),this.msSetPointerCapture(v))},Tt=function(v){nt(v),T.releaseCapture(v,!0),this.msReleasePointerCapture(v)}):(Et=function(g){nt(g),un(this),gr(g)&&T.setCapture(g,this)},Tt=function(g){nt(g),T.releaseCapture(g)}),Bt=function(g){return!!T.captureInfo[g]};function vn(){window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:Et},releasePointerCapture:{value:Tt},hasPointerCapture:{value:Bt}})}tr(),ta(),vn();var gt={dispatcher:T,Installer:Ae,PointerEvent:a,PointerMap:c,targetFinding:w};return gt})})(Cu);var Ge=1e-6,Ye=typeof Float32Array!="undefined"?Float32Array:Array,Br=Math.random;function Fu(e){Ye=e}var Gu=Math.PI/180;function Du(e){return e*Gu}function Pu(e,r){return Math.abs(e-r)<=Ge*Math.max(1,Math.abs(e),Math.abs(r))}var Iu=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",EPSILON:Ge,get ARRAY_TYPE(){return Ye},RANDOM:Br,setMatrixArrayType:Fu,toRadian:Du,equals:Pu});function $u(){var e=new Ye(4);return Ye!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}function Nu(e){var r=new Ye(4);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}function Bu(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function ku(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}function zu(e,r,t,n){var a=new Ye(4);return a[0]=e,a[1]=r,a[2]=t,a[3]=n,a}function Uu(e,r,t,n,a){return e[0]=r,e[1]=t,e[2]=n,e[3]=a,e}function Vu(e,r){if(e===r){var t=r[1];e[1]=r[2],e[2]=t}else e[0]=r[0],e[1]=r[2],e[2]=r[1],e[3]=r[3];return e}function ju(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],c=t*i-a*n;return c?(c=1/c,e[0]=i*c,e[1]=-n*c,e[2]=-a*c,e[3]=t*c,e):null}function Xu(e,r){var t=r[0];return e[0]=r[3],e[1]=-r[1],e[2]=-r[2],e[3]=t,e}function qu(e){return e[0]*e[3]-e[2]*e[1]}function os(e,r,t){var n=r[0],a=r[1],i=r[2],c=r[3],s=t[0],o=t[1],d=t[2],_=t[3];return e[0]=n*s+i*o,e[1]=a*s+c*o,e[2]=n*d+i*_,e[3]=a*d+c*_,e}function Hu(e,r,t){var n=r[0],a=r[1],i=r[2],c=r[3],s=Math.sin(t),o=Math.cos(t);return e[0]=n*o+i*s,e[1]=a*o+c*s,e[2]=n*-s+i*o,e[3]=a*-s+c*o,e}function Yu(e,r,t){var n=r[0],a=r[1],i=r[2],c=r[3],s=t[0],o=t[1];return e[0]=n*s,e[1]=a*s,e[2]=i*o,e[3]=c*o,e}function Wu(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=n,e[1]=t,e[2]=-t,e[3]=n,e}function Qu(e,r){return e[0]=r[0],e[1]=0,e[2]=0,e[3]=r[1],e}function Ku(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function Zu(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))}function Ju(e,r,t,n){return e[2]=n[2]/n[0],t[0]=n[0],t[1]=n[1],t[3]=n[3]-e[2]*t[1],[e,r,t]}function e0(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e[3]=r[3]+t[3],e}function us(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e[3]=r[3]-t[3],e}function r0(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]}function t0(e,r){var t=e[0],n=e[1],a=e[2],i=e[3],c=r[0],s=r[1],o=r[2],d=r[3];return Math.abs(t-c)<=Ge*Math.max(1,Math.abs(t),Math.abs(c))&&Math.abs(n-s)<=Ge*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-o)<=Ge*Math.max(1,Math.abs(a),Math.abs(o))&&Math.abs(i-d)<=Ge*Math.max(1,Math.abs(i),Math.abs(d))}function n0(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e}function a0(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e[2]=r[2]+t[2]*n,e[3]=r[3]+t[3]*n,e}var i0=os,f0=us,s0=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:$u,clone:Nu,copy:Bu,identity:ku,fromValues:zu,set:Uu,transpose:Vu,invert:ju,adjoint:Xu,determinant:qu,multiply:os,rotate:Hu,scale:Yu,fromRotation:Wu,fromScaling:Qu,str:Ku,frob:Zu,LDU:Ju,add:e0,subtract:us,exactEquals:r0,equals:t0,multiplyScalar:n0,multiplyScalarAndAdd:a0,mul:i0,sub:f0});function c0(){var e=new Ye(6);return Ye!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e}function l0(e){var r=new Ye(6);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r}function o0(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e}function u0(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function v0(e,r,t,n,a,i){var c=new Ye(6);return c[0]=e,c[1]=r,c[2]=t,c[3]=n,c[4]=a,c[5]=i,c}function d0(e,r,t,n,a,i,c){return e[0]=r,e[1]=t,e[2]=n,e[3]=a,e[4]=i,e[5]=c,e}function h0(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],c=r[4],s=r[5],o=t*i-n*a;return o?(o=1/o,e[0]=i*o,e[1]=-n*o,e[2]=-a*o,e[3]=t*o,e[4]=(a*s-i*c)*o,e[5]=(n*c-t*s)*o,e):null}function m0(e){return e[0]*e[3]-e[1]*e[2]}function vs(e,r,t){var n=r[0],a=r[1],i=r[2],c=r[3],s=r[4],o=r[5],d=t[0],_=t[1],O=t[2],T=t[3],w=t[4],k=t[5];return e[0]=n*d+i*_,e[1]=a*d+c*_,e[2]=n*O+i*T,e[3]=a*O+c*T,e[4]=n*w+i*k+s,e[5]=a*w+c*k+o,e}function p0(e,r,t){var n=r[0],a=r[1],i=r[2],c=r[3],s=r[4],o=r[5],d=Math.sin(t),_=Math.cos(t);return e[0]=n*_+i*d,e[1]=a*_+c*d,e[2]=n*-d+i*_,e[3]=a*-d+c*_,e[4]=s,e[5]=o,e}function y0(e,r,t){var n=r[0],a=r[1],i=r[2],c=r[3],s=r[4],o=r[5],d=t[0],_=t[1];return e[0]=n*d,e[1]=a*d,e[2]=i*_,e[3]=c*_,e[4]=s,e[5]=o,e}function b0(e,r,t){var n=r[0],a=r[1],i=r[2],c=r[3],s=r[4],o=r[5],d=t[0],_=t[1];return e[0]=n,e[1]=a,e[2]=i,e[3]=c,e[4]=n*d+i*_+s,e[5]=a*d+c*_+o,e}function _0(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=n,e[1]=t,e[2]=-t,e[3]=n,e[4]=0,e[5]=0,e}function x0(e,r){return e[0]=r[0],e[1]=0,e[2]=0,e[3]=r[1],e[4]=0,e[5]=0,e}function E0(e,r){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=r[0],e[5]=r[1],e}function T0(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function g0(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)}function A0(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e[3]=r[3]+t[3],e[4]=r[4]+t[4],e[5]=r[5]+t[5],e}function ds(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e[3]=r[3]-t[3],e[4]=r[4]-t[4],e[5]=r[5]-t[5],e}function M0(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e[4]=r[4]*t,e[5]=r[5]*t,e}function S0(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e[2]=r[2]+t[2]*n,e[3]=r[3]+t[3]*n,e[4]=r[4]+t[4]*n,e[5]=r[5]+t[5]*n,e}function w0(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]&&e[4]===r[4]&&e[5]===r[5]}function O0(e,r){var t=e[0],n=e[1],a=e[2],i=e[3],c=e[4],s=e[5],o=r[0],d=r[1],_=r[2],O=r[3],T=r[4],w=r[5];return Math.abs(t-o)<=Ge*Math.max(1,Math.abs(t),Math.abs(o))&&Math.abs(n-d)<=Ge*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(a-_)<=Ge*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(i-O)<=Ge*Math.max(1,Math.abs(i),Math.abs(O))&&Math.abs(c-T)<=Ge*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(s-w)<=Ge*Math.max(1,Math.abs(s),Math.abs(w))}var R0=vs,L0=ds,C0=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:c0,clone:l0,copy:o0,identity:u0,fromValues:v0,set:d0,invert:h0,determinant:m0,multiply:vs,rotate:p0,scale:y0,translate:b0,fromRotation:_0,fromScaling:x0,fromTranslation:E0,str:T0,frob:g0,add:A0,subtract:ds,multiplyScalar:M0,multiplyScalarAndAdd:S0,exactEquals:w0,equals:O0,mul:R0,sub:L0});function hs(){var e=new Ye(9);return Ye!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function F0(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[4],e[4]=r[5],e[5]=r[6],e[6]=r[8],e[7]=r[9],e[8]=r[10],e}function G0(e){var r=new Ye(9);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function D0(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e}function P0(e,r,t,n,a,i,c,s,o){var d=new Ye(9);return d[0]=e,d[1]=r,d[2]=t,d[3]=n,d[4]=a,d[5]=i,d[6]=c,d[7]=s,d[8]=o,d}function I0(e,r,t,n,a,i,c,s,o,d){return e[0]=r,e[1]=t,e[2]=n,e[3]=a,e[4]=i,e[5]=c,e[6]=s,e[7]=o,e[8]=d,e}function $0(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function N0(e,r){if(e===r){var t=r[1],n=r[2],a=r[5];e[1]=r[3],e[2]=r[6],e[3]=t,e[5]=r[7],e[6]=n,e[7]=a}else e[0]=r[0],e[1]=r[3],e[2]=r[6],e[3]=r[1],e[4]=r[4],e[5]=r[7],e[6]=r[2],e[7]=r[5],e[8]=r[8];return e}function B0(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],c=r[4],s=r[5],o=r[6],d=r[7],_=r[8],O=_*c-s*d,T=-_*i+s*o,w=d*i-c*o,k=t*O+n*T+a*w;return k?(k=1/k,e[0]=O*k,e[1]=(-_*n+a*d)*k,e[2]=(s*n-a*c)*k,e[3]=T*k,e[4]=(_*t-a*o)*k,e[5]=(-s*t+a*i)*k,e[6]=w*k,e[7]=(-d*t+n*o)*k,e[8]=(c*t-n*i)*k,e):null}function k0(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],c=r[4],s=r[5],o=r[6],d=r[7],_=r[8];return e[0]=c*_-s*d,e[1]=a*d-n*_,e[2]=n*s-a*c,e[3]=s*o-i*_,e[4]=t*_-a*o,e[5]=a*i-t*s,e[6]=i*d-c*o,e[7]=n*o-t*d,e[8]=t*c-n*i,e}function z0(e){var r=e[0],t=e[1],n=e[2],a=e[3],i=e[4],c=e[5],s=e[6],o=e[7],d=e[8];return r*(d*i-c*o)+t*(-d*a+c*s)+n*(o*a-i*s)}function ms(e,r,t){var n=r[0],a=r[1],i=r[2],c=r[3],s=r[4],o=r[5],d=r[6],_=r[7],O=r[8],T=t[0],w=t[1],k=t[2],V=t[3],L=t[4],Z=t[5],pe=t[6],Se=t[7],Oe=t[8];return e[0]=T*n+w*c+k*d,e[1]=T*a+w*s+k*_,e[2]=T*i+w*o+k*O,e[3]=V*n+L*c+Z*d,e[4]=V*a+L*s+Z*_,e[5]=V*i+L*o+Z*O,e[6]=pe*n+Se*c+Oe*d,e[7]=pe*a+Se*s+Oe*_,e[8]=pe*i+Se*o+Oe*O,e}function U0(e,r,t){var n=r[0],a=r[1],i=r[2],c=r[3],s=r[4],o=r[5],d=r[6],_=r[7],O=r[8],T=t[0],w=t[1];return e[0]=n,e[1]=a,e[2]=i,e[3]=c,e[4]=s,e[5]=o,e[6]=T*n+w*c+d,e[7]=T*a+w*s+_,e[8]=T*i+w*o+O,e}function V0(e,r,t){var n=r[0],a=r[1],i=r[2],c=r[3],s=r[4],o=r[5],d=r[6],_=r[7],O=r[8],T=Math.sin(t),w=Math.cos(t);return e[0]=w*n+T*c,e[1]=w*a+T*s,e[2]=w*i+T*o,e[3]=w*c-T*n,e[4]=w*s-T*a,e[5]=w*o-T*i,e[6]=d,e[7]=_,e[8]=O,e}function j0(e,r,t){var n=t[0],a=t[1];return e[0]=n*r[0],e[1]=n*r[1],e[2]=n*r[2],e[3]=a*r[3],e[4]=a*r[4],e[5]=a*r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e}function X0(e,r){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=r[0],e[7]=r[1],e[8]=1,e}function q0(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=n,e[1]=t,e[2]=0,e[3]=-t,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function H0(e,r){return e[0]=r[0],e[1]=0,e[2]=0,e[3]=0,e[4]=r[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Y0(e,r){return e[0]=r[0],e[1]=r[1],e[2]=0,e[3]=r[2],e[4]=r[3],e[5]=0,e[6]=r[4],e[7]=r[5],e[8]=1,e}function W0(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],c=t+t,s=n+n,o=a+a,d=t*c,_=n*c,O=n*s,T=a*c,w=a*s,k=a*o,V=i*c,L=i*s,Z=i*o;return e[0]=1-O-k,e[3]=_-Z,e[6]=T+L,e[1]=_+Z,e[4]=1-d-k,e[7]=w-V,e[2]=T-L,e[5]=w+V,e[8]=1-d-O,e}function Q0(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],c=r[4],s=r[5],o=r[6],d=r[7],_=r[8],O=r[9],T=r[10],w=r[11],k=r[12],V=r[13],L=r[14],Z=r[15],pe=t*s-n*c,Se=t*o-a*c,Oe=t*d-i*c,Ae=n*o-a*s,Re=n*d-i*s,We=a*d-i*o,Qe=_*V-O*k,Je=_*L-T*k,qe=_*Z-w*k,rr=O*L-T*V,Ke=O*Z-w*V,tr=T*Z-w*L,Me=pe*tr-Se*Ke+Oe*rr+Ae*qe-Re*Je+We*Qe;return Me?(Me=1/Me,e[0]=(s*tr-o*Ke+d*rr)*Me,e[1]=(o*qe-c*tr-d*Je)*Me,e[2]=(c*Ke-s*qe+d*Qe)*Me,e[3]=(a*Ke-n*tr-i*rr)*Me,e[4]=(t*tr-a*qe+i*Je)*Me,e[5]=(n*qe-t*Ke-i*Qe)*Me,e[6]=(V*We-L*Re+Z*Ae)*Me,e[7]=(L*Oe-k*We-Z*Se)*Me,e[8]=(k*Re-V*Oe+Z*pe)*Me,e):null}function K0(e,r,t){return e[0]=2/r,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/t,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function Z0(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function J0(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))}function ev(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e[3]=r[3]+t[3],e[4]=r[4]+t[4],e[5]=r[5]+t[5],e[6]=r[6]+t[6],e[7]=r[7]+t[7],e[8]=r[8]+t[8],e}function ps(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e[3]=r[3]-t[3],e[4]=r[4]-t[4],e[5]=r[5]-t[5],e[6]=r[6]-t[6],e[7]=r[7]-t[7],e[8]=r[8]-t[8],e}function rv(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e[4]=r[4]*t,e[5]=r[5]*t,e[6]=r[6]*t,e[7]=r[7]*t,e[8]=r[8]*t,e}function tv(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e[2]=r[2]+t[2]*n,e[3]=r[3]+t[3]*n,e[4]=r[4]+t[4]*n,e[5]=r[5]+t[5]*n,e[6]=r[6]+t[6]*n,e[7]=r[7]+t[7]*n,e[8]=r[8]+t[8]*n,e}function nv(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]&&e[4]===r[4]&&e[5]===r[5]&&e[6]===r[6]&&e[7]===r[7]&&e[8]===r[8]}function av(e,r){var t=e[0],n=e[1],a=e[2],i=e[3],c=e[4],s=e[5],o=e[6],d=e[7],_=e[8],O=r[0],T=r[1],w=r[2],k=r[3],V=r[4],L=r[5],Z=r[6],pe=r[7],Se=r[8];return Math.abs(t-O)<=Ge*Math.max(1,Math.abs(t),Math.abs(O))&&Math.abs(n-T)<=Ge*Math.max(1,Math.abs(n),Math.abs(T))&&Math.abs(a-w)<=Ge*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(i-k)<=Ge*Math.max(1,Math.abs(i),Math.abs(k))&&Math.abs(c-V)<=Ge*Math.max(1,Math.abs(c),Math.abs(V))&&Math.abs(s-L)<=Ge*Math.max(1,Math.abs(s),Math.abs(L))&&Math.abs(o-Z)<=Ge*Math.max(1,Math.abs(o),Math.abs(Z))&&Math.abs(d-pe)<=Ge*Math.max(1,Math.abs(d),Math.abs(pe))&&Math.abs(_-Se)<=Ge*Math.max(1,Math.abs(_),Math.abs(Se))}var iv=ms,fv=ps,sv=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:hs,fromMat4:F0,clone:G0,copy:D0,fromValues:P0,set:I0,identity:$0,transpose:N0,invert:B0,adjoint:k0,determinant:z0,multiply:ms,translate:U0,rotate:V0,scale:j0,fromTranslation:X0,fromRotation:q0,fromScaling:H0,fromMat2d:Y0,fromQuat:W0,normalFromMat4:Q0,projection:K0,str:Z0,frob:J0,add:ev,subtract:ps,multiplyScalar:rv,multiplyScalarAndAdd:tv,exactEquals:nv,equals:av,mul:iv,sub:fv});function cv(){var e=new Ye(16);return Ye!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function lv(e){var r=new Ye(16);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function ov(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function uv(e,r,t,n,a,i,c,s,o,d,_,O,T,w,k,V){var L=new Ye(16);return L[0]=e,L[1]=r,L[2]=t,L[3]=n,L[4]=a,L[5]=i,L[6]=c,L[7]=s,L[8]=o,L[9]=d,L[10]=_,L[11]=O,L[12]=T,L[13]=w,L[14]=k,L[15]=V,L}function vv(e,r,t,n,a,i,c,s,o,d,_,O,T,w,k,V,L){return e[0]=r,e[1]=t,e[2]=n,e[3]=a,e[4]=i,e[5]=c,e[6]=s,e[7]=o,e[8]=d,e[9]=_,e[10]=O,e[11]=T,e[12]=w,e[13]=k,e[14]=V,e[15]=L,e}function ys(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function dv(e,r){if(e===r){var t=r[1],n=r[2],a=r[3],i=r[6],c=r[7],s=r[11];e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=t,e[6]=r[9],e[7]=r[13],e[8]=n,e[9]=i,e[11]=r[14],e[12]=a,e[13]=c,e[14]=s}else e[0]=r[0],e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=r[1],e[5]=r[5],e[6]=r[9],e[7]=r[13],e[8]=r[2],e[9]=r[6],e[10]=r[10],e[11]=r[14],e[12]=r[3],e[13]=r[7],e[14]=r[11],e[15]=r[15];return e}function hv(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],c=r[4],s=r[5],o=r[6],d=r[7],_=r[8],O=r[9],T=r[10],w=r[11],k=r[12],V=r[13],L=r[14],Z=r[15],pe=t*s-n*c,Se=t*o-a*c,Oe=t*d-i*c,Ae=n*o-a*s,Re=n*d-i*s,We=a*d-i*o,Qe=_*V-O*k,Je=_*L-T*k,qe=_*Z-w*k,rr=O*L-T*V,Ke=O*Z-w*V,tr=T*Z-w*L,Me=pe*tr-Se*Ke+Oe*rr+Ae*qe-Re*Je+We*Qe;return Me?(Me=1/Me,e[0]=(s*tr-o*Ke+d*rr)*Me,e[1]=(a*Ke-n*tr-i*rr)*Me,e[2]=(V*We-L*Re+Z*Ae)*Me,e[3]=(T*Re-O*We-w*Ae)*Me,e[4]=(o*qe-c*tr-d*Je)*Me,e[5]=(t*tr-a*qe+i*Je)*Me,e[6]=(L*Oe-k*We-Z*Se)*Me,e[7]=(_*We-T*Oe+w*Se)*Me,e[8]=(c*Ke-s*qe+d*Qe)*Me,e[9]=(n*qe-t*Ke-i*Qe)*Me,e[10]=(k*Re-V*Oe+Z*pe)*Me,e[11]=(O*Oe-_*Re-w*pe)*Me,e[12]=(s*Je-c*rr-o*Qe)*Me,e[13]=(t*rr-n*Je+a*Qe)*Me,e[14]=(V*Se-k*Ae-L*pe)*Me,e[15]=(_*Ae-O*Se+T*pe)*Me,e):null}function mv(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],c=r[4],s=r[5],o=r[6],d=r[7],_=r[8],O=r[9],T=r[10],w=r[11],k=r[12],V=r[13],L=r[14],Z=r[15];return e[0]=s*(T*Z-w*L)-O*(o*Z-d*L)+V*(o*w-d*T),e[1]=-(n*(T*Z-w*L)-O*(a*Z-i*L)+V*(a*w-i*T)),e[2]=n*(o*Z-d*L)-s*(a*Z-i*L)+V*(a*d-i*o),e[3]=-(n*(o*w-d*T)-s*(a*w-i*T)+O*(a*d-i*o)),e[4]=-(c*(T*Z-w*L)-_*(o*Z-d*L)+k*(o*w-d*T)),e[5]=t*(T*Z-w*L)-_*(a*Z-i*L)+k*(a*w-i*T),e[6]=-(t*(o*Z-d*L)-c*(a*Z-i*L)+k*(a*d-i*o)),e[7]=t*(o*w-d*T)-c*(a*w-i*T)+_*(a*d-i*o),e[8]=c*(O*Z-w*V)-_*(s*Z-d*V)+k*(s*w-d*O),e[9]=-(t*(O*Z-w*V)-_*(n*Z-i*V)+k*(n*w-i*O)),e[10]=t*(s*Z-d*V)-c*(n*Z-i*V)+k*(n*d-i*s),e[11]=-(t*(s*w-d*O)-c*(n*w-i*O)+_*(n*d-i*s)),e[12]=-(c*(O*L-T*V)-_*(s*L-o*V)+k*(s*T-o*O)),e[13]=t*(O*L-T*V)-_*(n*L-a*V)+k*(n*T-a*O),e[14]=-(t*(s*L-o*V)-c*(n*L-a*V)+k*(n*o-a*s)),e[15]=t*(s*T-o*O)-c*(n*T-a*O)+_*(n*o-a*s),e}function pv(e){var r=e[0],t=e[1],n=e[2],a=e[3],i=e[4],c=e[5],s=e[6],o=e[7],d=e[8],_=e[9],O=e[10],T=e[11],w=e[12],k=e[13],V=e[14],L=e[15],Z=r*c-t*i,pe=r*s-n*i,Se=r*o-a*i,Oe=t*s-n*c,Ae=t*o-a*c,Re=n*o-a*s,We=d*k-_*w,Qe=d*V-O*w,Je=d*L-T*w,qe=_*V-O*k,rr=_*L-T*k,Ke=O*L-T*V;return Z*Ke-pe*rr+Se*qe+Oe*Je-Ae*Qe+Re*We}function bs(e,r,t){var n=r[0],a=r[1],i=r[2],c=r[3],s=r[4],o=r[5],d=r[6],_=r[7],O=r[8],T=r[9],w=r[10],k=r[11],V=r[12],L=r[13],Z=r[14],pe=r[15],Se=t[0],Oe=t[1],Ae=t[2],Re=t[3];return e[0]=Se*n+Oe*s+Ae*O+Re*V,e[1]=Se*a+Oe*o+Ae*T+Re*L,e[2]=Se*i+Oe*d+Ae*w+Re*Z,e[3]=Se*c+Oe*_+Ae*k+Re*pe,Se=t[4],Oe=t[5],Ae=t[6],Re=t[7],e[4]=Se*n+Oe*s+Ae*O+Re*V,e[5]=Se*a+Oe*o+Ae*T+Re*L,e[6]=Se*i+Oe*d+Ae*w+Re*Z,e[7]=Se*c+Oe*_+Ae*k+Re*pe,Se=t[8],Oe=t[9],Ae=t[10],Re=t[11],e[8]=Se*n+Oe*s+Ae*O+Re*V,e[9]=Se*a+Oe*o+Ae*T+Re*L,e[10]=Se*i+Oe*d+Ae*w+Re*Z,e[11]=Se*c+Oe*_+Ae*k+Re*pe,Se=t[12],Oe=t[13],Ae=t[14],Re=t[15],e[12]=Se*n+Oe*s+Ae*O+Re*V,e[13]=Se*a+Oe*o+Ae*T+Re*L,e[14]=Se*i+Oe*d+Ae*w+Re*Z,e[15]=Se*c+Oe*_+Ae*k+Re*pe,e}function yv(e,r,t){var n=t[0],a=t[1],i=t[2],c=void 0,s=void 0,o=void 0,d=void 0,_=void 0,O=void 0,T=void 0,w=void 0,k=void 0,V=void 0,L=void 0,Z=void 0;return r===e?(e[12]=r[0]*n+r[4]*a+r[8]*i+r[12],e[13]=r[1]*n+r[5]*a+r[9]*i+r[13],e[14]=r[2]*n+r[6]*a+r[10]*i+r[14],e[15]=r[3]*n+r[7]*a+r[11]*i+r[15]):(c=r[0],s=r[1],o=r[2],d=r[3],_=r[4],O=r[5],T=r[6],w=r[7],k=r[8],V=r[9],L=r[10],Z=r[11],e[0]=c,e[1]=s,e[2]=o,e[3]=d,e[4]=_,e[5]=O,e[6]=T,e[7]=w,e[8]=k,e[9]=V,e[10]=L,e[11]=Z,e[12]=c*n+_*a+k*i+r[12],e[13]=s*n+O*a+V*i+r[13],e[14]=o*n+T*a+L*i+r[14],e[15]=d*n+w*a+Z*i+r[15]),e}function bv(e,r,t){var n=t[0],a=t[1],i=t[2];return e[0]=r[0]*n,e[1]=r[1]*n,e[2]=r[2]*n,e[3]=r[3]*n,e[4]=r[4]*a,e[5]=r[5]*a,e[6]=r[6]*a,e[7]=r[7]*a,e[8]=r[8]*i,e[9]=r[9]*i,e[10]=r[10]*i,e[11]=r[11]*i,e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function _v(e,r,t,n){var a=n[0],i=n[1],c=n[2],s=Math.sqrt(a*a+i*i+c*c),o=void 0,d=void 0,_=void 0,O=void 0,T=void 0,w=void 0,k=void 0,V=void 0,L=void 0,Z=void 0,pe=void 0,Se=void 0,Oe=void 0,Ae=void 0,Re=void 0,We=void 0,Qe=void 0,Je=void 0,qe=void 0,rr=void 0,Ke=void 0,tr=void 0,Me=void 0,Tr=void 0;return s<Ge?null:(s=1/s,a*=s,i*=s,c*=s,o=Math.sin(t),d=Math.cos(t),_=1-d,O=r[0],T=r[1],w=r[2],k=r[3],V=r[4],L=r[5],Z=r[6],pe=r[7],Se=r[8],Oe=r[9],Ae=r[10],Re=r[11],We=a*a*_+d,Qe=i*a*_+c*o,Je=c*a*_-i*o,qe=a*i*_-c*o,rr=i*i*_+d,Ke=c*i*_+a*o,tr=a*c*_+i*o,Me=i*c*_-a*o,Tr=c*c*_+d,e[0]=O*We+V*Qe+Se*Je,e[1]=T*We+L*Qe+Oe*Je,e[2]=w*We+Z*Qe+Ae*Je,e[3]=k*We+pe*Qe+Re*Je,e[4]=O*qe+V*rr+Se*Ke,e[5]=T*qe+L*rr+Oe*Ke,e[6]=w*qe+Z*rr+Ae*Ke,e[7]=k*qe+pe*rr+Re*Ke,e[8]=O*tr+V*Me+Se*Tr,e[9]=T*tr+L*Me+Oe*Tr,e[10]=w*tr+Z*Me+Ae*Tr,e[11]=k*tr+pe*Me+Re*Tr,r!==e&&(e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e)}function xv(e,r,t){var n=Math.sin(t),a=Math.cos(t),i=r[4],c=r[5],s=r[6],o=r[7],d=r[8],_=r[9],O=r[10],T=r[11];return r!==e&&(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[4]=i*a+d*n,e[5]=c*a+_*n,e[6]=s*a+O*n,e[7]=o*a+T*n,e[8]=d*a-i*n,e[9]=_*a-c*n,e[10]=O*a-s*n,e[11]=T*a-o*n,e}function Ev(e,r,t){var n=Math.sin(t),a=Math.cos(t),i=r[0],c=r[1],s=r[2],o=r[3],d=r[8],_=r[9],O=r[10],T=r[11];return r!==e&&(e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=i*a-d*n,e[1]=c*a-_*n,e[2]=s*a-O*n,e[3]=o*a-T*n,e[8]=i*n+d*a,e[9]=c*n+_*a,e[10]=s*n+O*a,e[11]=o*n+T*a,e}function Tv(e,r,t){var n=Math.sin(t),a=Math.cos(t),i=r[0],c=r[1],s=r[2],o=r[3],d=r[4],_=r[5],O=r[6],T=r[7];return r!==e&&(e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=i*a+d*n,e[1]=c*a+_*n,e[2]=s*a+O*n,e[3]=o*a+T*n,e[4]=d*a-i*n,e[5]=_*a-c*n,e[6]=O*a-s*n,e[7]=T*a-o*n,e}function gv(e,r){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Av(e,r){return e[0]=r[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=r[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Mv(e,r,t){var n=t[0],a=t[1],i=t[2],c=Math.sqrt(n*n+a*a+i*i),s=void 0,o=void 0,d=void 0;return c<Ge?null:(c=1/c,n*=c,a*=c,i*=c,s=Math.sin(r),o=Math.cos(r),d=1-o,e[0]=n*n*d+o,e[1]=a*n*d+i*s,e[2]=i*n*d-a*s,e[3]=0,e[4]=n*a*d-i*s,e[5]=a*a*d+o,e[6]=i*a*d+n*s,e[7]=0,e[8]=n*i*d+a*s,e[9]=a*i*d-n*s,e[10]=i*i*d+o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function Sv(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=t,e[7]=0,e[8]=0,e[9]=-t,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function wv(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=n,e[1]=0,e[2]=-t,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=t,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ov(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=n,e[1]=t,e[2]=0,e[3]=0,e[4]=-t,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function _s(e,r,t){var n=r[0],a=r[1],i=r[2],c=r[3],s=n+n,o=a+a,d=i+i,_=n*s,O=n*o,T=n*d,w=a*o,k=a*d,V=i*d,L=c*s,Z=c*o,pe=c*d;return e[0]=1-(w+V),e[1]=O+pe,e[2]=T-Z,e[3]=0,e[4]=O-pe,e[5]=1-(_+V),e[6]=k+L,e[7]=0,e[8]=T+Z,e[9]=k-L,e[10]=1-(_+w),e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Rv(e,r){var t=new Ye(3),n=-r[0],a=-r[1],i=-r[2],c=r[3],s=r[4],o=r[5],d=r[6],_=r[7],O=n*n+a*a+i*i+c*c;return O>0?(t[0]=(s*c+_*n+o*i-d*a)*2/O,t[1]=(o*c+_*a+d*n-s*i)*2/O,t[2]=(d*c+_*i+s*a-o*n)*2/O):(t[0]=(s*c+_*n+o*i-d*a)*2,t[1]=(o*c+_*a+d*n-s*i)*2,t[2]=(d*c+_*i+s*a-o*n)*2),_s(e,r,t),e}function xs(e,r){return e[0]=r[12],e[1]=r[13],e[2]=r[14],e}function Lv(e,r){var t=r[0],n=r[1],a=r[2],i=r[4],c=r[5],s=r[6],o=r[8],d=r[9],_=r[10];return e[0]=Math.sqrt(t*t+n*n+a*a),e[1]=Math.sqrt(i*i+c*c+s*s),e[2]=Math.sqrt(o*o+d*d+_*_),e}function Es(e,r){var t=r[0]+r[5]+r[10],n=0;return t>0?(n=Math.sqrt(t+1)*2,e[3]=.25*n,e[0]=(r[6]-r[9])/n,e[1]=(r[8]-r[2])/n,e[2]=(r[1]-r[4])/n):r[0]>r[5]&&r[0]>r[10]?(n=Math.sqrt(1+r[0]-r[5]-r[10])*2,e[3]=(r[6]-r[9])/n,e[0]=.25*n,e[1]=(r[1]+r[4])/n,e[2]=(r[8]+r[2])/n):r[5]>r[10]?(n=Math.sqrt(1+r[5]-r[0]-r[10])*2,e[3]=(r[8]-r[2])/n,e[0]=(r[1]+r[4])/n,e[1]=.25*n,e[2]=(r[6]+r[9])/n):(n=Math.sqrt(1+r[10]-r[0]-r[5])*2,e[3]=(r[1]-r[4])/n,e[0]=(r[8]+r[2])/n,e[1]=(r[6]+r[9])/n,e[2]=.25*n),e}function Cv(e,r,t,n){var a=r[0],i=r[1],c=r[2],s=r[3],o=a+a,d=i+i,_=c+c,O=a*o,T=a*d,w=a*_,k=i*d,V=i*_,L=c*_,Z=s*o,pe=s*d,Se=s*_,Oe=n[0],Ae=n[1],Re=n[2];return e[0]=(1-(k+L))*Oe,e[1]=(T+Se)*Oe,e[2]=(w-pe)*Oe,e[3]=0,e[4]=(T-Se)*Ae,e[5]=(1-(O+L))*Ae,e[6]=(V+Z)*Ae,e[7]=0,e[8]=(w+pe)*Re,e[9]=(V-Z)*Re,e[10]=(1-(O+k))*Re,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Fv(e,r,t,n,a){var i=r[0],c=r[1],s=r[2],o=r[3],d=i+i,_=c+c,O=s+s,T=i*d,w=i*_,k=i*O,V=c*_,L=c*O,Z=s*O,pe=o*d,Se=o*_,Oe=o*O,Ae=n[0],Re=n[1],We=n[2],Qe=a[0],Je=a[1],qe=a[2],rr=(1-(V+Z))*Ae,Ke=(w+Oe)*Ae,tr=(k-Se)*Ae,Me=(w-Oe)*Re,Tr=(1-(T+Z))*Re,Pr=(L+pe)*Re,Ar=(k+Se)*We,rt=(L-pe)*We,bt=(1-(T+V))*We;return e[0]=rr,e[1]=Ke,e[2]=tr,e[3]=0,e[4]=Me,e[5]=Tr,e[6]=Pr,e[7]=0,e[8]=Ar,e[9]=rt,e[10]=bt,e[11]=0,e[12]=t[0]+Qe-(rr*Qe+Me*Je+Ar*qe),e[13]=t[1]+Je-(Ke*Qe+Tr*Je+rt*qe),e[14]=t[2]+qe-(tr*Qe+Pr*Je+bt*qe),e[15]=1,e}function Gv(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],c=t+t,s=n+n,o=a+a,d=t*c,_=n*c,O=n*s,T=a*c,w=a*s,k=a*o,V=i*c,L=i*s,Z=i*o;return e[0]=1-O-k,e[1]=_+Z,e[2]=T-L,e[3]=0,e[4]=_-Z,e[5]=1-d-k,e[6]=w+V,e[7]=0,e[8]=T+L,e[9]=w-V,e[10]=1-d-O,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Dv(e,r,t,n,a,i,c){var s=1/(t-r),o=1/(a-n),d=1/(i-c);return e[0]=i*2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i*2*o,e[6]=0,e[7]=0,e[8]=(t+r)*s,e[9]=(a+n)*o,e[10]=(c+i)*d,e[11]=-1,e[12]=0,e[13]=0,e[14]=c*i*2*d,e[15]=0,e}function Pv(e,r,t,n,a){var i=1/Math.tan(r/2),c=void 0;return e[0]=i/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,a!=null&&a!==1/0?(c=1/(n-a),e[10]=(a+n)*c,e[14]=2*a*n*c):(e[10]=-1,e[14]=-2*n),e}function Iv(e,r,t,n){var a=Math.tan(r.upDegrees*Math.PI/180),i=Math.tan(r.downDegrees*Math.PI/180),c=Math.tan(r.leftDegrees*Math.PI/180),s=Math.tan(r.rightDegrees*Math.PI/180),o=2/(c+s),d=2/(a+i);return e[0]=o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=d,e[6]=0,e[7]=0,e[8]=-((c-s)*o*.5),e[9]=(a-i)*d*.5,e[10]=n/(t-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*t/(t-n),e[15]=0,e}function $v(e,r,t,n,a,i,c){var s=1/(r-t),o=1/(n-a),d=1/(i-c);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*d,e[11]=0,e[12]=(r+t)*s,e[13]=(a+n)*o,e[14]=(c+i)*d,e[15]=1,e}function Nv(e,r,t,n){var a=void 0,i=void 0,c=void 0,s=void 0,o=void 0,d=void 0,_=void 0,O=void 0,T=void 0,w=void 0,k=r[0],V=r[1],L=r[2],Z=n[0],pe=n[1],Se=n[2],Oe=t[0],Ae=t[1],Re=t[2];return Math.abs(k-Oe)<Ge&&Math.abs(V-Ae)<Ge&&Math.abs(L-Re)<Ge?ys(e):(_=k-Oe,O=V-Ae,T=L-Re,w=1/Math.sqrt(_*_+O*O+T*T),_*=w,O*=w,T*=w,a=pe*T-Se*O,i=Se*_-Z*T,c=Z*O-pe*_,w=Math.sqrt(a*a+i*i+c*c),w?(w=1/w,a*=w,i*=w,c*=w):(a=0,i=0,c=0),s=O*c-T*i,o=T*a-_*c,d=_*i-O*a,w=Math.sqrt(s*s+o*o+d*d),w?(w=1/w,s*=w,o*=w,d*=w):(s=0,o=0,d=0),e[0]=a,e[1]=s,e[2]=_,e[3]=0,e[4]=i,e[5]=o,e[6]=O,e[7]=0,e[8]=c,e[9]=d,e[10]=T,e[11]=0,e[12]=-(a*k+i*V+c*L),e[13]=-(s*k+o*V+d*L),e[14]=-(_*k+O*V+T*L),e[15]=1,e)}function Bv(e,r,t,n){var a=r[0],i=r[1],c=r[2],s=n[0],o=n[1],d=n[2],_=a-t[0],O=i-t[1],T=c-t[2],w=_*_+O*O+T*T;w>0&&(w=1/Math.sqrt(w),_*=w,O*=w,T*=w);var k=o*T-d*O,V=d*_-s*T,L=s*O-o*_;return w=k*k+V*V+L*L,w>0&&(w=1/Math.sqrt(w),k*=w,V*=w,L*=w),e[0]=k,e[1]=V,e[2]=L,e[3]=0,e[4]=O*L-T*V,e[5]=T*k-_*L,e[6]=_*V-O*k,e[7]=0,e[8]=_,e[9]=O,e[10]=T,e[11]=0,e[12]=a,e[13]=i,e[14]=c,e[15]=1,e}function kv(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function zv(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))}function Uv(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e[3]=r[3]+t[3],e[4]=r[4]+t[4],e[5]=r[5]+t[5],e[6]=r[6]+t[6],e[7]=r[7]+t[7],e[8]=r[8]+t[8],e[9]=r[9]+t[9],e[10]=r[10]+t[10],e[11]=r[11]+t[11],e[12]=r[12]+t[12],e[13]=r[13]+t[13],e[14]=r[14]+t[14],e[15]=r[15]+t[15],e}function Ts(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e[3]=r[3]-t[3],e[4]=r[4]-t[4],e[5]=r[5]-t[5],e[6]=r[6]-t[6],e[7]=r[7]-t[7],e[8]=r[8]-t[8],e[9]=r[9]-t[9],e[10]=r[10]-t[10],e[11]=r[11]-t[11],e[12]=r[12]-t[12],e[13]=r[13]-t[13],e[14]=r[14]-t[14],e[15]=r[15]-t[15],e}function Vv(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e[4]=r[4]*t,e[5]=r[5]*t,e[6]=r[6]*t,e[7]=r[7]*t,e[8]=r[8]*t,e[9]=r[9]*t,e[10]=r[10]*t,e[11]=r[11]*t,e[12]=r[12]*t,e[13]=r[13]*t,e[14]=r[14]*t,e[15]=r[15]*t,e}function jv(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e[2]=r[2]+t[2]*n,e[3]=r[3]+t[3]*n,e[4]=r[4]+t[4]*n,e[5]=r[5]+t[5]*n,e[6]=r[6]+t[6]*n,e[7]=r[7]+t[7]*n,e[8]=r[8]+t[8]*n,e[9]=r[9]+t[9]*n,e[10]=r[10]+t[10]*n,e[11]=r[11]+t[11]*n,e[12]=r[12]+t[12]*n,e[13]=r[13]+t[13]*n,e[14]=r[14]+t[14]*n,e[15]=r[15]+t[15]*n,e}function Xv(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]&&e[4]===r[4]&&e[5]===r[5]&&e[6]===r[6]&&e[7]===r[7]&&e[8]===r[8]&&e[9]===r[9]&&e[10]===r[10]&&e[11]===r[11]&&e[12]===r[12]&&e[13]===r[13]&&e[14]===r[14]&&e[15]===r[15]}function qv(e,r){var t=e[0],n=e[1],a=e[2],i=e[3],c=e[4],s=e[5],o=e[6],d=e[7],_=e[8],O=e[9],T=e[10],w=e[11],k=e[12],V=e[13],L=e[14],Z=e[15],pe=r[0],Se=r[1],Oe=r[2],Ae=r[3],Re=r[4],We=r[5],Qe=r[6],Je=r[7],qe=r[8],rr=r[9],Ke=r[10],tr=r[11],Me=r[12],Tr=r[13],Pr=r[14],Ar=r[15];return Math.abs(t-pe)<=Ge*Math.max(1,Math.abs(t),Math.abs(pe))&&Math.abs(n-Se)<=Ge*Math.max(1,Math.abs(n),Math.abs(Se))&&Math.abs(a-Oe)<=Ge*Math.max(1,Math.abs(a),Math.abs(Oe))&&Math.abs(i-Ae)<=Ge*Math.max(1,Math.abs(i),Math.abs(Ae))&&Math.abs(c-Re)<=Ge*Math.max(1,Math.abs(c),Math.abs(Re))&&Math.abs(s-We)<=Ge*Math.max(1,Math.abs(s),Math.abs(We))&&Math.abs(o-Qe)<=Ge*Math.max(1,Math.abs(o),Math.abs(Qe))&&Math.abs(d-Je)<=Ge*Math.max(1,Math.abs(d),Math.abs(Je))&&Math.abs(_-qe)<=Ge*Math.max(1,Math.abs(_),Math.abs(qe))&&Math.abs(O-rr)<=Ge*Math.max(1,Math.abs(O),Math.abs(rr))&&Math.abs(T-Ke)<=Ge*Math.max(1,Math.abs(T),Math.abs(Ke))&&Math.abs(w-tr)<=Ge*Math.max(1,Math.abs(w),Math.abs(tr))&&Math.abs(k-Me)<=Ge*Math.max(1,Math.abs(k),Math.abs(Me))&&Math.abs(V-Tr)<=Ge*Math.max(1,Math.abs(V),Math.abs(Tr))&&Math.abs(L-Pr)<=Ge*Math.max(1,Math.abs(L),Math.abs(Pr))&&Math.abs(Z-Ar)<=Ge*Math.max(1,Math.abs(Z),Math.abs(Ar))}var Hv=bs,Yv=Ts,Wv=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:cv,clone:lv,copy:ov,fromValues:uv,set:vv,identity:ys,transpose:dv,invert:hv,adjoint:mv,determinant:pv,multiply:bs,translate:yv,scale:bv,rotate:_v,rotateX:xv,rotateY:Ev,rotateZ:Tv,fromTranslation:gv,fromScaling:Av,fromRotation:Mv,fromXRotation:Sv,fromYRotation:wv,fromZRotation:Ov,fromRotationTranslation:_s,fromQuat2:Rv,getTranslation:xs,getScaling:Lv,getRotation:Es,fromRotationTranslationScale:Cv,fromRotationTranslationScaleOrigin:Fv,fromQuat:Gv,frustum:Dv,perspective:Pv,perspectiveFromFieldOfView:Iv,ortho:$v,lookAt:Nv,targetTo:Bv,str:kv,frob:zv,add:Uv,subtract:Ts,multiplyScalar:Vv,multiplyScalarAndAdd:jv,exactEquals:Xv,equals:qv,mul:Hv,sub:Yv});function ei(){var e=new Ye(3);return Ye!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Qv(e){var r=new Ye(3);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r}function gs(e){var r=e[0],t=e[1],n=e[2];return Math.sqrt(r*r+t*t+n*n)}function an(e,r,t){var n=new Ye(3);return n[0]=e,n[1]=r,n[2]=t,n}function Kv(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function Zv(e,r,t,n){return e[0]=r,e[1]=t,e[2]=n,e}function Jv(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e}function As(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e}function Ms(e,r,t){return e[0]=r[0]*t[0],e[1]=r[1]*t[1],e[2]=r[2]*t[2],e}function Ss(e,r,t){return e[0]=r[0]/t[0],e[1]=r[1]/t[1],e[2]=r[2]/t[2],e}function e1(e,r){return e[0]=Math.ceil(r[0]),e[1]=Math.ceil(r[1]),e[2]=Math.ceil(r[2]),e}function r1(e,r){return e[0]=Math.floor(r[0]),e[1]=Math.floor(r[1]),e[2]=Math.floor(r[2]),e}function t1(e,r,t){return e[0]=Math.min(r[0],t[0]),e[1]=Math.min(r[1],t[1]),e[2]=Math.min(r[2],t[2]),e}function n1(e,r,t){return e[0]=Math.max(r[0],t[0]),e[1]=Math.max(r[1],t[1]),e[2]=Math.max(r[2],t[2]),e}function a1(e,r){return e[0]=Math.round(r[0]),e[1]=Math.round(r[1]),e[2]=Math.round(r[2]),e}function i1(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e}function f1(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e[2]=r[2]+t[2]*n,e}function ws(e,r){var t=r[0]-e[0],n=r[1]-e[1],a=r[2]-e[2];return Math.sqrt(t*t+n*n+a*a)}function Os(e,r){var t=r[0]-e[0],n=r[1]-e[1],a=r[2]-e[2];return t*t+n*n+a*a}function Rs(e){var r=e[0],t=e[1],n=e[2];return r*r+t*t+n*n}function s1(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e}function c1(e,r){return e[0]=1/r[0],e[1]=1/r[1],e[2]=1/r[2],e}function qn(e,r){var t=r[0],n=r[1],a=r[2],i=t*t+n*n+a*a;return i>0&&(i=1/Math.sqrt(i),e[0]=r[0]*i,e[1]=r[1]*i,e[2]=r[2]*i),e}function ri(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]}function Hn(e,r,t){var n=r[0],a=r[1],i=r[2],c=t[0],s=t[1],o=t[2];return e[0]=a*o-i*s,e[1]=i*c-n*o,e[2]=n*s-a*c,e}function l1(e,r,t,n){var a=r[0],i=r[1],c=r[2];return e[0]=a+n*(t[0]-a),e[1]=i+n*(t[1]-i),e[2]=c+n*(t[2]-c),e}function o1(e,r,t,n,a,i){var c=i*i,s=c*(2*i-3)+1,o=c*(i-2)+i,d=c*(i-1),_=c*(3-2*i);return e[0]=r[0]*s+t[0]*o+n[0]*d+a[0]*_,e[1]=r[1]*s+t[1]*o+n[1]*d+a[1]*_,e[2]=r[2]*s+t[2]*o+n[2]*d+a[2]*_,e}function u1(e,r,t,n,a,i){var c=1-i,s=c*c,o=i*i,d=s*c,_=3*i*s,O=3*o*c,T=o*i;return e[0]=r[0]*d+t[0]*_+n[0]*O+a[0]*T,e[1]=r[1]*d+t[1]*_+n[1]*O+a[1]*T,e[2]=r[2]*d+t[2]*_+n[2]*O+a[2]*T,e}function v1(e,r){r=r||1;var t=Br()*2*Math.PI,n=Br()*2-1,a=Math.sqrt(1-n*n)*r;return e[0]=Math.cos(t)*a,e[1]=Math.sin(t)*a,e[2]=n*r,e}function d1(e,r,t){var n=r[0],a=r[1],i=r[2],c=t[3]*n+t[7]*a+t[11]*i+t[15];return c=c||1,e[0]=(t[0]*n+t[4]*a+t[8]*i+t[12])/c,e[1]=(t[1]*n+t[5]*a+t[9]*i+t[13])/c,e[2]=(t[2]*n+t[6]*a+t[10]*i+t[14])/c,e}function h1(e,r,t){var n=r[0],a=r[1],i=r[2];return e[0]=n*t[0]+a*t[3]+i*t[6],e[1]=n*t[1]+a*t[4]+i*t[7],e[2]=n*t[2]+a*t[5]+i*t[8],e}function m1(e,r,t){var n=t[0],a=t[1],i=t[2],c=t[3],s=r[0],o=r[1],d=r[2],_=a*d-i*o,O=i*s-n*d,T=n*o-a*s,w=a*T-i*O,k=i*_-n*T,V=n*O-a*_,L=c*2;return _*=L,O*=L,T*=L,w*=2,k*=2,V*=2,e[0]=s+_+w,e[1]=o+O+k,e[2]=d+T+V,e}function p1(e,r,t,n){var a=[],i=[];return a[0]=r[0]-t[0],a[1]=r[1]-t[1],a[2]=r[2]-t[2],i[0]=a[0],i[1]=a[1]*Math.cos(n)-a[2]*Math.sin(n),i[2]=a[1]*Math.sin(n)+a[2]*Math.cos(n),e[0]=i[0]+t[0],e[1]=i[1]+t[1],e[2]=i[2]+t[2],e}function y1(e,r,t,n){var a=[],i=[];return a[0]=r[0]-t[0],a[1]=r[1]-t[1],a[2]=r[2]-t[2],i[0]=a[2]*Math.sin(n)+a[0]*Math.cos(n),i[1]=a[1],i[2]=a[2]*Math.cos(n)-a[0]*Math.sin(n),e[0]=i[0]+t[0],e[1]=i[1]+t[1],e[2]=i[2]+t[2],e}function b1(e,r,t,n){var a=[],i=[];return a[0]=r[0]-t[0],a[1]=r[1]-t[1],a[2]=r[2]-t[2],i[0]=a[0]*Math.cos(n)-a[1]*Math.sin(n),i[1]=a[0]*Math.sin(n)+a[1]*Math.cos(n),i[2]=a[2],e[0]=i[0]+t[0],e[1]=i[1]+t[1],e[2]=i[2]+t[2],e}function _1(e,r){var t=an(e[0],e[1],e[2]),n=an(r[0],r[1],r[2]);qn(t,t),qn(n,n);var a=ri(t,n);return a>1?0:a<-1?Math.PI:Math.acos(a)}function x1(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function E1(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]}function T1(e,r){var t=e[0],n=e[1],a=e[2],i=r[0],c=r[1],s=r[2];return Math.abs(t-i)<=Ge*Math.max(1,Math.abs(t),Math.abs(i))&&Math.abs(n-c)<=Ge*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(a-s)<=Ge*Math.max(1,Math.abs(a),Math.abs(s))}var g1=As,A1=Ms,M1=Ss,S1=ws,w1=Os,Ls=gs,O1=Rs,R1=function(){var e=ei();return function(r,t,n,a,i,c){var s=void 0,o=void 0;for(t||(t=3),n||(n=0),a?o=Math.min(a*t+n,r.length):o=r.length,s=n;s<o;s+=t)e[0]=r[s],e[1]=r[s+1],e[2]=r[s+2],i(e,e,c),r[s]=e[0],r[s+1]=e[1],r[s+2]=e[2];return r}}(),L1=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:ei,clone:Qv,length:gs,fromValues:an,copy:Kv,set:Zv,add:Jv,subtract:As,multiply:Ms,divide:Ss,ceil:e1,floor:r1,min:t1,max:n1,round:a1,scale:i1,scaleAndAdd:f1,distance:ws,squaredDistance:Os,squaredLength:Rs,negate:s1,inverse:c1,normalize:qn,dot:ri,cross:Hn,lerp:l1,hermite:o1,bezier:u1,random:v1,transformMat4:d1,transformMat3:h1,transformQuat:m1,rotateX:p1,rotateY:y1,rotateZ:b1,angle:_1,str:x1,exactEquals:E1,equals:T1,sub:g1,mul:A1,div:M1,dist:S1,sqrDist:w1,len:Ls,sqrLen:O1,forEach:R1});function Cs(){var e=new Ye(4);return Ye!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Fs(e){var r=new Ye(4);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}function Gs(e,r,t,n){var a=new Ye(4);return a[0]=e,a[1]=r,a[2]=t,a[3]=n,a}function Ds(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function Ps(e,r,t,n,a){return e[0]=r,e[1]=t,e[2]=n,e[3]=a,e}function Is(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e[3]=r[3]+t[3],e}function $s(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e[3]=r[3]-t[3],e}function Ns(e,r,t){return e[0]=r[0]*t[0],e[1]=r[1]*t[1],e[2]=r[2]*t[2],e[3]=r[3]*t[3],e}function Bs(e,r,t){return e[0]=r[0]/t[0],e[1]=r[1]/t[1],e[2]=r[2]/t[2],e[3]=r[3]/t[3],e}function C1(e,r){return e[0]=Math.ceil(r[0]),e[1]=Math.ceil(r[1]),e[2]=Math.ceil(r[2]),e[3]=Math.ceil(r[3]),e}function F1(e,r){return e[0]=Math.floor(r[0]),e[1]=Math.floor(r[1]),e[2]=Math.floor(r[2]),e[3]=Math.floor(r[3]),e}function G1(e,r,t){return e[0]=Math.min(r[0],t[0]),e[1]=Math.min(r[1],t[1]),e[2]=Math.min(r[2],t[2]),e[3]=Math.min(r[3],t[3]),e}function D1(e,r,t){return e[0]=Math.max(r[0],t[0]),e[1]=Math.max(r[1],t[1]),e[2]=Math.max(r[2],t[2]),e[3]=Math.max(r[3],t[3]),e}function P1(e,r){return e[0]=Math.round(r[0]),e[1]=Math.round(r[1]),e[2]=Math.round(r[2]),e[3]=Math.round(r[3]),e}function ks(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e}function I1(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e[2]=r[2]+t[2]*n,e[3]=r[3]+t[3]*n,e}function zs(e,r){var t=r[0]-e[0],n=r[1]-e[1],a=r[2]-e[2],i=r[3]-e[3];return Math.sqrt(t*t+n*n+a*a+i*i)}function Us(e,r){var t=r[0]-e[0],n=r[1]-e[1],a=r[2]-e[2],i=r[3]-e[3];return t*t+n*n+a*a+i*i}function ti(e){var r=e[0],t=e[1],n=e[2],a=e[3];return Math.sqrt(r*r+t*t+n*n+a*a)}function ni(e){var r=e[0],t=e[1],n=e[2],a=e[3];return r*r+t*t+n*n+a*a}function $1(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e[3]=-r[3],e}function N1(e,r){return e[0]=1/r[0],e[1]=1/r[1],e[2]=1/r[2],e[3]=1/r[3],e}function Vs(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],c=t*t+n*n+a*a+i*i;return c>0&&(c=1/Math.sqrt(c),e[0]=t*c,e[1]=n*c,e[2]=a*c,e[3]=i*c),e}function js(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]+e[3]*r[3]}function Xs(e,r,t,n){var a=r[0],i=r[1],c=r[2],s=r[3];return e[0]=a+n*(t[0]-a),e[1]=i+n*(t[1]-i),e[2]=c+n*(t[2]-c),e[3]=s+n*(t[3]-s),e}function B1(e,r){r=r||1;var t,n,a,i,c,s;do t=Br()*2-1,n=Br()*2-1,c=t*t+n*n;while(c>=1);do a=Br()*2-1,i=Br()*2-1,s=a*a+i*i;while(s>=1);var o=Math.sqrt((1-c)/s);return e[0]=r*t,e[1]=r*n,e[2]=r*a*o,e[3]=r*i*o,e}function k1(e,r,t){var n=r[0],a=r[1],i=r[2],c=r[3];return e[0]=t[0]*n+t[4]*a+t[8]*i+t[12]*c,e[1]=t[1]*n+t[5]*a+t[9]*i+t[13]*c,e[2]=t[2]*n+t[6]*a+t[10]*i+t[14]*c,e[3]=t[3]*n+t[7]*a+t[11]*i+t[15]*c,e}function z1(e,r,t){var n=r[0],a=r[1],i=r[2],c=t[0],s=t[1],o=t[2],d=t[3],_=d*n+s*i-o*a,O=d*a+o*n-c*i,T=d*i+c*a-s*n,w=-c*n-s*a-o*i;return e[0]=_*d+w*-c+O*-o-T*-s,e[1]=O*d+w*-s+T*-c-_*-o,e[2]=T*d+w*-o+_*-s-O*-c,e[3]=r[3],e}function U1(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function qs(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]}function Hs(e,r){var t=e[0],n=e[1],a=e[2],i=e[3],c=r[0],s=r[1],o=r[2],d=r[3];return Math.abs(t-c)<=Ge*Math.max(1,Math.abs(t),Math.abs(c))&&Math.abs(n-s)<=Ge*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-o)<=Ge*Math.max(1,Math.abs(a),Math.abs(o))&&Math.abs(i-d)<=Ge*Math.max(1,Math.abs(i),Math.abs(d))}var V1=$s,j1=Ns,X1=Bs,q1=zs,H1=Us,Y1=ti,W1=ni,Q1=function(){var e=Cs();return function(r,t,n,a,i,c){var s=void 0,o=void 0;for(t||(t=4),n||(n=0),a?o=Math.min(a*t+n,r.length):o=r.length,s=n;s<o;s+=t)e[0]=r[s],e[1]=r[s+1],e[2]=r[s+2],e[3]=r[s+3],i(e,e,c),r[s]=e[0],r[s+1]=e[1],r[s+2]=e[2],r[s+3]=e[3];return r}}(),K1=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:Cs,clone:Fs,fromValues:Gs,copy:Ds,set:Ps,add:Is,subtract:$s,multiply:Ns,divide:Bs,ceil:C1,floor:F1,min:G1,max:D1,round:P1,scale:ks,scaleAndAdd:I1,distance:zs,squaredDistance:Us,length:ti,squaredLength:ni,negate:$1,inverse:N1,normalize:Vs,dot:js,lerp:Xs,random:B1,transformMat4:k1,transformQuat:z1,str:U1,exactEquals:qs,equals:Hs,sub:V1,mul:j1,div:X1,dist:q1,sqrDist:H1,len:Y1,sqrLen:W1,forEach:Q1});function Yn(){var e=new Ye(4);return Ye!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Z1(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Ys(e,r,t){t=t*.5;var n=Math.sin(t);return e[0]=n*r[0],e[1]=n*r[1],e[2]=n*r[2],e[3]=Math.cos(t),e}function J1(e,r){var t=Math.acos(r[3])*2,n=Math.sin(t/2);return n>Ge?(e[0]=r[0]/n,e[1]=r[1]/n,e[2]=r[2]/n):(e[0]=1,e[1]=0,e[2]=0),t}function Ws(e,r,t){var n=r[0],a=r[1],i=r[2],c=r[3],s=t[0],o=t[1],d=t[2],_=t[3];return e[0]=n*_+c*s+a*d-i*o,e[1]=a*_+c*o+i*s-n*d,e[2]=i*_+c*d+n*o-a*s,e[3]=c*_-n*s-a*o-i*d,e}function Qs(e,r,t){t*=.5;var n=r[0],a=r[1],i=r[2],c=r[3],s=Math.sin(t),o=Math.cos(t);return e[0]=n*o+c*s,e[1]=a*o+i*s,e[2]=i*o-a*s,e[3]=c*o-n*s,e}function Ks(e,r,t){t*=.5;var n=r[0],a=r[1],i=r[2],c=r[3],s=Math.sin(t),o=Math.cos(t);return e[0]=n*o-i*s,e[1]=a*o+c*s,e[2]=i*o+n*s,e[3]=c*o-a*s,e}function Zs(e,r,t){t*=.5;var n=r[0],a=r[1],i=r[2],c=r[3],s=Math.sin(t),o=Math.cos(t);return e[0]=n*o+a*s,e[1]=a*o-n*s,e[2]=i*o+c*s,e[3]=c*o-i*s,e}function ed(e,r){var t=r[0],n=r[1],a=r[2];return e[0]=t,e[1]=n,e[2]=a,e[3]=Math.sqrt(Math.abs(1-t*t-n*n-a*a)),e}function Wn(e,r,t,n){var a=r[0],i=r[1],c=r[2],s=r[3],o=t[0],d=t[1],_=t[2],O=t[3],T=void 0,w=void 0,k=void 0,V=void 0,L=void 0;return w=a*o+i*d+c*_+s*O,w<0&&(w=-w,o=-o,d=-d,_=-_,O=-O),1-w>Ge?(T=Math.acos(w),k=Math.sin(T),V=Math.sin((1-n)*T)/k,L=Math.sin(n*T)/k):(V=1-n,L=n),e[0]=V*a+L*o,e[1]=V*i+L*d,e[2]=V*c+L*_,e[3]=V*s+L*O,e}function rd(e){var r=Br(),t=Br(),n=Br(),a=Math.sqrt(1-r),i=Math.sqrt(r);return e[0]=a*Math.sin(2*Math.PI*t),e[1]=a*Math.cos(2*Math.PI*t),e[2]=i*Math.sin(2*Math.PI*n),e[3]=i*Math.cos(2*Math.PI*n),e}function td(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],c=t*t+n*n+a*a+i*i,s=c?1/c:0;return e[0]=-t*s,e[1]=-n*s,e[2]=-a*s,e[3]=i*s,e}function nd(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e[3]=r[3],e}function Js(e,r){var t=r[0]+r[4]+r[8],n=void 0;if(t>0)n=Math.sqrt(t+1),e[3]=.5*n,n=.5/n,e[0]=(r[5]-r[7])*n,e[1]=(r[6]-r[2])*n,e[2]=(r[1]-r[3])*n;else{var a=0;r[4]>r[0]&&(a=1),r[8]>r[a*3+a]&&(a=2);var i=(a+1)%3,c=(a+2)%3;n=Math.sqrt(r[a*3+a]-r[i*3+i]-r[c*3+c]+1),e[a]=.5*n,n=.5/n,e[3]=(r[i*3+c]-r[c*3+i])*n,e[i]=(r[i*3+a]+r[a*3+i])*n,e[c]=(r[c*3+a]+r[a*3+c])*n}return e}function ad(e,r,t,n){var a=.5*Math.PI/180;r*=a,t*=a,n*=a;var i=Math.sin(r),c=Math.cos(r),s=Math.sin(t),o=Math.cos(t),d=Math.sin(n),_=Math.cos(n);return e[0]=i*o*_-c*s*d,e[1]=c*s*_+i*o*d,e[2]=c*o*d-i*s*_,e[3]=c*o*_+i*s*d,e}function id(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var fd=Fs,sd=Gs,ai=Ds,cd=Ps,ld=Is,od=Ws,ud=ks,ec=js,vd=Xs,ii=ti,dd=ii,fi=ni,hd=fi,si=Vs,md=qs,pd=Hs,yd=function(){var e=ei(),r=an(1,0,0),t=an(0,1,0);return function(n,a,i){var c=ri(a,i);return c<-.999999?(Hn(e,r,a),Ls(e)<1e-6&&Hn(e,t,a),qn(e,e),Ys(n,e,Math.PI),n):c>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(Hn(e,a,i),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+c,si(n,n))}}(),bd=function(){var e=Yn(),r=Yn();return function(t,n,a,i,c,s){return Wn(e,n,c,s),Wn(r,a,i,s),Wn(t,e,r,2*s*(1-s)),t}}(),_d=function(){var e=hs();return function(r,t,n,a){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=a[0],e[4]=a[1],e[7]=a[2],e[2]=-t[0],e[5]=-t[1],e[8]=-t[2],si(r,Js(r,e))}}(),xd=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:Yn,identity:Z1,setAxisAngle:Ys,getAxisAngle:J1,multiply:Ws,rotateX:Qs,rotateY:Ks,rotateZ:Zs,calculateW:ed,slerp:Wn,random:rd,invert:td,conjugate:nd,fromMat3:Js,fromEuler:ad,str:id,clone:fd,fromValues:sd,copy:ai,set:cd,add:ld,mul:od,scale:ud,dot:ec,lerp:vd,length:ii,len:dd,squaredLength:fi,sqrLen:hd,normalize:si,exactEquals:md,equals:pd,rotationTo:yd,sqlerp:bd,setAxes:_d});function Ed(){var e=new Ye(8);return Ye!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e}function Td(e){var r=new Ye(8);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r}function gd(e,r,t,n,a,i,c,s){var o=new Ye(8);return o[0]=e,o[1]=r,o[2]=t,o[3]=n,o[4]=a,o[5]=i,o[6]=c,o[7]=s,o}function Ad(e,r,t,n,a,i,c){var s=new Ye(8);s[0]=e,s[1]=r,s[2]=t,s[3]=n;var o=a*.5,d=i*.5,_=c*.5;return s[4]=o*n+d*t-_*r,s[5]=d*n+_*e-o*t,s[6]=_*n+o*r-d*e,s[7]=-o*e-d*r-_*t,s}function rc(e,r,t){var n=t[0]*.5,a=t[1]*.5,i=t[2]*.5,c=r[0],s=r[1],o=r[2],d=r[3];return e[0]=c,e[1]=s,e[2]=o,e[3]=d,e[4]=n*d+a*o-i*s,e[5]=a*d+i*c-n*o,e[6]=i*d+n*s-a*c,e[7]=-n*c-a*s-i*o,e}function Md(e,r){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=r[0]*.5,e[5]=r[1]*.5,e[6]=r[2]*.5,e[7]=0,e}function Sd(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function wd(e,r){var t=Yn();Es(t,r);var n=new Ye(3);return xs(n,r),rc(e,t,n),e}function tc(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e}function Od(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function Rd(e,r,t,n,a,i,c,s,o){return e[0]=r,e[1]=t,e[2]=n,e[3]=a,e[4]=i,e[5]=c,e[6]=s,e[7]=o,e}var Ld=ai;function Cd(e,r){return e[0]=r[4],e[1]=r[5],e[2]=r[6],e[3]=r[7],e}var Fd=ai;function Gd(e,r){return e[4]=r[0],e[5]=r[1],e[6]=r[2],e[7]=r[3],e}function Dd(e,r){var t=r[4],n=r[5],a=r[6],i=r[7],c=-r[0],s=-r[1],o=-r[2],d=r[3];return e[0]=(t*d+i*c+n*o-a*s)*2,e[1]=(n*d+i*s+a*c-t*o)*2,e[2]=(a*d+i*o+t*s-n*c)*2,e}function Pd(e,r,t){var n=r[0],a=r[1],i=r[2],c=r[3],s=t[0]*.5,o=t[1]*.5,d=t[2]*.5,_=r[4],O=r[5],T=r[6],w=r[7];return e[0]=n,e[1]=a,e[2]=i,e[3]=c,e[4]=c*s+a*d-i*o+_,e[5]=c*o+i*s-n*d+O,e[6]=c*d+n*o-a*s+T,e[7]=-n*s-a*o-i*d+w,e}function Id(e,r,t){var n=-r[0],a=-r[1],i=-r[2],c=r[3],s=r[4],o=r[5],d=r[6],_=r[7],O=s*c+_*n+o*i-d*a,T=o*c+_*a+d*n-s*i,w=d*c+_*i+s*a-o*n,k=_*c-s*n-o*a-d*i;return Qs(e,r,t),n=e[0],a=e[1],i=e[2],c=e[3],e[4]=O*c+k*n+T*i-w*a,e[5]=T*c+k*a+w*n-O*i,e[6]=w*c+k*i+O*a-T*n,e[7]=k*c-O*n-T*a-w*i,e}function $d(e,r,t){var n=-r[0],a=-r[1],i=-r[2],c=r[3],s=r[4],o=r[5],d=r[6],_=r[7],O=s*c+_*n+o*i-d*a,T=o*c+_*a+d*n-s*i,w=d*c+_*i+s*a-o*n,k=_*c-s*n-o*a-d*i;return Ks(e,r,t),n=e[0],a=e[1],i=e[2],c=e[3],e[4]=O*c+k*n+T*i-w*a,e[5]=T*c+k*a+w*n-O*i,e[6]=w*c+k*i+O*a-T*n,e[7]=k*c-O*n-T*a-w*i,e}function Nd(e,r,t){var n=-r[0],a=-r[1],i=-r[2],c=r[3],s=r[4],o=r[5],d=r[6],_=r[7],O=s*c+_*n+o*i-d*a,T=o*c+_*a+d*n-s*i,w=d*c+_*i+s*a-o*n,k=_*c-s*n-o*a-d*i;return Zs(e,r,t),n=e[0],a=e[1],i=e[2],c=e[3],e[4]=O*c+k*n+T*i-w*a,e[5]=T*c+k*a+w*n-O*i,e[6]=w*c+k*i+O*a-T*n,e[7]=k*c-O*n-T*a-w*i,e}function Bd(e,r,t){var n=t[0],a=t[1],i=t[2],c=t[3],s=r[0],o=r[1],d=r[2],_=r[3];return e[0]=s*c+_*n+o*i-d*a,e[1]=o*c+_*a+d*n-s*i,e[2]=d*c+_*i+s*a-o*n,e[3]=_*c-s*n-o*a-d*i,s=r[4],o=r[5],d=r[6],_=r[7],e[4]=s*c+_*n+o*i-d*a,e[5]=o*c+_*a+d*n-s*i,e[6]=d*c+_*i+s*a-o*n,e[7]=_*c-s*n-o*a-d*i,e}function kd(e,r,t){var n=r[0],a=r[1],i=r[2],c=r[3],s=t[0],o=t[1],d=t[2],_=t[3];return e[0]=n*_+c*s+a*d-i*o,e[1]=a*_+c*o+i*s-n*d,e[2]=i*_+c*d+n*o-a*s,e[3]=c*_-n*s-a*o-i*d,s=t[4],o=t[5],d=t[6],_=t[7],e[4]=n*_+c*s+a*d-i*o,e[5]=a*_+c*o+i*s-n*d,e[6]=i*_+c*d+n*o-a*s,e[7]=c*_-n*s-a*o-i*d,e}function zd(e,r,t,n){if(Math.abs(n)<Ge)return tc(e,r);var a=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);n=n*.5;var i=Math.sin(n),c=i*t[0]/a,s=i*t[1]/a,o=i*t[2]/a,d=Math.cos(n),_=r[0],O=r[1],T=r[2],w=r[3];e[0]=_*d+w*c+O*o-T*s,e[1]=O*d+w*s+T*c-_*o,e[2]=T*d+w*o+_*s-O*c,e[3]=w*d-_*c-O*s-T*o;var k=r[4],V=r[5],L=r[6],Z=r[7];return e[4]=k*d+Z*c+V*o-L*s,e[5]=V*d+Z*s+L*c-k*o,e[6]=L*d+Z*o+k*s-V*c,e[7]=Z*d-k*c-V*s-L*o,e}function Ud(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e[3]=r[3]+t[3],e[4]=r[4]+t[4],e[5]=r[5]+t[5],e[6]=r[6]+t[6],e[7]=r[7]+t[7],e}function nc(e,r,t){var n=r[0],a=r[1],i=r[2],c=r[3],s=t[4],o=t[5],d=t[6],_=t[7],O=r[4],T=r[5],w=r[6],k=r[7],V=t[0],L=t[1],Z=t[2],pe=t[3];return e[0]=n*pe+c*V+a*Z-i*L,e[1]=a*pe+c*L+i*V-n*Z,e[2]=i*pe+c*Z+n*L-a*V,e[3]=c*pe-n*V-a*L-i*Z,e[4]=n*_+c*s+a*d-i*o+O*pe+k*V+T*Z-w*L,e[5]=a*_+c*o+i*s-n*d+T*pe+k*L+w*V-O*Z,e[6]=i*_+c*d+n*o-a*s+w*pe+k*Z+O*L-T*V,e[7]=c*_-n*s-a*o-i*d+k*pe-O*V-T*L-w*Z,e}var Vd=nc;function jd(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e[4]=r[4]*t,e[5]=r[5]*t,e[6]=r[6]*t,e[7]=r[7]*t,e}var ac=ec;function Xd(e,r,t,n){var a=1-n;return ac(r,t)<0&&(n=-n),e[0]=r[0]*a+t[0]*n,e[1]=r[1]*a+t[1]*n,e[2]=r[2]*a+t[2]*n,e[3]=r[3]*a+t[3]*n,e[4]=r[4]*a+t[4]*n,e[5]=r[5]*a+t[5]*n,e[6]=r[6]*a+t[6]*n,e[7]=r[7]*a+t[7]*n,e}function qd(e,r){var t=Qn(r);return e[0]=-r[0]/t,e[1]=-r[1]/t,e[2]=-r[2]/t,e[3]=r[3]/t,e[4]=-r[4]/t,e[5]=-r[5]/t,e[6]=-r[6]/t,e[7]=r[7]/t,e}function Hd(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e[3]=r[3],e[4]=-r[4],e[5]=-r[5],e[6]=-r[6],e[7]=r[7],e}var ic=ii,Yd=ic,Qn=fi,Wd=Qn;function Qd(e,r){var t=Qn(r);if(t>0){t=Math.sqrt(t);var n=r[0]/t,a=r[1]/t,i=r[2]/t,c=r[3]/t,s=r[4],o=r[5],d=r[6],_=r[7],O=n*s+a*o+i*d+c*_;e[0]=n,e[1]=a,e[2]=i,e[3]=c,e[4]=(s-n*O)/t,e[5]=(o-a*O)/t,e[6]=(d-i*O)/t,e[7]=(_-c*O)/t}return e}function Kd(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"}function Zd(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]&&e[4]===r[4]&&e[5]===r[5]&&e[6]===r[6]&&e[7]===r[7]}function Jd(e,r){var t=e[0],n=e[1],a=e[2],i=e[3],c=e[4],s=e[5],o=e[6],d=e[7],_=r[0],O=r[1],T=r[2],w=r[3],k=r[4],V=r[5],L=r[6],Z=r[7];return Math.abs(t-_)<=Ge*Math.max(1,Math.abs(t),Math.abs(_))&&Math.abs(n-O)<=Ge*Math.max(1,Math.abs(n),Math.abs(O))&&Math.abs(a-T)<=Ge*Math.max(1,Math.abs(a),Math.abs(T))&&Math.abs(i-w)<=Ge*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(c-k)<=Ge*Math.max(1,Math.abs(c),Math.abs(k))&&Math.abs(s-V)<=Ge*Math.max(1,Math.abs(s),Math.abs(V))&&Math.abs(o-L)<=Ge*Math.max(1,Math.abs(o),Math.abs(L))&&Math.abs(d-Z)<=Ge*Math.max(1,Math.abs(d),Math.abs(Z))}var eh=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:Ed,clone:Td,fromValues:gd,fromRotationTranslationValues:Ad,fromRotationTranslation:rc,fromTranslation:Md,fromRotation:Sd,fromMat4:wd,copy:tc,identity:Od,set:Rd,getReal:Ld,getDual:Cd,setReal:Fd,setDual:Gd,getTranslation:Dd,translate:Pd,rotateX:Id,rotateY:$d,rotateZ:Nd,rotateByQuatAppend:Bd,rotateByQuatPrepend:kd,rotateAroundAxis:zd,add:Ud,multiply:nc,mul:Vd,scale:jd,dot:ac,lerp:Xd,invert:qd,conjugate:Hd,length:ic,len:Yd,squaredLength:Qn,sqrLen:Wd,normalize:Qd,str:Kd,exactEquals:Zd,equals:Jd});function fc(){var e=new Ye(2);return Ye!=Float32Array&&(e[0]=0,e[1]=0),e}function rh(e){var r=new Ye(2);return r[0]=e[0],r[1]=e[1],r}function th(e,r){var t=new Ye(2);return t[0]=e,t[1]=r,t}function nh(e,r){return e[0]=r[0],e[1]=r[1],e}function ah(e,r,t){return e[0]=r,e[1]=t,e}function ih(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e}function sc(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e}function cc(e,r,t){return e[0]=r[0]*t[0],e[1]=r[1]*t[1],e}function lc(e,r,t){return e[0]=r[0]/t[0],e[1]=r[1]/t[1],e}function fh(e,r){return e[0]=Math.ceil(r[0]),e[1]=Math.ceil(r[1]),e}function sh(e,r){return e[0]=Math.floor(r[0]),e[1]=Math.floor(r[1]),e}function ch(e,r,t){return e[0]=Math.min(r[0],t[0]),e[1]=Math.min(r[1],t[1]),e}function lh(e,r,t){return e[0]=Math.max(r[0],t[0]),e[1]=Math.max(r[1],t[1]),e}function oh(e,r){return e[0]=Math.round(r[0]),e[1]=Math.round(r[1]),e}function uh(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e}function vh(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e}function oc(e,r){var t=r[0]-e[0],n=r[1]-e[1];return Math.sqrt(t*t+n*n)}function uc(e,r){var t=r[0]-e[0],n=r[1]-e[1];return t*t+n*n}function vc(e){var r=e[0],t=e[1];return Math.sqrt(r*r+t*t)}function dc(e){var r=e[0],t=e[1];return r*r+t*t}function dh(e,r){return e[0]=-r[0],e[1]=-r[1],e}function hh(e,r){return e[0]=1/r[0],e[1]=1/r[1],e}function mh(e,r){var t=r[0],n=r[1],a=t*t+n*n;return a>0&&(a=1/Math.sqrt(a),e[0]=r[0]*a,e[1]=r[1]*a),e}function ph(e,r){return e[0]*r[0]+e[1]*r[1]}function yh(e,r,t){var n=r[0]*t[1]-r[1]*t[0];return e[0]=e[1]=0,e[2]=n,e}function bh(e,r,t,n){var a=r[0],i=r[1];return e[0]=a+n*(t[0]-a),e[1]=i+n*(t[1]-i),e}function _h(e,r){r=r||1;var t=Br()*2*Math.PI;return e[0]=Math.cos(t)*r,e[1]=Math.sin(t)*r,e}function xh(e,r,t){var n=r[0],a=r[1];return e[0]=t[0]*n+t[2]*a,e[1]=t[1]*n+t[3]*a,e}function Eh(e,r,t){var n=r[0],a=r[1];return e[0]=t[0]*n+t[2]*a+t[4],e[1]=t[1]*n+t[3]*a+t[5],e}function Th(e,r,t){var n=r[0],a=r[1];return e[0]=t[0]*n+t[3]*a+t[6],e[1]=t[1]*n+t[4]*a+t[7],e}function gh(e,r,t){var n=r[0],a=r[1];return e[0]=t[0]*n+t[4]*a+t[12],e[1]=t[1]*n+t[5]*a+t[13],e}function Ah(e,r,t,n){var a=r[0]-t[0],i=r[1]-t[1],c=Math.sin(n),s=Math.cos(n);return e[0]=a*s-i*c+t[0],e[1]=a*c+i*s+t[1],e}function Mh(e,r){var t=e[0],n=e[1],a=r[0],i=r[1],c=t*t+n*n;c>0&&(c=1/Math.sqrt(c));var s=a*a+i*i;s>0&&(s=1/Math.sqrt(s));var o=(t*a+n*i)*c*s;return o>1?0:o<-1?Math.PI:Math.acos(o)}function Sh(e){return"vec2("+e[0]+", "+e[1]+")"}function wh(e,r){return e[0]===r[0]&&e[1]===r[1]}function Oh(e,r){var t=e[0],n=e[1],a=r[0],i=r[1];return Math.abs(t-a)<=Ge*Math.max(1,Math.abs(t),Math.abs(a))&&Math.abs(n-i)<=Ge*Math.max(1,Math.abs(n),Math.abs(i))}var Rh=vc,Lh=sc,Ch=cc,Fh=lc,Gh=oc,Dh=uc,Ph=dc,Ih=function(){var e=fc();return function(r,t,n,a,i,c){var s=void 0,o=void 0;for(t||(t=2),n||(n=0),a?o=Math.min(a*t+n,r.length):o=r.length,s=n;s<o;s+=t)e[0]=r[s],e[1]=r[s+1],i(e,e,c),r[s]=e[0],r[s+1]=e[1];return r}}(),$h=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:fc,clone:rh,fromValues:th,copy:nh,set:ah,add:ih,subtract:sc,multiply:cc,divide:lc,ceil:fh,floor:sh,min:ch,max:lh,round:oh,scale:uh,scaleAndAdd:vh,distance:oc,squaredDistance:uc,length:vc,squaredLength:dc,negate:dh,inverse:hh,normalize:mh,dot:ph,cross:yh,lerp:bh,random:_h,transformMat2:xh,transformMat2d:Eh,transformMat3:Th,transformMat4:gh,rotate:Ah,angle:Mh,str:Sh,exactEquals:wh,equals:Oh,len:Rh,sub:Lh,mul:Ch,div:Fh,dist:Gh,sqrDist:Dh,sqrLen:Ph,forEach:Ih}),Nh=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",glMatrix:Iu,mat2:s0,mat2d:C0,mat3:sv,mat4:Wv,quat:xd,quat2:eh,vec2:$h,vec3:L1,vec4:K1}),Bh=Lu(Nh),hc={exports:{}};(function(e){var r=function(){function t(o,d,_,O){typeof d=="object"&&(_=d.depth,O=d.prototype,d=d.circular);var T=[],w=[],k=typeof Buffer!="undefined";typeof d=="undefined"&&(d=!0),typeof _=="undefined"&&(_=1/0);function V(L,Z){if(L===null)return null;if(Z==0)return L;var pe,Se;if(typeof L!="object")return L;if(t.__isArray(L))pe=[];else if(t.__isRegExp(L))pe=new RegExp(L.source,s(L)),L.lastIndex&&(pe.lastIndex=L.lastIndex);else if(t.__isDate(L))pe=new Date(L.getTime());else{if(k&&Buffer.isBuffer(L))return Buffer.allocUnsafe?pe=Buffer.allocUnsafe(L.length):pe=new Buffer(L.length),L.copy(pe),pe;typeof O=="undefined"?(Se=Object.getPrototypeOf(L),pe=Object.create(Se)):(pe=Object.create(O),Se=O)}if(d){var Oe=T.indexOf(L);if(Oe!=-1)return w[Oe];T.push(L),w.push(pe)}for(var Ae in L){var Re;Se&&(Re=Object.getOwnPropertyDescriptor(Se,Ae)),!(Re&&Re.set==null)&&(pe[Ae]=V(L[Ae],Z-1))}return pe}return V(o,_)}t.clonePrototype=function(d){if(d===null)return null;var _=function(){};return _.prototype=d,new _};function n(o){return Object.prototype.toString.call(o)}t.__objToStr=n;function a(o){return typeof o=="object"&&n(o)==="[object Date]"}t.__isDate=a;function i(o){return typeof o=="object"&&n(o)==="[object Array]"}t.__isArray=i;function c(o){return typeof o=="object"&&n(o)==="[object RegExp]"}t.__isRegExp=c;function s(o){var d="";return o.global&&(d+="g"),o.ignoreCase&&(d+="i"),o.multiline&&(d+="m"),d}return t.__getRegExpFlags=s,t}();e.exports&&(e.exports=r)})(hc);var kh=hc.exports,zh=function(e,r){return e=e||{},Object.keys(r).forEach(function(t){typeof e[t]=="undefined"&&(e[t]=kh(r[t]))}),e};const fn=Bh.mat4,Uh=zh;var im=function(r,t={}){t=Uh(t,{speed:.005,onRotate:function(){},drag:0,invert:!1,hideCursor:!1});const n=t.invert?-1:1,a=fn.create();let i=!1,c=r.style.cursor;const s={x:0,y:0,dx:0,dy:0,down:!1};function o(L,Z){const pe=fn.create();fn.rotateY(pe,pe,L*t.speed),fn.rotateX(pe,pe,Z*t.speed),fn.multiply(a,pe,a),t.onRotate()}function d(L,Z){s.dx=L,s.dy=Z}function _(){i||(requestAnimationFrame(_),s.down&&(s.dx=0,s.dy=0),Math.abs(s.dx*t.speed)<1e-4&&Math.abs(s.dy*t.speed)<1e-4&&(s.dx=0,s.dy=0),!(s.dx===0&&s.dy===0)&&(s.dx-=s.dx*t.drag,s.dy-=s.dy*t.drag,o(s.dx,s.dy)))}_();function O(L){s.x=L.clientX,s.y=L.clientY,s.dx=0,s.dy=0,s.down=!0,r.setPointerCapture(L.pointerId),t.hideCursor&&(c=r.style.cursor,r.style.cursor="none"),L.preventDefault()}function T(){s.down=!1,r.style.cursor=c}function w(L){!s.down||(s.dx=n*(L.clientX-s.x),s.dy=n*(L.clientY-s.y),s.x=L.clientX,s.y=L.clientY,o(s.dx,s.dy))}function k(L){r.releasePointerCapture(L.pointerId)}r.addEventListener("pointerdown",O),r.addEventListener("pointerup",T),r.addEventListener("pointermove",w),r.addEventListener("pointercancel",k);function V(){r.removeEventListener("pointerdown",O),r.removeEventListener("pointerup",T),r.removeEventListener("pointermove",w),r.removeEventListener("pointercancel",k),i=!0}return{spin:d,rotation:a,dispose:V}},Kn=1e-6,Mr=typeof Float32Array!="undefined"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var e=0,r=arguments.length;r--;)e+=arguments[r]*arguments[r];return Math.sqrt(e)});function Vh(){var e=new Mr(9);return Mr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function fm(){var e=new Mr(16);return Mr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function jh(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function sm(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],c=r[4],s=r[5],o=r[6],d=r[7],_=r[8],O=r[9],T=r[10],w=r[11],k=r[12],V=r[13],L=r[14],Z=r[15],pe=t*s-n*c,Se=t*o-a*c,Oe=t*d-i*c,Ae=n*o-a*s,Re=n*d-i*s,We=a*d-i*o,Qe=_*V-O*k,Je=_*L-T*k,qe=_*Z-w*k,rr=O*L-T*V,Ke=O*Z-w*V,tr=T*Z-w*L,Me=pe*tr-Se*Ke+Oe*rr+Ae*qe-Re*Je+We*Qe;return Me?(Me=1/Me,e[0]=(s*tr-o*Ke+d*rr)*Me,e[1]=(a*Ke-n*tr-i*rr)*Me,e[2]=(V*We-L*Re+Z*Ae)*Me,e[3]=(T*Re-O*We-w*Ae)*Me,e[4]=(o*qe-c*tr-d*Je)*Me,e[5]=(t*tr-a*qe+i*Je)*Me,e[6]=(L*Oe-k*We-Z*Se)*Me,e[7]=(_*We-T*Oe+w*Se)*Me,e[8]=(c*Ke-s*qe+d*Qe)*Me,e[9]=(n*qe-t*Ke-i*Qe)*Me,e[10]=(k*Re-V*Oe+Z*pe)*Me,e[11]=(O*Oe-_*Re-w*pe)*Me,e[12]=(s*Je-c*rr-o*Qe)*Me,e[13]=(t*rr-n*Je+a*Qe)*Me,e[14]=(V*Se-k*Ae-L*pe)*Me,e[15]=(_*Ae-O*Se+T*pe)*Me,e):null}function cm(e,r,t,n){var a=r[0],i=r[1],c=r[2],s=r[3],o=a+a,d=i+i,_=c+c,O=a*o,T=a*d,w=a*_,k=i*d,V=i*_,L=c*_,Z=s*o,pe=s*d,Se=s*_,Oe=n[0],Ae=n[1],Re=n[2];return e[0]=(1-(k+L))*Oe,e[1]=(T+Se)*Oe,e[2]=(w-pe)*Oe,e[3]=0,e[4]=(T-Se)*Ae,e[5]=(1-(O+L))*Ae,e[6]=(V+Z)*Ae,e[7]=0,e[8]=(w+pe)*Re,e[9]=(V-Z)*Re,e[10]=(1-(O+k))*Re,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Xh(e,r,t,n,a){var i=1/Math.tan(r/2),c;return e[0]=i/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,a!=null&&a!==1/0?(c=1/(n-a),e[10]=(a+n)*c,e[14]=2*a*n*c):(e[10]=-1,e[14]=-2*n),e}var lm=Xh;function om(e,r,t,n){var a,i,c,s,o,d,_,O,T,w,k=r[0],V=r[1],L=r[2],Z=n[0],pe=n[1],Se=n[2],Oe=t[0],Ae=t[1],Re=t[2];return Math.abs(k-Oe)<Kn&&Math.abs(V-Ae)<Kn&&Math.abs(L-Re)<Kn?jh(e):(_=k-Oe,O=V-Ae,T=L-Re,w=1/Math.hypot(_,O,T),_*=w,O*=w,T*=w,a=pe*T-Se*O,i=Se*_-Z*T,c=Z*O-pe*_,w=Math.hypot(a,i,c),w?(w=1/w,a*=w,i*=w,c*=w):(a=0,i=0,c=0),s=O*c-T*i,o=T*a-_*c,d=_*i-O*a,w=Math.hypot(s,o,d),w?(w=1/w,s*=w,o*=w,d*=w):(s=0,o=0,d=0),e[0]=a,e[1]=s,e[2]=_,e[3]=0,e[4]=i,e[5]=o,e[6]=O,e[7]=0,e[8]=c,e[9]=d,e[10]=T,e[11]=0,e[12]=-(a*k+i*V+c*L),e[13]=-(s*k+o*V+d*L),e[14]=-(_*k+O*V+T*L),e[15]=1,e)}function mc(){var e=new Mr(3);return Mr!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function um(e){var r=new Mr(3);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r}function qh(e){var r=e[0],t=e[1],n=e[2];return Math.hypot(r,t,n)}function pc(e,r,t){var n=new Mr(3);return n[0]=e,n[1]=r,n[2]=t,n}function vm(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function dm(e,r,t,n){return e[0]=r,e[1]=t,e[2]=n,e}function hm(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e}function Hh(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e}function Yh(e,r,t){return e[0]=r[0]*t[0],e[1]=r[1]*t[1],e[2]=r[2]*t[2],e}function mm(e,r,t){return e[0]=Math.min(r[0],t[0]),e[1]=Math.min(r[1],t[1]),e[2]=Math.min(r[2],t[2]),e}function pm(e,r,t){return e[0]=Math.max(r[0],t[0]),e[1]=Math.max(r[1],t[1]),e[2]=Math.max(r[2],t[2]),e}function ym(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e}function Wh(e,r){var t=r[0],n=r[1],a=r[2],i=t*t+n*n+a*a;return i>0&&(i=1/Math.sqrt(i)),e[0]=r[0]*i,e[1]=r[1]*i,e[2]=r[2]*i,e}function Qh(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]}function ci(e,r,t){var n=r[0],a=r[1],i=r[2],c=t[0],s=t[1],o=t[2];return e[0]=a*o-i*s,e[1]=i*c-n*o,e[2]=n*s-a*c,e}function bm(e,r,t){var n=r[0],a=r[1],i=r[2],c=t[3]*n+t[7]*a+t[11]*i+t[15];return c=c||1,e[0]=(t[0]*n+t[4]*a+t[8]*i+t[12])/c,e[1]=(t[1]*n+t[5]*a+t[9]*i+t[13])/c,e[2]=(t[2]*n+t[6]*a+t[10]*i+t[14])/c,e}var _m=Hh,xm=Yh,Kh=qh;(function(){var e=mc();return function(r,t,n,a,i,c){var s,o;for(t||(t=3),n||(n=0),a?o=Math.min(a*t+n,r.length):o=r.length,s=n;s<o;s+=t)e[0]=r[s],e[1]=r[s+1],e[2]=r[s+2],i(e,e,c),r[s]=e[0],r[s+1]=e[1],r[s+2]=e[2];return r}})();function Zh(){var e=new Mr(4);return Mr!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Jh(e,r){var t=r[0],n=r[1],a=r[2],i=r[3],c=t*t+n*n+a*a+i*i;return c>0&&(c=1/Math.sqrt(c)),e[0]=t*c,e[1]=n*c,e[2]=a*c,e[3]=i*c,e}(function(){var e=Zh();return function(r,t,n,a,i,c){var s,o;for(t||(t=4),n||(n=0),a?o=Math.min(a*t+n,r.length):o=r.length,s=n;s<o;s+=t)e[0]=r[s],e[1]=r[s+1],e[2]=r[s+2],e[3]=r[s+3],i(e,e,c),r[s]=e[0],r[s+1]=e[1],r[s+2]=e[2],r[s+3]=e[3];return r}})();function yc(){var e=new Mr(4);return Mr!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function em(e,r,t){t=t*.5;var n=Math.sin(t);return e[0]=n*r[0],e[1]=n*r[1],e[2]=n*r[2],e[3]=Math.cos(t),e}function Em(e,r,t){t*=.5;var n=r[0],a=r[1],i=r[2],c=r[3],s=Math.sin(t),o=Math.cos(t);return e[0]=n*o+c*s,e[1]=a*o+i*s,e[2]=i*o-a*s,e[3]=c*o-n*s,e}function Tm(e,r,t){t*=.5;var n=r[0],a=r[1],i=r[2],c=r[3],s=Math.sin(t),o=Math.cos(t);return e[0]=n*o-i*s,e[1]=a*o+c*s,e[2]=i*o+n*s,e[3]=c*o-a*s,e}function gm(e,r,t){t*=.5;var n=r[0],a=r[1],i=r[2],c=r[3],s=Math.sin(t),o=Math.cos(t);return e[0]=n*o+a*s,e[1]=a*o-n*s,e[2]=i*o+c*s,e[3]=c*o-i*s,e}function li(e,r,t,n){var a=r[0],i=r[1],c=r[2],s=r[3],o=t[0],d=t[1],_=t[2],O=t[3],T,w,k,V,L;return w=a*o+i*d+c*_+s*O,w<0&&(w=-w,o=-o,d=-d,_=-_,O=-O),1-w>Kn?(T=Math.acos(w),k=Math.sin(T),V=Math.sin((1-n)*T)/k,L=Math.sin(n*T)/k):(V=1-n,L=n),e[0]=V*a+L*o,e[1]=V*i+L*d,e[2]=V*c+L*_,e[3]=V*s+L*O,e}function rm(e,r){var t=r[0]+r[4]+r[8],n;if(t>0)n=Math.sqrt(t+1),e[3]=.5*n,n=.5/n,e[0]=(r[5]-r[7])*n,e[1]=(r[6]-r[2])*n,e[2]=(r[1]-r[3])*n;else{var a=0;r[4]>r[0]&&(a=1),r[8]>r[a*3+a]&&(a=2);var i=(a+1)%3,c=(a+2)%3;n=Math.sqrt(r[a*3+a]-r[i*3+i]-r[c*3+c]+1),e[a]=.5*n,n=.5/n,e[3]=(r[i*3+c]-r[c*3+i])*n,e[i]=(r[i*3+a]+r[a*3+i])*n,e[c]=(r[c*3+a]+r[a*3+c])*n}return e}var bc=Jh;(function(){var e=mc(),r=pc(1,0,0),t=pc(0,1,0);return function(n,a,i){var c=Qh(a,i);return c<-.999999?(ci(e,r,a),Kh(e)<1e-6&&ci(e,t,a),Wh(e,e),em(n,e,Math.PI),n):c>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(ci(e,a,i),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+c,bc(n,n))}})();(function(){var e=yc(),r=yc();return function(t,n,a,i,c,s){return li(e,n,c,s),li(r,a,i,s),li(t,e,r,2*s*(1-s)),t}})();(function(){var e=Vh();return function(r,t,n,a){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=a[0],e[4]=a[1],e[7]=a[2],e[2]=-t[0],e[5]=-t[1],e[8]=-t[2],bc(r,rm(r,e))}})();function tm(){var e=new Mr(2);return Mr!=Float32Array&&(e[0]=0,e[1]=0),e}function Am(e,r){var t=new Mr(2);return t[0]=e,t[1]=r,t}function nm(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e}function Mm(e,r,t){return e[0]=Math.max(r[0],t[0]),e[1]=Math.max(r[1],t[1]),e}function Sm(e){var r=e[0],t=e[1];return Math.hypot(r,t)}var wm=nm;(function(){var e=tm();return function(r,t,n,a,i,c){var s,o;for(t||(t=2),n||(n=0),a?o=Math.min(a*t+n,r.length):o=r.length,s=n;s<o;s+=t)e[0]=r[s],e[1]=r[s+1],i(e,e,c),r[s]=e[0],r[s+1]=e[1];return r}})();export{Mm as A,im as B,om as C,lm as D,am as R,hm as a,yc as b,mc as c,Tm as d,gm as e,pc as f,vm as g,mm as h,pm as i,cm as j,fm as k,um as l,xm as m,Wh as n,Hh as o,sm as p,ym as q,Em as r,_m as s,bm as t,qh as u,dm as v,wm as w,Am as x,Sm as y,tm as z};
