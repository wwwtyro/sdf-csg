var is=Object.defineProperty,es=Object.defineProperties;var as=Object.getOwnPropertyDescriptors;var mt=Object.getOwnPropertySymbols;var hs=Object.prototype.hasOwnProperty,os=Object.prototype.propertyIsEnumerable;var ct=(p,D,x)=>D in p?is(p,D,{enumerable:!0,configurable:!0,writable:!0,value:x}):p[D]=x,bt=(p,D)=>{for(var x in D||(D={}))hs.call(D,x)&&ct(p,x,D[x]);if(mt)for(var x of mt(D))os.call(D,x)&&ct(p,x,D[x]);return p},Mt=(p,D)=>es(p,as(D));var g=(p,D,x)=>(ct(p,typeof D!="symbol"?D+"":D,x),x);(function(p,D){typeof exports=="object"&&typeof module!="undefined"?D(exports):typeof define=="function"&&define.amd?define(["exports"],D):(p=typeof globalThis!="undefined"?globalThis:p||self,D(p["sdf-csg"]={}))})(this,function(p){"use strict";var D=1e-6,x=typeof Float32Array!="undefined"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var n=0,t=arguments.length;t--;)n+=arguments[t]*arguments[t];return Math.sqrt(n)});function pt(){var n=new x(9);return x!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function xt(){var n=new x(16);return x!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n}function vt(n,t){var s=t[0],r=t[1],i=t[2],e=t[3],a=t[4],h=t[5],c=t[6],u=t[7],o=t[8],d=t[9],f=t[10],m=t[11],y=t[12],l=t[13],M=t[14],w=t[15],v=s*h-r*a,_=s*c-i*a,L=s*u-e*a,H=r*c-i*h,O=r*u-e*h,W=i*u-e*c,z=o*l-d*y,j=o*M-f*y,R=o*w-m*y,tt=d*M-f*l,st=d*w-m*l,nt=f*w-m*M,A=v*nt-_*st+L*tt+H*R-O*j+W*z;return A?(A=1/A,n[0]=(h*nt-c*st+u*tt)*A,n[1]=(i*st-r*nt-e*tt)*A,n[2]=(l*W-M*O+w*H)*A,n[3]=(f*O-d*W-m*H)*A,n[4]=(c*R-a*nt-u*j)*A,n[5]=(s*nt-i*R+e*j)*A,n[6]=(M*L-y*W-w*_)*A,n[7]=(o*W-f*L+m*_)*A,n[8]=(a*st-h*R+u*z)*A,n[9]=(r*R-s*st-e*z)*A,n[10]=(y*O-l*L+w*v)*A,n[11]=(d*L-o*O-m*v)*A,n[12]=(h*j-a*tt-c*z)*A,n[13]=(s*tt-r*j+i*z)*A,n[14]=(l*_-y*H-M*v)*A,n[15]=(o*H-d*_+f*v)*A,n):null}function gt(n,t,s,r){var i=t[0],e=t[1],a=t[2],h=t[3],c=i+i,u=e+e,o=a+a,d=i*c,f=i*u,m=i*o,y=e*u,l=e*o,M=a*o,w=h*c,v=h*u,_=h*o,L=r[0],H=r[1],O=r[2];return n[0]=(1-(y+M))*L,n[1]=(f+_)*L,n[2]=(m-v)*L,n[3]=0,n[4]=(f-_)*H,n[5]=(1-(d+M))*H,n[6]=(l+w)*H,n[7]=0,n[8]=(m+v)*O,n[9]=(l-w)*O,n[10]=(1-(d+y))*O,n[11]=0,n[12]=s[0],n[13]=s[1],n[14]=s[2],n[15]=1,n}function b(){var n=new x(3);return x!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function ut(n){var t=new x(3);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t}function X(n){var t=n[0],s=n[1],r=n[2];return Math.hypot(t,s,r)}function $(n,t,s){var r=new x(3);return r[0]=n,r[1]=t,r[2]=s,r}function N(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n}function S(n,t,s,r){return n[0]=t,n[1]=s,n[2]=r,n}function Y(n,t,s){return n[0]=t[0]+s[0],n[1]=t[1]+s[1],n[2]=t[2]+s[2],n}function rt(n,t,s){return n[0]=t[0]-s[0],n[1]=t[1]-s[1],n[2]=t[2]-s[2],n}function yt(n,t,s){return n[0]=t[0]*s[0],n[1]=t[1]*s[1],n[2]=t[2]*s[2],n}function T(n,t,s){return n[0]=Math.min(t[0],s[0]),n[1]=Math.min(t[1],s[1]),n[2]=Math.min(t[2],s[2]),n}function P(n,t,s){return n[0]=Math.max(t[0],s[0]),n[1]=Math.max(t[1],s[1]),n[2]=Math.max(t[2],s[2]),n}function Dt(n,t,s){return n[0]=t[0]*s,n[1]=t[1]*s,n[2]=t[2]*s,n}function et(n,t){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n}function dt(n,t){var s=t[0],r=t[1],i=t[2],e=s*s+r*r+i*i;return e>0&&(e=1/Math.sqrt(e)),n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n}function it(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function at(n,t,s){var r=t[0],i=t[1],e=t[2],a=s[0],h=s[1],c=s[2];return n[0]=i*c-e*h,n[1]=e*a-r*c,n[2]=r*h-i*a,n}function G(n,t,s){var r=t[0],i=t[1],e=t[2],a=s[3]*r+s[7]*i+s[11]*e+s[15];return a=a||1,n[0]=(s[0]*r+s[4]*i+s[8]*e+s[12])/a,n[1]=(s[1]*r+s[5]*i+s[9]*e+s[13])/a,n[2]=(s[2]*r+s[6]*i+s[10]*e+s[14])/a,n}var I=rt,wt=yt,Ut=X;(function(){var n=b();return function(t,s,r,i,e,a){var h,c;for(s||(s=3),r||(r=0),i?c=Math.min(i*s+r,t.length):c=t.length,h=r;h<c;h+=s)n[0]=t[h],n[1]=t[h+1],n[2]=t[h+2],e(n,n,a),t[h]=n[0],t[h+1]=n[1],t[h+2]=n[2];return t}})();function _t(){var n=new x(4);return x!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0),n}function $t(n,t){var s=t[0],r=t[1],i=t[2],e=t[3],a=s*s+r*r+i*i+e*e;return a>0&&(a=1/Math.sqrt(a)),n[0]=s*a,n[1]=r*a,n[2]=i*a,n[3]=e*a,n}(function(){var n=_t();return function(t,s,r,i,e,a){var h,c;for(s||(s=4),r||(r=0),i?c=Math.min(i*s+r,t.length):c=t.length,h=r;h<c;h+=s)n[0]=t[h],n[1]=t[h+1],n[2]=t[h+2],n[3]=t[h+3],e(n,n,a),t[h]=n[0],t[h+1]=n[1],t[h+2]=n[2],t[h+3]=n[3];return t}})();function V(){var n=new x(4);return x!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function St(n,t,s){s=s*.5;var r=Math.sin(s);return n[0]=r*t[0],n[1]=r*t[1],n[2]=r*t[2],n[3]=Math.cos(s),n}function At(n,t,s){s*=.5;var r=t[0],i=t[1],e=t[2],a=t[3],h=Math.sin(s),c=Math.cos(s);return n[0]=r*c+a*h,n[1]=i*c+e*h,n[2]=e*c-i*h,n[3]=a*c-r*h,n}function qt(n,t,s){s*=.5;var r=t[0],i=t[1],e=t[2],a=t[3],h=Math.sin(s),c=Math.cos(s);return n[0]=r*c-e*h,n[1]=i*c+a*h,n[2]=e*c+r*h,n[3]=a*c-i*h,n}function Ct(n,t,s){s*=.5;var r=t[0],i=t[1],e=t[2],a=t[3],h=Math.sin(s),c=Math.cos(s);return n[0]=r*c+i*h,n[1]=i*c-r*h,n[2]=e*c+a*h,n[3]=a*c-e*h,n}function ht(n,t,s,r){var i=t[0],e=t[1],a=t[2],h=t[3],c=s[0],u=s[1],o=s[2],d=s[3],f,m,y,l,M;return m=i*c+e*u+a*o+h*d,m<0&&(m=-m,c=-c,u=-u,o=-o,d=-d),1-m>D?(f=Math.acos(m),y=Math.sin(f),l=Math.sin((1-r)*f)/y,M=Math.sin(r*f)/y):(l=1-r,M=r),n[0]=l*i+M*c,n[1]=l*e+M*u,n[2]=l*a+M*o,n[3]=l*h+M*d,n}function Pt(n,t){var s=t[0]+t[4]+t[8],r;if(s>0)r=Math.sqrt(s+1),n[3]=.5*r,r=.5/r,n[0]=(t[5]-t[7])*r,n[1]=(t[6]-t[2])*r,n[2]=(t[1]-t[3])*r;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);var e=(i+1)%3,a=(i+2)%3;r=Math.sqrt(t[i*3+i]-t[e*3+e]-t[a*3+a]+1),n[i]=.5*r,r=.5/r,n[3]=(t[e*3+a]-t[a*3+e])*r,n[e]=(t[e*3+i]+t[i*3+e])*r,n[a]=(t[a*3+i]+t[i*3+a])*r}return n}var lt=$t;(function(){var n=b(),t=$(1,0,0),s=$(0,1,0);return function(r,i,e){var a=it(i,e);return a<-.999999?(at(n,t,i),Ut(n)<1e-6&&at(n,s,i),dt(n,n),St(r,n,Math.PI),r):a>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(at(n,i,e),r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=1+a,lt(r,r))}})(),function(){var n=V(),t=V();return function(s,r,i,e,a,h){return ht(n,r,a,h),ht(t,i,e,h),ht(s,n,t,2*h*(1-h)),s}}(),function(){var n=pt();return function(t,s,r,i){return n[0]=r[0],n[3]=r[1],n[6]=r[2],n[1]=i[0],n[4]=i[1],n[7]=i[2],n[2]=-s[0],n[5]=-s[1],n[8]=-s[2],lt(t,Pt(t,n))}}();function q(){var n=new x(2);return x!=Float32Array&&(n[0]=0,n[1]=0),n}function C(n,t){var s=new x(2);return s[0]=n,s[1]=t,s}function Ft(n,t,s){return n[0]=t[0]+s[0],n[1]=t[1]+s[1],n}function Tt(n,t,s){return n[0]=t[0]-s[0],n[1]=t[1]-s[1],n}function It(n,t,s){return n[0]=t[0]*s[0],n[1]=t[1]*s[1],n}function ft(n,t,s){return n[0]=Math.max(t[0],s[0]),n[1]=Math.max(t[1],s[1]),n}function K(n,t,s){return n[0]=t[0]*s,n[1]=t[1]*s,n}function F(n){var t=n[0],s=n[1];return Math.hypot(t,s)}function B(n,t){return n[0]*t[0]+n[1]*t[1]}var Z=Tt,Bt=It;(function(){var n=q();return function(t,s,r,i,e,a){var h,c;for(s||(s=2),r||(r=0),i?c=Math.min(i*s+r,t.length):c=t.length,h=r;h<c;h+=s)n[0]=t[h],n[1]=t[h+1],e(n,n,a),t[h]=n[0],t[h+1]=n[1];return t}})();function Q(n,t){return n[0]=Math.abs(t[0]),n[1]=Math.abs(t[1]),n[2]=Math.abs(t[2]),n}function Et(n,t){return n[0]=Math.abs(t[0]),n[1]=Math.abs(t[1]),n}function k(n,t,s){return Math.max(t,Math.min(s,n))}function ot(n,t,s){return n*(1-s)+t*s}const E={points:[[0,0,0],[1,0,0],[0,1,0],[1,1,0],[0,0,1],[1,0,1],[0,1,1],[1,1,1]],edges:[[0,1],[0,2],[0,4],[1,3],[1,5],[2,3],[2,6],[3,7],[4,5],[4,6],[5,7],[6,7]]};function Gt(n,t){const s=n.shape[0],r=n.shape[1],i=n.shape[2],e=[],a={};function h(u,o,d){if([u,o,d].toString()in a)return a[[u,o,d].toString()];const f=[];E.points.forEach(function(l){f.push(n.get(u+l[0],o+l[1],d+l[2]))});let m=[0,0,0],y=0;return E.edges.forEach(function(l){if(f[l[0]]<t&&f[l[1]]<t||f[l[0]]>=t&&f[l[1]]>=t)return;const M=f[l[1]]-f[l[0]],w=(t-f[l[0]])/M,v=[E.points[l[1]][0]-E.points[l[0]][0],E.points[l[1]][1]-E.points[l[0]][1],E.points[l[1]][2]-E.points[l[0]][2]],_=[E.points[l[0]][0]+v[0]*w,E.points[l[0]][1]+v[1]*w,E.points[l[0]][2]+v[2]*w];m=[m[0]+_[0]+u,m[1]+_[1]+o,m[2]+_[2]+d],y++}),e.push([m[0]/y,m[1]/y,m[2]/y]),a[[u,o,d].toString()]=e.length-1,a[[u,o,d].toString()]}const c=[];for(let u=0;u<s-1;u++)for(let o=0;o<r-1;o++)for(let d=0;d<i-1;d++){const f=n.get(u+0,o+0,d+0)>=t?1:0,m=n.get(u+1,o+0,d+0)>=t?1:0,y=n.get(u+0,o+1,d+0)>=t?1:0,l=n.get(u+0,o+0,d+1)>=t?1:0;if(f+m===1&&o>0&&d>0){const M=h(u+0,o-1,d-1),w=h(u+0,o-1,d+0),v=h(u+0,o+0,d+0),_=h(u+0,o+0,d-1);m<f?(c.push([M,w,v]),c.push([M,v,_])):(c.push([M,v,w]),c.push([M,_,v]))}if(f+y===1&&u>0&&d>0){const M=h(u-1,o+0,d-1),w=h(u+0,o+0,d-1),v=h(u+0,o+0,d+0),_=h(u-1,o+0,d+0);y<f?(c.push([M,w,v]),c.push([M,v,_])):(c.push([M,v,w]),c.push([M,_,v]))}if(f+l===1&&u>0&&o>0){const M=h(u-1,o-1,d+0),w=h(u+0,o-1,d+0),v=h(u+0,o+0,d+0),_=h(u-1,o+0,d+0);l>f?(c.push([M,w,v]),c.push([M,v,_])):(c.push([M,v,w]),c.push([M,_,v]))}}return{positions:e,cells:c}}class U{constructor(){g(this,"_userData",null);g(this,"bounds",{min:$(0,0,0),max:$(0,0,0)})}normal(t,s,r){const i=.001,e=this.density(t,s,r),a=this.density(t+i,s,r),h=this.density(t,s+i,r),c=this.density(t,s,r+i),u=$((a-e)/i,(h-e)/i,(c-e)/i);return dt(b(),u)}generateMesh(t,s){let r=performance.now();const i=this.generateGrid(t,s);console.log(`Grid: ${Math.round(performance.now()-r)} ms`),r=performance.now();const e=Gt(i,0);console.log(`Isosurface extraction: ${Math.round(performance.now()-r)} ms`);const a=I(b(),this.bounds.min,[s,s,s]),h=Y(b(),this.bounds.max,[s,s,s]),c=I(b(),h,a);for(const d of e.positions)wt(d,d,[c[0]/t[0],c[1]/t[1],c[2]/t[2]]),Y(d,d,a);const u=[];for(const d of e.positions)u.push(this.normal(d[0],d[1],d[2]));let o=null;if(this.getUserData(0,0,0)!==null){o=[];for(const d of e.positions)o.push(this.getUserData(d[0],d[1],d[2]))}return Mt(bt({},e),{normals:u,userdata:o})}generateGrid(t,s){const r=new Float32Array((t[0]+1)*(t[1]+1)*(t[2]+1)),i=I(b(),this.bounds.min,[s,s,s]),e=Y(b(),this.bounds.max,[s,s,s]),a=(e[0]-i[0])/t[0],h=(e[1]-i[1])/t[1],c=(e[2]-i[2])/t[2];for(let u=0;u<t[0]+1;u++){const o=u*a+i[0];for(let d=0;d<t[1]+1;d++){const f=d*h+i[1];for(let m=0;m<t[2]+1;m++){const y=m*c+i[2],l=t[0]*t[2]*d+t[0]*m+u;r[l]=this.density(o,f,y)}}}return{get:(u,o,d)=>r[t[0]*t[2]*o+t[0]*d+u],shape:[t[0]+1,t[1]+1,t[2]+1]}}setUserData(t){return this._userData=t.slice(),this}getUserData(t,s,r){return this._userData}union(t){return new Yt(this,t)}subtract(t){return new Vt(t,this)}intersect(t){return new kt(t,this)}smoothUnion(t,s){return new Ht(this,t,s)}smoothSubtract(t,s){return new Lt(t,this,s)}smoothIntersect(t,s){return new Ot(this,t,s)}translate(t,s,r){return new J(this,[t,s,r],V(),1)}rotate(t){return new J(this,[0,0,0],t,1)}rotateX(t){return new J(this,[0,0,0],At(V(),V(),t),1)}rotateY(t){return new J(this,[0,0,0],qt(V(),V(),t),1)}rotateZ(t){return new J(this,[0,0,0],Ct(V(),V(),t),1)}scale(t){return new J(this,[0,0,0],V(),t)}round(t){return new Xt(this,t)}}class Vt extends U{constructor(t,s){super();g(this,"density",(t,s,r)=>{const i=this.sdf1.density(t,s,r),e=this.sdf2.density(t,s,r);return Math.max(-i,e)});this.sdf1=t,this.sdf2=s,N(this.bounds.min,s.bounds.min),N(this.bounds.max,s.bounds.max)}getUserData(t,s,r){if(this._userData!==null)return this._userData;const i=this.sdf1.getUserData(t,s,r),e=this.sdf2.getUserData(t,s,r);if(i!==null&&e===null)return i;if(i===null&&e!==null)return e;if(i===null&&e===null)return null;const a=Math.abs(this.sdf1.density(t,s,r)),h=Math.abs(this.sdf2.density(t,s,r)),c=a/(a+h),u=[];for(let o=0;o<i.length;o++)u.push(i[o]+c*(e[o]-i[o]));return u}}class Yt extends U{constructor(t,s){super();g(this,"density",(t,s,r)=>{const i=this.sdf1.density(t,s,r),e=this.sdf2.density(t,s,r);return Math.min(i,e)});this.sdf1=t,this.sdf2=s,T(this.bounds.min,t.bounds.min,s.bounds.min),P(this.bounds.max,t.bounds.max,s.bounds.max)}getUserData(t,s,r){if(this._userData!==null)return this._userData;const i=this.sdf1.getUserData(t,s,r),e=this.sdf2.getUserData(t,s,r);if(i!==null&&e===null)return i;if(i===null&&e!==null)return e;if(i===null&&e===null)return null;const a=Math.abs(this.sdf1.density(t,s,r)),h=Math.abs(this.sdf2.density(t,s,r)),c=a/(a+h),u=[];for(let o=0;o<i.length;o++)u.push(i[o]+c*(e[o]-i[o]));return u}}class kt extends U{constructor(t,s){super();g(this,"density",(t,s,r)=>{const i=this.sdf1.density(t,s,r),e=this.sdf2.density(t,s,r);return Math.max(i,e)});this.sdf1=t,this.sdf2=s,P(this.bounds.min,t.bounds.min,s.bounds.min),T(this.bounds.max,t.bounds.max,s.bounds.max)}getUserData(t,s,r){if(this._userData!==null)return this._userData;const i=this.sdf1.getUserData(t,s,r),e=this.sdf2.getUserData(t,s,r);if(i!==null&&e===null)return i;if(i===null&&e!==null)return e;if(i===null&&e===null)return null;const a=Math.abs(this.sdf1.density(t,s,r)),h=Math.abs(this.sdf2.density(t,s,r)),c=a/(a+h),u=[];for(let o=0;o<i.length;o++)u.push(i[o]+c*(e[o]-i[o]));return u}}class Lt extends U{constructor(t,s,r){super();g(this,"density",(t,s,r)=>{const i=this.sdf1.density(t,s,r),e=this.sdf2.density(t,s,r),a=k(.5-.5*(e+i)/this.smoothness,0,1);return ot(e,-i,a)+this.smoothness*a*(1-a)});this.sdf1=t,this.sdf2=s,this.smoothness=r,N(this.bounds.min,s.bounds.min),N(this.bounds.max,s.bounds.max)}getUserData(t,s,r){if(this._userData!==null)return this._userData;const i=this.sdf1.getUserData(t,s,r),e=this.sdf2.getUserData(t,s,r);if(i!==null&&e===null)return i;if(i===null&&e!==null)return e;if(i===null&&e===null)return null;const a=Math.abs(this.sdf1.density(t,s,r)),h=Math.abs(this.sdf2.density(t,s,r)),c=a/(a+h),u=[];for(let o=0;o<i.length;o++)u.push(i[o]+c*(e[o]-i[o]));return u}}class Ht extends U{constructor(t,s,r){super();g(this,"density",(t,s,r)=>{const i=this.sdf1.density(t,s,r),e=this.sdf2.density(t,s,r),a=k(.5+.5*(e-i)/this.smoothness,0,1);return ot(e,i,a)-this.smoothness*a*(1-a)});this.sdf1=t,this.sdf2=s,this.smoothness=r,T(this.bounds.min,t.bounds.min,s.bounds.min),P(this.bounds.max,t.bounds.max,s.bounds.max)}getUserData(t,s,r){if(this._userData!==null)return this._userData;const i=this.sdf1.getUserData(t,s,r),e=this.sdf2.getUserData(t,s,r);if(i!==null&&e===null)return i;if(i===null&&e!==null)return e;if(i===null&&e===null)return null;const a=Math.abs(this.sdf1.density(t,s,r)),h=Math.abs(this.sdf2.density(t,s,r)),c=a/(a+h),u=[];for(let o=0;o<i.length;o++)u.push(i[o]+c*(e[o]-i[o]));return u}}class Ot extends U{constructor(t,s,r){super();g(this,"density",(t,s,r)=>{const i=this.sdf1.density(t,s,r),e=this.sdf2.density(t,s,r),a=k(.5-.5*(e-i)/this.smoothness,0,1);return ot(e,i,a)+this.smoothness*a*(1-a)});this.sdf1=t,this.sdf2=s,this.smoothness=r,P(this.bounds.min,t.bounds.min,s.bounds.min),T(this.bounds.max,t.bounds.max,s.bounds.max)}getUserData(t,s,r){if(this._userData!==null)return this._userData;const i=this.sdf1.getUserData(t,s,r),e=this.sdf2.getUserData(t,s,r);if(i!==null&&e===null)return i;if(i===null&&e!==null)return e;if(i===null&&e===null)return null;const a=Math.abs(this.sdf1.density(t,s,r)),h=Math.abs(this.sdf2.density(t,s,r)),c=a/(a+h),u=[];for(let o=0;o<i.length;o++)u.push(i[o]+c*(e[o]-i[o]));return u}}class J extends U{constructor(t,s,r,i){super();g(this,"matrix");g(this,"density",(t,s,r)=>{const i=$(t,s,r);return G(i,i,this.matrix),this.sdf.density(i[0],i[1],i[2])});this.sdf=t,this.matrix=gt(xt(),r,s,$(i,i,i));const e=ut(this.sdf.bounds.min),a=ut(this.sdf.bounds.max),h=rt(b(),a,e),c=Y(b(),e,[h[0],0,0]),u=Y(b(),e,[h[0],h[1],0]),o=Y(b(),e,[0,h[1],0]),d=I(b(),a,[h[0],0,0]),f=I(b(),a,[h[0],h[1],0]),m=I(b(),a,[0,h[1],0]);G(e,e,this.matrix),G(a,a,this.matrix),G(c,c,this.matrix),G(u,u,this.matrix),G(o,o,this.matrix),G(d,d,this.matrix),G(f,f,this.matrix),G(m,m,this.matrix),T(this.bounds.min,e,a),T(this.bounds.min,this.bounds.min,c),T(this.bounds.min,this.bounds.min,u),T(this.bounds.min,this.bounds.min,o),T(this.bounds.min,this.bounds.min,d),T(this.bounds.min,this.bounds.min,f),T(this.bounds.min,this.bounds.min,m),P(this.bounds.max,e,a),P(this.bounds.max,this.bounds.max,c),P(this.bounds.max,this.bounds.max,u),P(this.bounds.max,this.bounds.max,o),P(this.bounds.max,this.bounds.max,d),P(this.bounds.max,this.bounds.max,f),P(this.bounds.max,this.bounds.max,m),vt(this.matrix,this.matrix)}getUserData(t,s,r){if(this._userData!==null)return this._userData;const i=G(b(),[t,s,r],this.matrix);return this.sdf.getUserData(i[0],i[1],i[2])}}class Xt extends U{constructor(t,s){super();g(this,"density",(t,s,r)=>this.sdf.density(t,s,r)-this.radius);this.sdf=t,this.radius=s,I(this.bounds.min,t.bounds.min,[s,s,s]),Y(this.bounds.max,t.bounds.max,[s,s,s])}getUserData(t,s,r){return this._userData!==null?this._userData:this.sdf.getUserData(t,s,r)}}class Zt extends U{constructor(t,s,r){super();g(this,"radii");g(this,"density",(t,s,r)=>{const i=$(t,s,r),e=Q(b(),i),a=rt(b(),e,this.radii),h=P(b(),a,$(0,0,0));return X(h)+Math.min(Math.max(a[0],Math.max(a[1],a[2])),0)});this.radii=$(t,s,r),et(this.bounds.min,this.radii),N(this.bounds.max,this.radii)}}class Nt extends U{constructor(t){super();g(this,"density",(t,s,r)=>{const i=$(t,s,r);return X(i)-this.radius});this.radius=t,et(this.bounds.min,[this.radius,this.radius,this.radius]),S(this.bounds.max,this.radius,this.radius,this.radius)}}class Jt extends U{constructor(t,s,r,i){super();g(this,"radii");g(this,"density",(t,s,r)=>{const i=rt(b(),Q(b(),$(t,s,r)),this.radii),e=$(this.edge,this.edge,this.edge),a=I(b(),Q(b(),Y(b(),i,e)),e);return Math.min(Math.min(X(P(b(),[i[0],a[1],a[2]],[0,0,0]))+Math.min(Math.max(i[0],Math.max(a[1],a[2])),0),X(P(b(),[a[0],i[1],a[2]],[0,0,0]))+Math.min(Math.max(a[0],Math.max(i[1],a[2])),0)),X(P(b(),[a[0],a[1],i[2]],[0,0,0]))+Math.min(Math.max(a[0],Math.max(a[1],i[2])),0))});this.edge=i,this.radii=$(t,s,r),et(this.bounds.min,this.radii),N(this.bounds.max,this.radii)}}class Kt extends U{constructor(t,s){super();g(this,"density",(t,s,r)=>{const i=C(F(C(t,s))-this.majorRadius,r);return F(i)-this.minorRadius});this.majorRadius=t,this.minorRadius=s,S(this.bounds.min,-t-s,-t-s,-s),S(this.bounds.max,t+s,t+s,+s)}}class Qt extends U{constructor(t,s,r){super();g(this,"density",(t,s,r)=>{const i=C(Math.sin(this.angle),Math.cos(this.angle));t=Math.abs(t);const e=i[1]*t>i[0]*s?B([t,s],i):F([t,s]),a=$(t,s,r);return Math.sqrt(it(a,a)+this.majorRadius*this.majorRadius-2*this.majorRadius*e)-this.minorRadius});this.majorRadius=t,this.minorRadius=s,this.angle=r,S(this.bounds.min,-t-s,-t-s,-s),S(this.bounds.max,t+s,t+s,+s)}}class Wt extends U{constructor(t,s,r){super();g(this,"density",(t,s,r)=>{const i=$(t,Math.max(Math.abs(s)-this.length,0),r);return F(C(F([i[0],i[1]])-this.majorRadius,i[2]))-this.minorRadius});this.majorRadius=t,this.minorRadius=s,this.length=r,S(this.bounds.min,-t-s,-t-s-r,-s),S(this.bounds.max,t+s,t+s+r,+s)}}class zt extends U{constructor(t,s){super();g(this,"density",(t,s,r)=>{const i=[Math.sin(this.angle),Math.cos(this.angle)],e=K(q(),C(i[0]/i[1],-1),this.height),a=C(F([t,r]),s),h=Z(q(),a,K(q(),e,k(B(a,e)/B(e,e),0,1))),c=Z(q(),a,Bt(q(),e,C(k(a[0]/e[0],0,1),1))),u=Math.sign(e[1]),o=Math.min(B(h,h),B(c,c)),d=Math.max(u*(a[0]*e[1]-a[1]*e[0]),u*(a[1]-e[1]));return Math.sqrt(o)*Math.sign(d)});this.angle=t,this.height=s;const r=s*Math.tan(t);S(this.bounds.min,-r,-s,-r),S(this.bounds.max,r,0,r)}}class jt extends U{constructor(t,s){super();g(this,"density",(t,s,r)=>{const i=$(-.8660254,.5,.57735),e=$(t,s,r);Q(e,e);const a=K(q(),[i[0],i[1]],2*Math.min(B([i[0],i[1]],[e[0],e[1]]),0));e[0]-=a[0],e[1]-=a[1];const h=C(F(Z(q(),[e[0],e[1]],C(k(e[0],-i[2]*this.radius,i[2]*this.radius),this.radius)))*Math.sign(e[1]-this.radius),e[2]-this.length);return Math.min(Math.max(h[0],h[1]),0)+F(ft(q(),h,[0,0]))});this.radius=t,this.length=s;const r=t/Math.cos(Math.PI/6);S(this.bounds.min,-r,-t,-s),S(this.bounds.max,r,t,s)}}class Rt extends U{constructor(t,s,r){super();g(this,"density",(t,s,r)=>{const i=$(t,s,r),e=I(b(),i,this.pointA),a=I(b(),this.pointB,this.pointA),h=k(it(e,a)/it(a,a),0,1);return X(I(b(),e,Dt(b(),a,h)))-this.radius});this.pointA=t,this.pointB=s,this.radius=r;const i=T(b(),t,s),e=P(b(),t,s);I(this.bounds.min,i,[r,r,r]),Y(this.bounds.max,e,[r,r,r])}}class ts extends U{constructor(t,s){super();g(this,"density",(t,s,r)=>{const i=Z(q(),Et(q(),C(F([t,r]),s)),C(this.radius,this.length));return Math.min(Math.max(i[0],i[1]),0)+F(ft(q(),i,[0,0]))});this.length=t,this.radius=s,S(this.bounds.min,-s,-t,-s),S(this.bounds.max,s,t,s)}}class ss extends U{constructor(t,s,r){super();g(this,"density",(t,s,r)=>{const i=C(F([t,r]),s),e=C(this.radius2,this.length),a=C(this.radius2-this.radius1,2*this.length),h=C(i[0]-Math.min(i[0],i[1]<0?this.radius1:this.radius2),Math.abs(i[1])-this.length),c=Z(q(),e,i),u=Ft(q(),Z(q(),i,e),K(q(),a,k(B(c,a)/B(a,a),0,1)));return(u[0]<0&&h[1]<0?-1:1)*Math.sqrt(Math.min(B(h,h),B(u,u)))});this.length=t,this.radius1=s,this.radius2=r;const i=Math.max(s,r);S(this.bounds.min,-i,-t,-i),S(this.bounds.max,i,t,i)}}class ns extends U{constructor(t,s){super();g(this,"density",(t,s,r)=>{const i=C(Math.sin(this.angle),Math.cos(this.angle)),e=C(F([t,r]),s),a=F(e)-this.radius,h=F(Z(q(),e,K(q(),i,k(B(e,i),0,this.radius))));return Math.max(a,h*Math.sign(i[1]*e[0]-i[0]*e[1]))});this.angle=t,this.radius=s;const r=s*Math.sin(t);S(this.bounds.min,-r,0,-r),S(this.bounds.max,r,s,r)}}class rs extends U{constructor(t,s){super();g(this,"density",(t,s,r)=>{const i=Q(b(),[t,s,r]);return Math.max(i[2]-this.length,Math.max(i[0]*.866025+s*.5,-s)-this.radius*.5)});this.radius=t,this.length=s;const r=.5*t/Math.cos(Math.PI/3),i=.5*t*Math.tan(Math.PI/3);S(this.bounds.min,-i,-.5*t,-s),S(this.bounds.max,i,r,s)}}p.Box=Zt,p.BoxFrame=Jt,p.CappedCone=ss,p.CappedCylinder=ts,p.CappedTorus=Qt,p.Capsule=Rt,p.Cone=zt,p.HexagonalPrism=jt,p.Link=Wt,p.SolidAngle=ns,p.Sphere=Nt,p.Torus=Kt,p.TriangularPrism_=rs,Object.defineProperty(p,"__esModule",{value:!0}),p[Symbol.toStringTag]="Module"});
